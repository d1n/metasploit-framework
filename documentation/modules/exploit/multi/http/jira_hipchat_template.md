## Atlassian HipChat for Jira Plugin Velocity Template Injection

Atlassian Hipchat is a web service for internal instant 
messaging. A plugin is available for Jira that allows team 
collibration at real time. A message can be used to inject 
Java code into a Velocity template, and gain code exeuction 
as Jira. Authentication is required to exploit this 
vulnerability, and you must make sure the account you're 
using isn't protected by captcha. By default, Java payload 
will be used because it is cross-platform, but you can also 
specify which native payload you want (Linux or Windows). 
HipChat for Jira plugin versions between 1.3.2 and 6.30.0 
are affected. Jira versions between 6.3.5 and 6.4.10 are 
also affected by default, because they were bundled with a 
vulnerable copy of HipChat. When using the check command, if 
you supply a valid username and password, the module will be 
able to trigger the bug and check more accurately. If not, 
it falls back to passive, which can only tell if the target 
is running on a Jira version that is bundled with a 
vulnerable copy of Hipchat by default, which is less 
reliable. This vulnerability was originally discovered 
internally by Atlassian.


## Module Name
exploit/multi/http/jira_hipchat_template

## Authors
* Chris Wood
* sinn3r


## References
* http://cvedetails.com/cve/2015-5603/
* https://www.exploit-db.com/exploits/38551
* http://www.securityfocus.com/bid/76698
* https://confluence.atlassian.com/jira/jira-and-hipchat-for-jira-plugin-security-advisory-2015-08-26-776650785.html



## Targets
* HipChat for Jira plugin on Java
* HipChat for Jira plugin on Windows
* HipChat for Jira plugin on Linux


## Platforms


## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/http/jira_hipchat_template
msf exploit(jira_hipchat_template) > show targets
   ... a list of targets ...
msf exploit(jira_hipchat_template) > set TARGET <target-id>
msf exploit(jira_hipchat_template) > show options
   ... show and set options ...
msf exploit(jira_hipchat_template) > run
```
    
    