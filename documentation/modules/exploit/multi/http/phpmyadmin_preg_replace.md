## phpMyAdmin Authenticated Remote Code Execution via preg_replace()

This module exploits a PREG_REPLACE_EVAL vulnerability in 
phpMyAdmin's replace_prefix_tbl within 
libraries/mult_submits.inc.php via db_settings.php This 
affects versions 3.5.x < 3.5.8.1 and 4.0.0 < 4.0.0-rc3. PHP 
versions > 5.4.6 are not vulnerable.


## Module Name
exploit/multi/http/phpmyadmin_preg_replace

## Authors
* Janek "waraxe" Vind
* Ben Campbell


## References
* http://cvedetails.com/cve/2013-3238/
* PMASA (2013-2)
* waraxe (2013-SA#103)
* https://www.exploit-db.com/exploits/25003
* http://www.osvdb.org/92793
* http://www.waraxe.us/advisory-103.html
* http://www.phpmyadmin.net/home_page/security/PMASA-2013-2.php



## Targets
* Automatic


## Platforms
* php

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/http/phpmyadmin_preg_replace
msf exploit(phpmyadmin_preg_replace) > show targets
   ... a list of targets ...
msf exploit(phpmyadmin_preg_replace) > set TARGET <target-id>
msf exploit(phpmyadmin_preg_replace) > show options
   ... show and set options ...
msf exploit(phpmyadmin_preg_replace) > run
```
    
    