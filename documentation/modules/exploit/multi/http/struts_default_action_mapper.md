## Apache Struts 2 DefaultActionMapper Prefixes OGNL Code Execution

The Struts 2 DefaultActionMapper supports a method for 
short-circuit navigation state changes by prefixing 
parameters with "action:" or "redirect:", followed by a 
desired navigational target expression. This mechanism was 
intended to help with attaching navigational information to 
buttons within forms. In Struts 2 before 2.3.15.1 the 
information following "action:", "redirect:" or 
"redirectAction:" is not properly sanitized. Since said 
information will be evaluated as OGNL expression against the 
value stack, this introduces the possibility to inject 
server side code. This module has been tested successfully 
on Struts 2.3.15 and Struts 2.0.11.2 over Tomcat 7, with 
Windows 2003 SP2 and Ubuntu 10.04 operating systems.


## Module Name
exploit/multi/http/struts_default_action_mapper

## Authors
* Takeshi Terada
* sinn3r
* juan vazquez


## References
* http://cvedetails.com/cve/2013-2251/
* http://www.osvdb.org/95405
* http://www.securityfocus.com/bid/61189
* http://struts.apache.org/release/2.3.x/docs/s2-016.html



## Targets
* Automatic
* Windows
* Linux


## Platforms
* linux
* win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/http/struts_default_action_mapper
msf exploit(struts_default_action_mapper) > show targets
   ... a list of targets ...
msf exploit(struts_default_action_mapper) > set TARGET <target-id>
msf exploit(struts_default_action_mapper) > show options
   ... show and set options ...
msf exploit(struts_default_action_mapper) > run
```
    
    