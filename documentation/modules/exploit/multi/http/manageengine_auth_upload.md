## ManageEngine Multiple Products Authenticated File Upload

This module exploits a directory traversal vulnerability in 
ManageEngine ServiceDesk, AssetExplorer, SupportCenter and 
IT360 when uploading attachment files. The JSP that accepts 
the upload does not handle correctly '../' sequences, which 
can be abused to write to the file system. Authentication is 
needed to exploit this vulnerability, but this module will 
attempt to login using the default credentials for the 
administrator and guest accounts. Alternatively, you can 
provide a pre-authenticated cookie or a username / password. 
For IT360 targets, enter the RPORT of the ServiceDesk 
instance (usually 8400). All versions of ServiceDesk prior 
v9 build 9031 (including MSP but excluding v4), 
AssetExplorer, SupportCenter and IT360 (including MSP) are 
vulnerable. At the time of release of this module, only 
ServiceDesk v9 has been fixed in build 9031 and above. This 
module has been been tested successfully in Windows and 
Linux on several versions.


## Module Name
exploit/multi/http/manageengine_auth_upload

## Authors
* Pedro Ribeiro <pedrib[at]gmail.com>


## References
* http://cvedetails.com/cve/2014-5301/
* http://www.osvdb.org/116733
* http://seclists.org/fulldisclosure/2015/Jan/5



## Targets
* Automatic
* ServiceDesk Plus v5-v7.1 < b7016/AssetExplorer v4/SupportCenter v5-v7.9
* ServiceDesk Plus/Plus MSP v7.1 >= b7016 - v9.0 < b9031/AssetExplorer v5-v6.1
* IT360 v8-v10.4


## Platforms
java

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/http/manageengine_auth_upload
msf exploit(manageengine_auth_upload) > show targets
   ... a list of targets ...
msf exploit(manageengine_auth_upload) > set TARGET <target-id>
msf exploit(manageengine_auth_upload) > show options
   ... show and set options ...
msf exploit(manageengine_auth_upload) > run
```
    
    