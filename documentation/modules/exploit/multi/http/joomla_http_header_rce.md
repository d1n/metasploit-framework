## Joomla HTTP Header Unauthenticated Remote Code Execution

Joomla suffers from an unauthenticated remote code execution 
that affects all versions from 1.5.0 to 3.4.5. By storing 
user supplied headers in the databases session table it's 
possible to truncate the input by sending an UTF-8 
character. The custom created payload is then executed once 
the session is read from the databse. You also need to have 
a PHP version before 5.4.45 (including 5.3.x), 5.5.29 or 
5.6.13. In later versions the deserialisation of invalid 
session data stops on the first error and the exploit will 
not work. The PHP Patch was included in Ubuntu versions 
5.5.9+dfsg-1ubuntu4.13 and 5.3.10-1ubuntu3.20 and in Debian 
in version 5.4.45-0+deb7u1.


## Module Name
exploit/multi/http/joomla_http_header_rce

## Authors
* Marc-Alexandre Montpas
* Christian Mehlmauer


## References
* http://cvedetails.com/cve/2015-8562/
* https://www.exploit-db.com/exploits/38977
* https://www.exploit-db.com/exploits/39033
* https://blog.sucuri.net/2015/12/joomla-remote-code-execution-the-details.html
* https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html
* https://developer.joomla.org/security-centre/630-20151214-core-remote-code-execution-vulnerability.html
* https://blog.patrolserver.com/2015/12/17/in-depth-analyses-of-the-joomla-0-day-user-agent-exploit/
* https://translate.google.com/translate?hl=en&sl=auto&tl=en&u=http%3A%2F%2Fdrops.wooyun.org%2Fpapers%2F11330
* https://translate.google.com/translate?hl=en&sl=auto&tl=en&u=http%3A%2F%2Fwww.freebuf.com%2Fvuls%2F89754.html
* https://bugs.php.net/bug.php?id=70219



## Targets
* Joomla 1.5.0 - 3.4.5


## Platforms
php

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/http/joomla_http_header_rce
msf exploit(joomla_http_header_rce) > show targets
   ... a list of targets ...
msf exploit(joomla_http_header_rce) > set TARGET <target-id>
msf exploit(joomla_http_header_rce) > show options
   ... show and set options ...
msf exploit(joomla_http_header_rce) > run
```
    
    