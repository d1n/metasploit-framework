## HP SiteScope Remote Code Execution

This module exploits a code execution flaw in HP SiteScope. 
It exploits two vulnerabilities in order to get its 
objective. An authentication bypass in the create operation, 
available through the APIPreferenceImpl AXIS service, to 
create a new account with empty credentials and, 
subsequently, uses the new account to abuse the 
UploadManagerServlet and upload an arbitrary payload 
embedded in a JSP. The module has been tested successfully 
on HP SiteScope 11.20 over Windows 2003 SP2 and Linux CentOS 
6.3.


## Module Name
exploit/multi/http/hp_sitescope_uploadfileshandler

## Authors
* rgod <rgod[at]autistici.org>
* juan vazquez


## References
* http://www.osvdb.org/85121
* http://www.osvdb.org/85151
* http://www.securityfocus.com/bid/55269
* http://www.securityfocus.com/bid/55273
* http://www.zerodayinitiative.com/advisories/ZDI-12-174
* http://www.zerodayinitiative.com/advisories/ZDI-12-175



## Targets
* HP SiteScope 11.20 / Windows 2003 SP2
* HP SiteScope 11.20 / Linux CentOS 6.3


## Platforms
* linux
* win

## Reliability
[Good](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/http/hp_sitescope_uploadfileshandler
msf exploit(hp_sitescope_uploadfileshandler) > show targets
   ... a list of targets ...
msf exploit(hp_sitescope_uploadfileshandler) > set TARGET <target-id>
msf exploit(hp_sitescope_uploadfileshandler) > show options
   ... show and set options ...
msf exploit(hp_sitescope_uploadfileshandler) > run
```
    
    