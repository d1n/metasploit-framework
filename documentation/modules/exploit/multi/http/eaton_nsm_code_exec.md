## Network Shutdown Module (sort_values) Remote PHP Code Injection

This module exploits a vulnerability in Eaton Network 
Shutdown Module version <= 3.21, in lib/dbtools.inc which 
uses unsanitized user input inside a eval() call. 
Additionally the base64 encoded user credentials are 
extracted from the database of the application. Please note 
that in order to be able to steal credentials, the 
vulnerable service must have at least one USV module (an 
entry in the "nodes" table in mgedb.db)


## Module Name
exploit/multi/http/eaton_nsm_code_exec

## Authors
* h0ng10
* sinn3r


## References
* http://www.osvdb.org/83199
* http://secunia.com/advisories/49103/



## Targets
* Generic (PHP Payload)
* Linux x86


## Platforms
* linux
* php

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/http/eaton_nsm_code_exec
msf exploit(eaton_nsm_code_exec) > show targets
   ... a list of targets ...
msf exploit(eaton_nsm_code_exec) > set TARGET <target-id>
msf exploit(eaton_nsm_code_exec) > show options
   ... show and set options ...
msf exploit(eaton_nsm_code_exec) > run
```
    
    