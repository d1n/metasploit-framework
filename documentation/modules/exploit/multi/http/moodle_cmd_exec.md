## Moodle Remote Command Execution

Moodle allows an authenticated user to define spellcheck 
settings via the web interface. The user can update the 
spellcheck mechanism to point to a system-installed aspell 
binary. By updating the path for the spellchecker to an 
arbitrary command, an attacker can run arbitrary commands in 
the context of the web application upon spellchecking 
requests. This module also allows an attacker to leverage 
another privilege escalation vuln. Using the referenced XSS 
vuln, an unprivileged authenticated user can steal an admin 
sesskey and use this to escalate privileges to that of an 
admin, allowing the module to pop a shell as a previously 
unprivileged authenticated user. This module was tested 
against Moodle version 2.5.2 and 2.2.3.


## Module Name
exploit/multi/http/moodle_cmd_exec

## Authors
* Brandon Perry <bperry.volatile[at]gmail.com>


## References
* http://cvedetails.com/cve/2013-3630/
* https://www.exploit-db.com/exploits/28174
* https://community.rapid7.com/community/metasploit/blog/2013/10/30/seven-tricks-and-treats



## Targets
* Automatic


## Platforms
* unix
* linux

## Reliability
[Good](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/http/moodle_cmd_exec
msf exploit(moodle_cmd_exec) > show targets
   ... a list of targets ...
msf exploit(moodle_cmd_exec) > set TARGET <target-id>
msf exploit(moodle_cmd_exec) > show options
   ... show and set options ...
msf exploit(moodle_cmd_exec) > run
```
    
    