## WikkaWiki 1.3.2 Spam Logging PHP Injection

This module exploits a vulnerability found in WikkaWiki. 
When the spam logging feature is enabled, it is possible to 
inject PHP code into the spam log file via the UserAgent 
header , and then request it to execute our payload. There 
are at least three different ways to trigger spam 
protection, this module does so by generating 10 fake URLs 
in a comment (by default, the max_new_comment_urls parameter 
is 6). Please note that in order to use the injection, you 
must manually pick a page first that allows you to add a 
comment, and then set it as 'PAGE'.


## Module Name
exploit/multi/http/wikka_spam_exec

## Authors
* EgiX
* sinn3r


## References
* http://cvedetails.com/cve/2011-4451/
* http://www.osvdb.org/77393
* https://www.exploit-db.com/exploits/18177



## Targets
* WikkaWiki 1.3.2 r1814


## Platforms
* php

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/http/wikka_spam_exec
msf exploit(wikka_spam_exec) > show targets
   ... a list of targets ...
msf exploit(wikka_spam_exec) > set TARGET <target-id>
msf exploit(wikka_spam_exec) > show options
   ... show and set options ...
msf exploit(wikka_spam_exec) > run
```
    
    