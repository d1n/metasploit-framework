## Splunk Custom App Remote Code Execution

This module exploits a feature of Splunk whereby a custom 
application can be uploaded through the web based interface. 
Through the 'script' search command a user can call commands 
defined in their custom application which includes arbitrary 
perl or python code. To abuse this behavior, a valid Splunk 
user with the admin role is required. By default, this 
module uses the credential of "admin:changeme", the default 
Administrator credential for Splunk. Note that the Splunk 
web interface runs as SYSTEM on Windows, or as root on Linux 
by default. This module has been tested successfully against 
Splunk 5.0, 6.1, and 6.1.1.


## Module Name
exploit/multi/http/splunk_upload_app_exec

## Authors
* marcwickenden
* sinn3r
* juan vazquez
* Gary Blosser


## References
* http://blog.7elements.co.uk/2012/11/splunk-with-great-power-comes-great-responsibility.html
* http://blog.7elements.co.uk/2012/11/abusing-splunk-with-metasploit.html
* http://docs.splunk.com/Documentation/Splunk/latest/SearchReference/Script



## Targets
* Splunk >= 5.0.1 / Linux
* Splunk >= 5.0.1 / Windows


## Platforms
* linux
* unix
* win

## Reliability
[Good](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/http/splunk_upload_app_exec
msf exploit(splunk_upload_app_exec) > show targets
   ... a list of targets ...
msf exploit(splunk_upload_app_exec) > set TARGET <target-id>
msf exploit(splunk_upload_app_exec) > show options
   ... show and set options ...
msf exploit(splunk_upload_app_exec) > run
```
    
    