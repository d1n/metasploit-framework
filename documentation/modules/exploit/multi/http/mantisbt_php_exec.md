## MantisBT XmlImportExport Plugin PHP Code Injection Vulnerability

This module exploits a post-auth vulnerability found in 
MantisBT versions 1.2.0a3 up to 1.2.17 when the 
Import/Export plugin is installed. The vulnerable code 
exists on plugins/XmlImportExport/ImportXml.php, which 
receives user input through the "description" field and the 
"issuelink" attribute of an uploaded XML file and passes to 
preg_replace() function with the /e modifier. This allows a 
remote authenticated attacker to execute arbitrary PHP code 
on the remote machine. This version also suffers from 
another issue. The import page is not checking the correct 
user level of the user, so it's possible to exploit this 
issue with any user including the anonymous one if enabled.


## Module Name
exploit/multi/http/mantisbt_php_exec

## Authors
* Egidio Romano
* Juan Escobar <eng.jescobar[at]gmail.com>
* Christian Mehlmauer


## References
* http://cvedetails.com/cve/2014-7146/
* http://cvedetails.com/cve/2014-8598/
* https://www.mantisbt.org/bugs/view.php?id=17725
* https://www.mantisbt.org/bugs/view.php?id=17780



## Targets
* Generic (PHP Payload)


## Platforms
php

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/http/mantisbt_php_exec
msf exploit(mantisbt_php_exec) > show targets
   ... a list of targets ...
msf exploit(mantisbt_php_exec) > set TARGET <target-id>
msf exploit(mantisbt_php_exec) > show options
   ... show and set options ...
msf exploit(mantisbt_php_exec) > run
```
    
    