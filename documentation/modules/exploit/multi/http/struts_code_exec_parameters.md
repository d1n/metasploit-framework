## Apache Struts ParametersInterceptor Remote Code Execution

This module exploits a remote command execution 
vulnerability in Apache Struts versions < 2.3.1.2. This 
issue is caused because the ParametersInterceptor allows for 
the use of parentheses which in turn allows it to interpret 
parameter values as OGNL expressions during certain 
exception handling for mismatched data types of properties 
which allows remote attackers to execute arbitrary Java code 
via a crafted parameter.


## Module Name
exploit/multi/http/struts_code_exec_parameters

## Authors
* Meder Kydyraliev
* Richard Hicks <scriptmonkey.blog[at]gmail.com>
* mihi
* Christian Mehlmauer


## References
* http://cvedetails.com/cve/2011-3923/
* http://www.osvdb.org/78501
* http://blog.o0o.nu/2012/01/cve-2011-3923-yet-another-struts2.html
* https://cwiki.apache.org/confluence/display/WW/S2-009



## Targets
* Windows Universal
* Linux Universal
* Java Universal


## Platforms
* java
* linux
* win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/http/struts_code_exec_parameters
msf exploit(struts_code_exec_parameters) > show targets
   ... a list of targets ...
msf exploit(struts_code_exec_parameters) > set TARGET <target-id>
msf exploit(struts_code_exec_parameters) > show options
   ... show and set options ...
msf exploit(struts_code_exec_parameters) > run
```
    
    