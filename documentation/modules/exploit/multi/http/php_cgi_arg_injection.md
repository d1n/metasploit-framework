## PHP CGI Argument Injection

When run as a CGI, PHP up to version 5.3.12 and 5.4.2 is 
vulnerable to an argument injection vulnerability. This 
module takes advantage of the -d flag to set php.ini 
directives to achieve code execution. From the advisory: "if 
there is NO unescaped '=' in the query string, the string is 
split on '+' (encoded space) characters, urldecoded, passed 
to a function that escapes shell metacharacters (the 
"encoded in a system-defined manner" from the RFC) and then 
passes them to the CGI binary." This module can also be used 
to exploit the plesk 0day disclosed by kingcope and 
exploited in the wild on June 2013.


## Module Name
exploit/multi/http/php_cgi_arg_injection

## Authors
* egypt
* hdm
* jjarmoc
* kingcope
* juan vazquez


## References
* http://cvedetails.com/cve/2012-1823/
* http://www.osvdb.org/81633
* http://www.osvdb.org/93979
* https://www.exploit-db.com/exploits/25986
* http://eindbazen.net/2012/05/php-cgi-advisory-cve-2012-1823/
* http://kb.parallels.com/en/116241



## Targets
* Automatic


## Platforms
php

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/http/php_cgi_arg_injection
msf exploit(php_cgi_arg_injection) > show targets
   ... a list of targets ...
msf exploit(php_cgi_arg_injection) > set TARGET <target-id>
msf exploit(php_cgi_arg_injection) > show options
   ... show and set options ...
msf exploit(php_cgi_arg_injection) > run
```
    
    