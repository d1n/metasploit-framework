## Ruby on Rails XML Processor YAML Deserialization Code Execution

This module exploits a remote code execution vulnerability 
in the XML request processor of the Ruby on Rails 
application framework. This vulnerability allows an attacker 
to instantiate a remote object, which in turn can be used to 
execute any ruby code remotely in the context of the 
application. This module has been tested across multiple 
versions of RoR 3.x and RoR 2.x The technique used by this 
module requires the target to be running a fairly recent 
version of Ruby 1.9 (since 2011 or so). Applications using 
Ruby 1.8 may still be exploitable using the init_with() 
method, but this has not been demonstrated.


## Module Name
exploit/multi/http/rails_xml_yaml_code_exec

## Authors
* charliesome
* espes
* lian
* hdm


## References
* http://cvedetails.com/cve/2013-0156/
* http://www.osvdb.org/89026
* https://community.rapid7.com/community/metasploit/blog/2013/01/09/serialization-mischief-in-ruby-land-cve-2013-0156



## Targets
* Automatic


## Platforms
ruby

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/http/rails_xml_yaml_code_exec
msf exploit(rails_xml_yaml_code_exec) > show targets
   ... a list of targets ...
msf exploit(rails_xml_yaml_code_exec) > set TARGET <target-id>
msf exploit(rails_xml_yaml_code_exec) > show options
   ... show and set options ...
msf exploit(rails_xml_yaml_code_exec) > run
```
    
    