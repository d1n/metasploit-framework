## Splunk Search Remote Code Execution

This module abuses a command execution vulnerability in the 
web based interface of Splunk 4.2 to 4.2.4. The 
vulnerability exists in the 'mappy' search command which 
allows attackers to run Python code. To exploit this 
vulnerability, a valid Splunk user with the admin role is 
required. By default, this module uses the credential of 
"admin:changeme", the default Administrator credential for 
Splunk. Note that the Splunk web interface runs as SYSTEM on 
Windows and as root on Linux by default.


## Module Name
exploit/multi/http/splunk_mappy_exec

## Authors
* Gary O'Leary-Steele
* juan vazquez


## References
* http://www.osvdb.org/77695
* http://www.securityfocus.com/bid/51061
* http://cvedetails.com/cve/2011-4642/
* http://www.splunk.com/view/SP-CAAAGMM
* http://www.sec-1.com/blog/?p=233



## Targets
* Universal CMD


## Platforms
* linux
* unix
* win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/http/splunk_mappy_exec
msf exploit(splunk_mappy_exec) > show targets
   ... a list of targets ...
msf exploit(splunk_mappy_exec) > set TARGET <target-id>
msf exploit(splunk_mappy_exec) > show options
   ... show and set options ...
msf exploit(splunk_mappy_exec) > run
```
    
    