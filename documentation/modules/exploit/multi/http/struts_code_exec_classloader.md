## Apache Struts ClassLoader Manipulation Remote Code Execution

This module exploits a remote command execution 
vulnerability in Apache Struts versions 1.x (<= 1.3.10) and 
2.x (< 2.3.16.2). In Struts 1.x the problem is related with 
the ActionForm bean population mechanism while in case of 
Struts 2.x the vulnerability is due to the 
ParametersInterceptor. Both allow access to 'class' 
parameter that is directly mapped to getClass() method and 
allows ClassLoader manipulation. As a result, this can allow 
remote attackers to execute arbitrary Java code via crafted 
parameters.


## Module Name
exploit/multi/http/struts_code_exec_classloader

## Authors
* Mark Thomas
* Przemyslaw Celej
* Redsadic <julian.vilas[at]gmail.com>
* Matthew Hall <hallm[at]sec-1.com>


## References
* http://cvedetails.com/cve/2014-0094/
* http://cvedetails.com/cve/2014-0112/
* http://cvedetails.com/cve/2014-0114/
* http://www.pwntester.com/blog/2014/04/24/struts2-0day-in-the-wild/
* http://struts.apache.org/release/2.3.x/docs/s2-020.html
* http://h30499.www3.hp.com/t5/HP-Security-Research-Blog/Update-your-Struts-1-ClassLoader-manipulation-filters/ba-p/6639204
* https://github.com/rgielen/struts1filter/tree/develop



## Targets
* Java
* Linux
* Windows
* Windows / Tomcat 6 & 7 and GlassFish 4 (Remote SMB Resource)


## Platforms
* linux
* win

## Reliability
[Manual](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/http/struts_code_exec_classloader
msf exploit(struts_code_exec_classloader) > show targets
   ... a list of targets ...
msf exploit(struts_code_exec_classloader) > set TARGET <target-id>
msf exploit(struts_code_exec_classloader) > show options
   ... show and set options ...
msf exploit(struts_code_exec_classloader) > run
```
    
    