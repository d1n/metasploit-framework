## Traq admincp/common.php Remote Code Execution

This module exploits an arbitrary command execution 
vulnerability in Traq 2.0 to 2.3. It's in the 
admincp/common.php script. This function is called in each 
script located in the /admicp/ directory to make sure the 
user has admin rights. This is a broken authorization schema 
because the header() function doesn't stop the execution 
flow. This can be exploited by malicious users to execute 
admin functionality, e.g. execution of arbitrary PHP code 
leveraging of plugins.php functionality.


## Module Name
exploit/multi/http/traq_plugin_exec

## Authors
* EgiX
* TecR0c <roccogiovannicalvi[at]gmail.com>


## References
* http://www.osvdb.org/77556
* https://www.exploit-db.com/exploits/18213
* http://traqproject.org/



## Targets
* Automatic


## Platforms
* php

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/http/traq_plugin_exec
msf exploit(traq_plugin_exec) > show targets
   ... a list of targets ...
msf exploit(traq_plugin_exec) > set TARGET <target-id>
msf exploit(traq_plugin_exec) > show options
   ... show and set options ...
msf exploit(traq_plugin_exec) > run
```
    
    