## Java 7 Applet Remote Code Execution

The exploit takes advantage of two issues in JDK 7: The 
ClassFinder and MethodFinder.findMethod(). Both were newly 
introduced in JDK 7. ClassFinder is a replacement for 
classForName back in JDK 6. It allows untrusted code to 
obtain a reference and have access to a restricted package 
in JDK 7, which can be used to abuse sun.awt.SunToolkit (a 
restricted package). With sun.awt.SunToolkit, we can 
actually invoke getField() by abusing findMethod() in 
Statement.invokeInternal() (but getField() must be public, 
and that's not always the case in JDK 6) in order to access 
Statement.acc's private field, modify AccessControlContext, 
and then disable Security Manager. Once Security Manager is 
disabled, we can execute arbitrary Java code. Our exploit 
has been tested successfully against multiple platforms, 
including: IE, Firefox, Safari, Chrome; Windows, Ubuntu, OS 
X, Solaris, etc.


## Module Name
exploit/multi/browser/java_jre17_exec

## Authors
* Adam Gowdiak
* James Forshaw
* jduck
* sinn3r
* juan vazquez


## References
* http://cvedetails.com/cve/2012-4681/
* http://www.osvdb.org/84867
* http://blog.fireeye.com/research/2012/08/zero-day-season-is-not-over-yet.html
* http://www.deependresearch.org/2012/08/java-7-vulnerability-analysis.html
* http://labs.alienvault.com/labs/index.php/2012/new-java-0day-exploited-in-the-wild/
* http://www.deependresearch.org/2012/08/java-7-0-day-vulnerability-information.html
* http://www.oracle.com/technetwork/topics/security/alert-cve-2012-4681-1835715.html
* https://community.rapid7.com/community/metasploit/blog/2012/08/27/lets-start-the-week-with-a-new-java-0day
* https://bugzilla.redhat.com/show_bug.cgi?id=852051



## Targets
* Generic (Java Payload)
* Windows Universal
* Linux x86


## Platforms
* java
* linux
* win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/browser/java_jre17_exec
msf exploit(java_jre17_exec) > show targets
   ... a list of targets ...
msf exploit(java_jre17_exec) > set TARGET <target-id>
msf exploit(java_jre17_exec) > show options
   ... show and set options ...
msf exploit(java_jre17_exec) > run
```
    
    