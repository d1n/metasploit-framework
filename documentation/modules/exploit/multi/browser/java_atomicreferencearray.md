## Java AtomicReferenceArray Type Violation Vulnerability

This module exploits a vulnerability due to the fact that 
AtomicReferenceArray uses the Unsafe class to store a 
reference in an array directly, which may violate type 
safety if not used properly. This allows a way to escape the 
JRE sandbox, and load additional classes in order to perform 
malicious operations.


## Module Name
exploit/multi/browser/java_atomicreferencearray

## Authors
* Jeroen Frijters
* sinn3r
* juan vazquez
* egypt


## References
* http://cvedetails.com/cve/2012-0507/
* http://www.osvdb.org/80724
* http://www.securityfocus.com/bid/52161
* http://weblog.ikvm.net/PermaLink.aspx?guid=cd48169a-9405-4f63-9087-798c4a1866d3
* http://blogs.technet.com/b/mmpc/archive/2012/03/20/an-interesting-case-of-jre-sandbox-breach-cve-2012-0507.aspx
* http://schierlm.users.sourceforge.net/TypeConfusion.html
* https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2012-0507
* https://community.rapid7.com/community/metasploit/blog/2012/03/29/cve-2012-0507--java-strikes-again



## Targets
* Generic (Java Payload)
* Windows x86 (Native Payload)
* Mac OS X PPC (Native Payload)
* Mac OS X x86 (Native Payload)
* Linux x86 (Native Payload)


## Platforms
* java
* linux
* osx
* solaris
* win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/browser/java_atomicreferencearray
msf exploit(java_atomicreferencearray) > show targets
   ... a list of targets ...
msf exploit(java_atomicreferencearray) > set TARGET <target-id>
msf exploit(java_atomicreferencearray) > show options
   ... show and set options ...
msf exploit(java_atomicreferencearray) > run
```
    
    