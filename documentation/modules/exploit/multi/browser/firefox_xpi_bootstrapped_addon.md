## Mozilla Firefox Bootstrapped Addon Social Engineering Code Execution

This exploit dynamically creates a .xpi addon file. The 
resulting bootstrapped Firefox addon is presented to the 
victim via a web page. The victim's Firefox browser will pop 
a dialog asking if they trust the addon. Once the user 
clicks "install", the addon is installed and executes the 
payload with full user permissions. As of Firefox 4, this 
will work without a restart as the addon is marked to be 
"bootstrapped". As the addon will execute the payload after 
each Firefox restart, an option can be given to 
automatically uninstall the addon once the payload has been 
executed.


## Module Name
exploit/multi/browser/firefox_xpi_bootstrapped_addon

## Authors
* mihi
* joev


## References
* https://developer.mozilla.org/en/Extensions/Bootstrapped_extensions
* http://dvlabs.tippingpoint.com/blog/2007/06/27/xpi-the-next-malware-vector



## Targets
* Universal (Javascript XPCOM Shell)
* Native Payload


## Platforms
* java
* linux
* osx
* solaris
* win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/browser/firefox_xpi_bootstrapped_addon
msf exploit(firefox_xpi_bootstrapped_addon) > show targets
   ... a list of targets ...
msf exploit(firefox_xpi_bootstrapped_addon) > set TARGET <target-id>
msf exploit(firefox_xpi_bootstrapped_addon) > show options
   ... show and set options ...
msf exploit(firefox_xpi_bootstrapped_addon) > run
```
    
    