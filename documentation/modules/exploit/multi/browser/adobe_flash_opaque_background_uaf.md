## Adobe Flash opaqueBackground Use After Free

This module exploits an use after free on Adobe Flash 
Player. The vulnerability, discovered by Hacking Team and 
made public as part of the July 2015 data leak, was 
described as an Use After Free while handling the 
opaqueBackground property 7 setter of the 
flash.display.DisplayObject class. This module is an early 
release tested on: Windows XP SP3, IE8 and Flash 18.0.0.194, 
Windows XP SP3, IE 8 and Flash 18.0.0.203, Windows XP SP3, 
Firefox and Flash 18.0.0.203, Windows Vista SP2 + IE 9 and 
Flash 18.0.0.203, Windows Vista SP2 + Firefox 39.0 and Flash 
18.0.0.203, Windows 7 SP1 (32-bit), IE11 and Adobe Flash 
18.0.0.203, Windows 7 SP1 (32-bit), Firefox 38.0.5 and Adobe 
Flash 18.0.0.194, Windows 7 SP1 (32-bit), IE9 and Adobe 
Flash Flash 18.0.0.203, Windows 7 SP1 (32-bit), Firefox and 
Adobe Flash 18.0.0.194, Windows 8.1 (32-bit), IE11 and Adobe 
Flash 18.0.0.194, windows 8.1 (32-bit), Firefox and Adobe 
Flash 18.0.0.203, Windows 8.1 (32-bit), Firefox and Adobe 
Flash 18.0.0.160 and Windows 8.1 (32-bit), Firefox and Adobe 
Flash 18.0.0.194


## Module Name
exploit/multi/browser/adobe_flash_opaque_background_uaf

## Authors
* Unknown
* juan vazquez
* sinn3r


## References
* http://cvedetails.com/cve/2015-5122/
* https://www.fireeye.com/blog/threat-research/2015/07/cve-2015-5122_-_seco.html
* https://helpx.adobe.com/security/products/flash-player/apsa15-04.html
* https://helpx.adobe.com/security/products/flash-player/apsb15-18.html



## Targets
* Windows


## Platforms
* win

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/browser/adobe_flash_opaque_background_uaf
msf exploit(adobe_flash_opaque_background_uaf) > show targets
   ... a list of targets ...
msf exploit(adobe_flash_opaque_background_uaf) > set TARGET <target-id>
msf exploit(adobe_flash_opaque_background_uaf) > show options
   ... show and set options ...
msf exploit(adobe_flash_opaque_background_uaf) > run
```
    
    