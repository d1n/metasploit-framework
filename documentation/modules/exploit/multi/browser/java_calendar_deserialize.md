## Sun Java Calendar Deserialization Privilege Escalation

This module exploits a flaw in the deserialization of 
Calendar objects in the Sun JVM. The payload can be either a 
native payload which is generated as an executable and 
dropped/executed on the target or a shell from within the 
Java applet in the target browser. The affected Java 
versions are JDK and JRE 6 Update 10 and earlier, JDK and 
JRE 5.0 Update 16 and earlier, SDK and JRE 1.4.2_18 and 
earlier (SDK and JRE 1.3.1 are not affected).


## Module Name
exploit/multi/browser/java_calendar_deserialize

## Authors
* sf
* hdm


## References
* http://cvedetails.com/cve/2008-5353/
* http://www.osvdb.org/50500
* http://slightlyrandombrokenthoughts.blogspot.com/2008/12/calendar-bug.html
* http://landonf.bikemonkey.org/code/macosx/CVE-2008-5353.20090519.html
* http://blog.cr0.org/2009/05/write-once-own-everyone.html



## Targets
* Generic (Java Payload)
* Windows x86 (Native Payload)
* Mac OS X PPC (Native Payload)
* Mac OS X x86 (Native Payload)
* Linux x86 (Native Payload)


## Platforms
* linux
* osx
* solaris
* win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/browser/java_calendar_deserialize
msf exploit(java_calendar_deserialize) > show targets
   ... a list of targets ...
msf exploit(java_calendar_deserialize) > set TARGET <target-id>
msf exploit(java_calendar_deserialize) > show options
   ... show and set options ...
msf exploit(java_calendar_deserialize) > run
```
    
    