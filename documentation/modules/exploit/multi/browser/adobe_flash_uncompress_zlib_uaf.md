## Adobe Flash Player ByteArray UncompressViaZlibVariant Use After Free

This module exploits a use after free vulnerability in Adobe 
Flash Player. The vulnerability occurs in the 
ByteArray::UncompressViaZlibVariant method, when trying to 
uncompress() a malformed byte stream. This module has been 
tested successfully on: * Windows 7 SP1 (32 bits), IE 8 to 
IE 11 and Flash 16.0.0.287, 16.0.0.257 and 16.0.0.235. * 
Windows 7 SP1 (32-bit), Firefox 38.0.5 and Adobe Flash 
16.0.0.287. * Windows 8.1, Firefox 38.0.5 and Adobe Flash 
16.0.0.305. * Linux Mint "Rebecca" (32 bits), Firefox 33.0 
and Flash 11.2.202.424.


## Module Name
exploit/multi/browser/adobe_flash_uncompress_zlib_uaf

## Authors
* Unknown
* hdarwin
* juan vazquez


## References
* http://cvedetails.com/cve/2015-0311/
* https://helpx.adobe.com/security/products/flash-player/apsa15-01.html
* http://blog.hacklab.kr/flash-cve-2015-0311-%EB%B6%84%EC%84%9D/
* http://blog.coresecurity.com/2015/03/04/exploiting-cve-2015-0311-a-use-after-free-in-adobe-flash-player/



## Targets
* Windows
* Linux


## Platforms
* win
* linux

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/browser/adobe_flash_uncompress_zlib_uaf
msf exploit(adobe_flash_uncompress_zlib_uaf) > show targets
   ... a list of targets ...
msf exploit(adobe_flash_uncompress_zlib_uaf) > set TARGET <target-id>
msf exploit(adobe_flash_uncompress_zlib_uaf) > show options
   ... show and set options ...
msf exploit(adobe_flash_uncompress_zlib_uaf) > run
```
    
    