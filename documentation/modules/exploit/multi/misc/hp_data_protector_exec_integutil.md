## HP Data Protector EXEC_INTEGUTIL Remote Code Execution

This exploit abuses a vulnerability in the HP Data 
Protector. The vulnerability exists in the Backup client 
service, which listens by default on TCP/5555. The 
EXEC_INTEGUTIL request allows to execute arbitrary commands 
from a restricted directory. Since it includes a perl 
executable, it's possible to use an EXEC_INTEGUTIL packet to 
execute arbitrary code. On linux targets, the perl binary 
isn't on the restricted directory, but an EXEC_BAR packet 
can be used to access the perl binary, even in the last 
version of HP Data Protector for linux. This module has been 
tested successfully on HP Data Protector 9 over Windows 2008 
R2 64 bits and CentOS 6 64 bits.


## Module Name
exploit/multi/misc/hp_data_protector_exec_integutil

## Authors
* Aniway.Anyway <Aniway.Anyway[at]gmail.com>
* juan vazquez


## References
* http://www.zerodayinitiative.com/advisories/ZDI-14-344



## Targets
* Linux 64 bits / HP Data Protector 9
* Windows 64 bits / HP Data Protector 9


## Platforms


## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/misc/hp_data_protector_exec_integutil
msf exploit(hp_data_protector_exec_integutil) > show targets
   ... a list of targets ...
msf exploit(hp_data_protector_exec_integutil) > set TARGET <target-id>
msf exploit(hp_data_protector_exec_integutil) > show options
   ... show and set options ...
msf exploit(hp_data_protector_exec_integutil) > run
```
    
    