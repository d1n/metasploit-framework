## Western Digital Arkeia Remote Code Execution

This module exploits a code execution flaw in Western 
Digital Arkeia version 11.0.12 and below. The vulnerability 
exists in the 'arkeiad' daemon listening on TCP port 617. 
Because there are insufficient checks on the authentication 
of all clients, this can be bypassed. Using the 
ARKFS_EXEC_CMD operation it's possible to execute arbitrary 
commands with root or SYSTEM privileges. The daemon is 
installed on both the Arkeia server as well on all the 
backup clients. The module has been successfully tested on 
Windows, Linux, OSX, FreeBSD and OpenBSD.


## Module Name
exploit/multi/misc/arkeia_agent_exec

## Authors
* xistence <xistence[at]0x90.nl>


## References
* http://cvedetails.com/cve/2015-7709/
* https://www.exploit-db.com/exploits/37600
* http://seclists.org/fulldisclosure/2015/Jul/54



## Targets
* Windows
* Linux


## Platforms


## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/misc/arkeia_agent_exec
msf exploit(arkeia_agent_exec) > show targets
   ... a list of targets ...
msf exploit(arkeia_agent_exec) > set TARGET <target-id>
msf exploit(arkeia_agent_exec) > show options
   ... show and set options ...
msf exploit(arkeia_agent_exec) > run
```
    
    