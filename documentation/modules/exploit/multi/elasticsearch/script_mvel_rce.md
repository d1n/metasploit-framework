## ElasticSearch Dynamic Script Arbitrary Java Execution

This module exploits a remote command execution (RCE) 
vulnerability in ElasticSearch, exploitable by default on 
ElasticSearch prior to 1.2.0. The bug is found in the REST 
API, which does not require authentication, where the search 
function allows dynamic scripts execution. It can be used 
for remote attackers to execute arbitrary Java code. This 
module has been tested successfully on ElasticSearch 1.1.1 
on Ubuntu Server 12.04 and Windows XP SP3.


## Module Name
exploit/multi/elasticsearch/script_mvel_rce

## Authors
* Alex Brasetvik
* Bouke van der Bijl
* juan vazquez


## References
* http://cvedetails.com/cve/2014-3120/
* http://www.osvdb.org/106949
* https://www.exploit-db.com/exploits/33370
* http://bouk.co/blog/elasticsearch-rce/
* https://www.found.no/foundation/elasticsearch-security/#staying-safe-while-developing-with-elasticsearch



## Targets
* ElasticSearch 1.1.1 / Automatic


## Platforms
java

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/elasticsearch/script_mvel_rce
msf exploit(script_mvel_rce) > show targets
   ... a list of targets ...
msf exploit(script_mvel_rce) > set TARGET <target-id>
msf exploit(script_mvel_rce) > show options
   ... show and set options ...
msf exploit(script_mvel_rce) > run
```
    
    