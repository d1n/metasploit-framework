## ElasticSearch Search Groovy Sandbox Bypass

This module exploits a remote command execution (RCE) 
vulnerability in ElasticSearch, exploitable by default on 
ElasticSearch prior to 1.4.3. The bug is found in the REST 
API, which does not require authentication, where the search 
function allows groovy code execution and its sandbox can be 
bypassed using java.lang.Math.class.forName to reference 
arbitrary classes. It can be used to execute arbitrary Java 
code. This module has been tested successfully on 
ElasticSearch 1.4.2 on Ubuntu Server 12.04.


## Module Name
exploit/multi/elasticsearch/search_groovy_script

## Authors
* Cameron Morris
* Darren Martyn
* juan vazquez


## References
* http://cvedetails.com/cve/2015-1427/
* https://jordan-wright.github.io/blog/2015/03/08/elasticsearch-rce-vulnerability-cve-2015-1427/
* https://github.com/XiphosResearch/exploits/tree/master/ElasticSearch
* http://drops.wooyun.org/papers/5107



## Targets
* ElasticSearch 1.4.2


## Platforms
java

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/elasticsearch/search_groovy_script
msf exploit(search_groovy_script) > show targets
   ... a list of targets ...
msf exploit(search_groovy_script) > set TARGET <target-id>
msf exploit(search_groovy_script) > show options
   ... show and set options ...
msf exploit(search_groovy_script) > run
```
    
    