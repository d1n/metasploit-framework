## Snort 2 DCE/RPC Preprocessor Buffer Overflow

This module allows remote attackers to execute arbitrary 
code by exploiting the Snort service via crafted SMB 
traffic. The vulnerability is due to a boundary error within 
the DCE/RPC preprocessor when reassembling SMB Write AndX 
requests, which may result a stack-based buffer overflow 
with a specially crafted packet sent on a network that is 
monitored by Snort. Vulnerable versions include Snort 2.6.1, 
2.7 Beta 1 and SourceFire IDS 4.1, 4.5 and 4.6. Any host on 
the Snort network may be used as the remote host. The remote 
host does not need to be running the SMB service for the 
exploit to be successful.


## Module Name
exploit/multi/ids/snort_dce_rpc

## Authors
* Neel Mehta
* Trirat Puttaraksa
* Carsten Maartmann-Moe <carsten[at]carmaa.com>
* 0a29406d9794e4f9b30b3c5d6702c708


## References
* http://www.osvdb.org/32094
* http://cvedetails.com/cve/2006-5276/
* http://web.archive.org/web/20070221235015/http://www.snort.org/docs/advisory-2007-02-19.html
* http://sf-freedom.blogspot.com/2007/02/snort-261-dcerpc-preprocessor-remote.html
* http://downloads.securityfocus.com/vulnerabilities/exploits/22616-linux.py



## Targets
* Windows Universal
* Redhat 8


## Platforms
* win
* linux

## Reliability
[Good](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/multi/ids/snort_dce_rpc
msf exploit(snort_dce_rpc) > show targets
   ... a list of targets ...
msf exploit(snort_dce_rpc) > set TARGET <target-id>
msf exploit(snort_dce_rpc) > show options
   ... show and set options ...
msf exploit(snort_dce_rpc) > run
```
    
    