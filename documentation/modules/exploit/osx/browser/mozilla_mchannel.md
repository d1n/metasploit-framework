## Mozilla Firefox 3.6.16 mChannel Use-After-Free

This module exploits a use-after-free vulnerability in 
Mozilla Firefox 3.6.16. An OBJECT element, mChannel, can be 
freed via the OnChannelRedirect method of the 
nsIChannelEventSink Interface. mChannel becomes a dangling 
pointer and can be reused when setting the OBJECTs data 
attribute. This module has been tested on Mac OS X 10.6.6, 
10.6.7, 10.6.8, 10.7.2 and 10.7.3.


## Module Name
exploit/osx/browser/mozilla_mchannel

## Authors
* regenrecht
* Rh0
* argp <argp[at]census-labs.com>


## References
* http://cvedetails.com/cve/2011-0065/
* http://www.osvdb.org/72085
* https://bugzilla.mozilla.org/show_bug.cgi?id=634986
* http://www.mozilla.org/security/announce/2011/mfsa2011-13.html



## Targets
* Firefox 3.6.16 on Mac OS X (10.6.6, 10.6.7, 10.6.8, 10.7.2 and 10.7.3)


## Platforms
osx

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/osx/browser/mozilla_mchannel
msf exploit(mozilla_mchannel) > show targets
   ... a list of targets ...
msf exploit(mozilla_mchannel) > set TARGET <target-id>
msf exploit(mozilla_mchannel) > show options
   ... show and set options ...
msf exploit(mozilla_mchannel) > run
```
    
    