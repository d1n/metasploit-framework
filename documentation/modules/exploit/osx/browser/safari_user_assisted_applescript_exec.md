## Safari User-Assisted Applescript Exec Attack

In versions of Mac OS X before 10.11.1, the applescript:// 
URL scheme is provided, which opens the provided script in 
the Applescript Editor. Pressing cmd-R in the Editor 
executes the code without any additional confirmation from 
the user. By getting the user to press cmd-R in Safari, and 
by hooking the cmd-key keypress event, a user can be tricked 
into running arbitrary Applescript code. Gatekeeper should 
be disabled from Security & Privacy in order to avoid the 
unidentified Developer prompt.


## Module Name
exploit/osx/browser/safari_user_assisted_applescript_exec

## Authors
* joev


## References
* http://cvedetails.com/cve/2015-7007/
* https://support.apple.com/en-us/HT205375



## Targets
* Mac OS X


## Platforms
* unix
* osx

## Reliability
[Manual](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/osx/browser/safari_user_assisted_applescript_exec
msf exploit(safari_user_assisted_applescript_exec) > show targets
   ... a list of targets ...
msf exploit(safari_user_assisted_applescript_exec) > set TARGET <target-id>
msf exploit(safari_user_assisted_applescript_exec) > show options
   ... show and set options ...
msf exploit(safari_user_assisted_applescript_exec) > run
```
    
    