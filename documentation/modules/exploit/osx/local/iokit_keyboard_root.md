## Mac OS X IOKit Keyboard Driver Root Privilege Escalation

A heap overflow in IOHIKeyboardMapper::parseKeyMapping 
allows kernel memory corruption in Mac OS X before 10.10. By 
abusing a bug in the IORegistry, kernel pointers can also be 
leaked, allowing a full kASLR bypass. Tested on Mavericks 
10.9.5, and should work on previous versions. The issue was 
patched silently in Yosemite.


## Module Name
exploit/osx/local/iokit_keyboard_root

## Authors
* Ian Beer
* joev


## References
* http://cvedetails.com/cve/2014-4404/
* http://googleprojectzero.blogspot.com/2014/11/pwn4fun-spring-2014-safari-part-ii.html
* https://code.google.com/p/google-security-research/issues/detail?id=40
* https://code.google.com/p/google-security-research/issues/detail?id=126



## Targets
* Mac OS X 10.9.5 Mavericks x64 (Native Payload)


## Platforms
osx

## Reliability
[Manual](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/osx/local/iokit_keyboard_root
msf exploit(iokit_keyboard_root) > show targets
   ... a list of targets ...
msf exploit(iokit_keyboard_root) > set TARGET <target-id>
msf exploit(iokit_keyboard_root) > show options
   ... show and set options ...
msf exploit(iokit_keyboard_root) > run
```
    
    