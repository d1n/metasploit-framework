## Dhclient Bash Environment Variable Injection (Shellshock)

This module exploits the Shellshock vulnerability, a flaw in 
how the Bash shell handles external environment variables. 
This module targets dhclient by responding to DHCP requests 
with a malicious hostname, domainname, and URL which are 
then passed to the configuration scripts as environment 
variables, resulting in code execution. Due to length 
restrictions and the unusual networking scenario at the time 
of exploitation, this module achieves code execution by 
writing the payload into /etc/crontab and then cleaning it 
up after a session is created.


## Module Name
exploit/unix/dhcp/bash_environment

## Authors
* Stephane Chazelas
* egypt


## References
* http://cvedetails.com/cve/2014-6271/
* https://cwe.mitre.org/data/definitions/94.html
* http://www.osvdb.org/112004
* https://www.exploit-db.com/exploits/34765
* https://securityblog.redhat.com/2014/09/24/bash-specially-crafted-environment-variables-code-injection-attack/
* http://seclists.org/oss-sec/2014/q3/649
* https://www.trustedsec.com/september-2014/shellshock-dhcp-rce-proof-concept/



## Targets
* Automatic Target


## Platforms
* unix

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/unix/dhcp/bash_environment
msf exploit(bash_environment) > show targets
   ... a list of targets ...
msf exploit(bash_environment) > set TARGET <target-id>
msf exploit(bash_environment) > show options
   ... show and set options ...
msf exploit(bash_environment) > run
```
    
    