## Joomla Content History SQLi Remote Code Execution

This module exploits a SQL injection vulnerability found in 
Joomla versions 3.2 up to 3.4.4. The vulnerability exists in 
the Content History administrator component in the core of 
Joomla. Triggering the SQL injection makes it possible to 
retrieve active Super User sessions. The cookie can be used 
to login to the Joomla administrator backend. By creating a 
new template file containing our payload, remote code 
execution is made possible.


## Module Name
exploit/unix/webapp/joomla_contenthistory_sqli_rce

## Authors
* Asaf Orpani
* xistence <xistence[at]0x90.nl>


## References
* http://cvedetails.com/cve/2015-7857/
* http://cvedetails.com/cve/2015-7297/
* http://cvedetails.com/cve/2015-7857/
* http://cvedetails.com/cve/2015-7858/
* https://www.trustwave.com/Resources/SpiderLabs-Blog/Joomla-SQL-Injection-Vulnerability-Exploit-Results-in-Full-Administrative-Access/
* http://developer.joomla.org/security-centre/628-20151001-core-sql-injection.html



## Targets
* Joomla 3.x <= 3.4.4


## Platforms
* php

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/unix/webapp/joomla_contenthistory_sqli_rce
msf exploit(joomla_contenthistory_sqli_rce) > show targets
   ... a list of targets ...
msf exploit(joomla_contenthistory_sqli_rce) > set TARGET <target-id>
msf exploit(joomla_contenthistory_sqli_rce) > show options
   ... show and set options ...
msf exploit(joomla_contenthistory_sqli_rce) > run
```
    
    