## OpenEMR 4.1.1 Patch 14 SQLi Privilege Escalation Remote Code Execution

This module exploits a vulnerability found in OpenEMR 
version 4.1.1 Patch 14 and lower. When logging in as any 
non-admin user, it's possible to retrieve the admin SHA1 
password hash from the database through SQL injection. The 
SQL injection vulnerability exists in the 
"new_comprehensive_save.php" page. This hash can be used to 
log in as the admin user. After logging in, the 
"manage_site_files.php" page will be used to upload 
arbitrary code.


## Module Name
exploit/unix/webapp/openemr_sqli_privesc_upload

## Authors
* xistence <xistence[at]0x90.nl>


## References
* http://www.osvdb.org/97482
* https://www.exploit-db.com/exploits/28329



## Targets
* OpenEMR


## Platforms
* php

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/unix/webapp/openemr_sqli_privesc_upload
msf exploit(openemr_sqli_privesc_upload) > show targets
   ... a list of targets ...
msf exploit(openemr_sqli_privesc_upload) > set TARGET <target-id>
msf exploit(openemr_sqli_privesc_upload) > show options
   ... show and set options ...
msf exploit(openemr_sqli_privesc_upload) > run
```
    
    