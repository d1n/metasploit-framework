## Western Digital Arkeia Remote Code Execution

This module exploits a vulnerability found in Western 
Digital Arkeia Appliance version 10.0.10 and lower. By 
abusing the upload.php script, a malicious user can upload 
arbitrary code to the ApplianceUpdate file in the temp 
directory without authentication. Abusing the local file 
inclusion in the lang cookie to parse this file results in 
arbitrary code execution, also without authentication. The 
module has been tested successfully on Arkeia 10.0.10. The 
issues have been fixed in version 10.1.10.


## Module Name
exploit/unix/webapp/arkeia_upload_exec

## Authors
* xistence <xistence[at]0x90.nl>


## References
* http://www.osvdb.org/97614
* http://www.osvdb.org/97615
* https://www.exploit-db.com/exploits/28330



## Targets
* Western Digital Arkeia Appliance 10.0.10


## Platforms
* php

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/unix/webapp/arkeia_upload_exec
msf exploit(arkeia_upload_exec) > show targets
   ... a list of targets ...
msf exploit(arkeia_upload_exec) > set TARGET <target-id>
msf exploit(arkeia_upload_exec) > show options
   ... show and set options ...
msf exploit(arkeia_upload_exec) > run
```
    
    