## WordPress Photo Gallery Unrestricted File Upload

Photo Gallery Plugin for WordPress contains a flaw that 
allows a remote attacker to execute arbitrary PHP code. This 
flaw exists because the photo-gallery\photo-gallery.php 
script allows access to filemanager\UploadHandler.php. The 
post() method in UploadHandler.php does not properly verify 
or sanitize user-uploaded files. This module was tested on 
version 1.2.5.


## Module Name
exploit/unix/webapp/wp_photo_gallery_unrestricted_file_upload

## Authors
* Kacper Szurek
* Rob Carr <rob[at]rastating.com>


## References
* http://www.osvdb.org/117676
* https://wpvulndb.com/vulnerabilities/7769
* http://cvedetails.com/cve/2014-9312/
* http://security.szurek.pl/photo-gallery-125-unrestricted-file-upload.html



## Targets
* photo-gallery < 1.2.6


## Platforms
php

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/unix/webapp/wp_photo_gallery_unrestricted_file_upload
msf exploit(wp_photo_gallery_unrestricted_file_upload) > show targets
   ... a list of targets ...
msf exploit(wp_photo_gallery_unrestricted_file_upload) > set TARGET <target-id>
msf exploit(wp_photo_gallery_unrestricted_file_upload) > show options
   ... show and set options ...
msf exploit(wp_photo_gallery_unrestricted_file_upload) > run
```
    
    