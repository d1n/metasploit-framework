## WordPress W3 Total Cache PHP Code Execution

This module exploits a PHP Code Injection vulnerability 
against WordPress plugin W3 Total Cache for versions up to 
and including 0.9.2.8. WP Super Cache 1.2 or older is also 
reported as vulnerable. The vulnerability is due to the 
handling of certain macros such as mfunc, which allows 
arbitrary PHP code injection. A valid post ID is needed in 
order to add the malicious comment. If the POSTID option 
isn't specified, then the module will automatically find or 
bruteforce one. Also, if anonymous comments aren't allowed, 
then a valid username and password must be provided. In 
addition, the "A comment is held for moderation" option on 
WordPress must be unchecked for successful exploitation. 
This module has been tested against WordPress 3.5 and W3 
Total Cache 0.9.2.3 on a Ubuntu 10.04 system.


## Module Name
exploit/unix/webapp/wp_total_cache_exec

## Authors
* Unknown
* juan vazquez
* hdm
* Christian Mehlmauer


## References
* http://cvedetails.com/cve/2013-2010/
* http://www.osvdb.org/92652
* http://www.securityfocus.com/bid/59316
* http://wordpress.org/support/topic/pwn3d
* http://www.acunetix.com/blog/web-security-zone/wp-plugins-remote-code-execution/
* https://wpvulndb.com/vulnerabilities/6622



## Targets
* Wordpress 3.5


## Platforms
* php

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/unix/webapp/wp_total_cache_exec
msf exploit(wp_total_cache_exec) > show targets
   ... a list of targets ...
msf exploit(wp_total_cache_exec) > set TARGET <target-id>
msf exploit(wp_total_cache_exec) > show options
   ... show and set options ...
msf exploit(wp_total_cache_exec) > run
```
    
    