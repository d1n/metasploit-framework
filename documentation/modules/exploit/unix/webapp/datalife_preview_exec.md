## DataLife Engine preview.php PHP Code Injection

This module exploits a PHP code injection vulnerability 
DataLife Engine 9.7. The vulnerability exists in 
preview.php, due to an insecure usage of preg_replace() with 
the e modifier, which allows to inject arbitrary php code, 
when there is a template installed which contains a 
[catlist] or [not-catlist] tag, even when the template isn't 
in use currently. The template can be configured with the 
TEMPLATE datastore option.


## Module Name
exploit/unix/webapp/datalife_preview_exec

## Authors
* EgiX
* juan vazquez


## References
* http://cvedetails.com/cve/2013-1412/
* http://www.osvdb.org/89662
* https://www.exploit-db.com/exploits/24438
* http://www.securityfocus.com/bid/57603
* http://karmainsecurity.com/KIS-2013-01
* http://dleviet.com/dle/bug-fix/3281-security-patches-for-dle-97.html



## Targets
* DataLife Engine 9.7


## Platforms
* php

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/unix/webapp/datalife_preview_exec
msf exploit(datalife_preview_exec) > show targets
   ... a list of targets ...
msf exploit(datalife_preview_exec) > set TARGET <target-id>
msf exploit(datalife_preview_exec) > show options
   ... show and set options ...
msf exploit(datalife_preview_exec) > run
```
    
    