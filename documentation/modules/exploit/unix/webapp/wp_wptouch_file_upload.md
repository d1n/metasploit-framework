## Wordpress WPTouch Authenticated File Upload

The Wordpress WPTouch plugin contains an auhtenticated file 
upload vulnerability. A wp-nonce (CSRF token) is created on 
the backend index page and the same token is used on 
handling ajax file uploads through the plugin. By sending 
the captured nonce with the upload, we can upload arbitrary 
files to the upload folder. Because the plugin also uses 
it's own file upload mechanism instead of the wordpress api 
it's possible to upload any file type. The user provided 
does not need special rights, and users with "Contributor" 
role can be abused.


## Module Name
exploit/unix/webapp/wp_wptouch_file_upload

## Authors
* Marc-Alexandre Montpas
* Christian Mehlmauer


## References
* http://blog.sucuri.net/2014/07/disclosure-insecure-nonce-generation-in-wptouch.html
* https://wpvulndb.com/vulnerabilities/7118



## Targets
* wptouch < 3.4.3


## Platforms
* php

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/unix/webapp/wp_wptouch_file_upload
msf exploit(wp_wptouch_file_upload) > show targets
   ... a list of targets ...
msf exploit(wp_wptouch_file_upload) > set TARGET <target-id>
msf exploit(wp_wptouch_file_upload) > show options
   ... show and set options ...
msf exploit(wp_wptouch_file_upload) > run
```
    
    