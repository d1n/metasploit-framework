## SugarCRM unserialize() PHP Code Execution

This module exploits a php unserialize() vulnerability in 
SugarCRM <= 6.3.1 which could be abused to allow 
authenticated SugarCRM users to execute arbitrary code with 
the permissions of the webserver. The dangerous 
unserialize() exists in the 
'include/MVC/View/views/view.list.php' script, which is 
called with user controlled data from the 
'current_query_by_page' parameter. The exploit abuses the 
__destruct() method from the SugarTheme class to write 
arbitrary PHP code to a 'pathCache.php' on the web root.


## Module Name
exploit/unix/webapp/sugarcrm_unserialize_exec

## Authors
* EgiX
* juan vazquez
* sinn3r


## References
* http://cvedetails.com/cve/2012-0694/
* http://www.osvdb.org/83361
* https://www.exploit-db.com/exploits/19381
* http://www.sugarcrm.com/forums/f22/critical-security-vulnerability-76537/



## Targets
* Automatic


## Platforms
* php

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/unix/webapp/sugarcrm_unserialize_exec
msf exploit(sugarcrm_unserialize_exec) > show targets
   ... a list of targets ...
msf exploit(sugarcrm_unserialize_exec) > set TARGET <target-id>
msf exploit(sugarcrm_unserialize_exec) > show options
   ... show and set options ...
msf exploit(sugarcrm_unserialize_exec) > run
```
    
    