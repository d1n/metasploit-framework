## phpBB viewtopic.php Arbitrary Code Execution

This module exploits two arbitrary PHP code execution flaws 
in the phpBB forum system. The problem is that the 
'highlight' parameter in the 'viewtopic.php' script is not 
verified properly and will allow an attacker to inject 
arbitrary code via preg_replace(). This vulnerability was 
introduced in revision 3076, and finally fixed in revision 
5166. According to the "tags" within their tree, this 
corresponds to versions 2.0.4 through 2.0.15 (inclusive).


## Module Name
exploit/unix/webapp/phpbb_highlight

## Authors
* valsmith[at]metasploit.com
* hdm
* patrick


## References
* http://cvedetails.com/cve/2005-2086/
* http://cvedetails.com/cve/2004-1315/
* http://www.osvdb.org/11719
* http://www.osvdb.org/17613
* http://www.securityfocus.com/bid/14086
* http://www.securityfocus.com/bid/10701



## Targets
* Automatic
* phpbb <=2.0.10
* phpbb <=2.0.15


## Platforms
unix

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/unix/webapp/phpbb_highlight
msf exploit(phpbb_highlight) > show targets
   ... a list of targets ...
msf exploit(phpbb_highlight) > set TARGET <target-id>
msf exploit(phpbb_highlight) > show options
   ... show and set options ...
msf exploit(phpbb_highlight) > run
```
    
    