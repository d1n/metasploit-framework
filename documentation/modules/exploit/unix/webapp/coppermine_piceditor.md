## Coppermine Photo Gallery picEditor.php Command Execution

This module exploits a vulnerability in the picEditor.php 
script of Coppermine Photo Gallery versions 1.4.14 and 
earlier. When configured to use the ImageMagick library, the 
'quality', 'angle', and 'clipval' parameters are not 
properly escaped before being passed to the PHP 'exec' 
command. In order to reach the vulnerable 'exec' call, the 
input must pass several validation steps. The 
vulnerabilities actually reside in the following functions: 
image_processor.php: rotate_image(...) 
include/imageObjectIM.class.php: imageObject::cropImage(...) 
include/imageObjectIM.class.php: 
imageObject::rotateImage(...) 
include/imageObjectIM.class.php: 
imageObject::resizeImage(...) include/picmgmt.inc.php: 
resize_image(...) NOTE: Use of the ImageMagick library is a 
non-default option. However, a user can specify its use at 
installation time.


## Module Name
exploit/unix/webapp/coppermine_piceditor

## Authors
* Janek Vind
* jduck


## References
* http://cvedetails.com/cve/2008-0506/
* http://www.osvdb.org/41676
* https://www.exploit-db.com/exploits/5019
* http://forum.coppermine-gallery.net/index.php?topic=50103.0



## Targets
* Automatic


## Platforms
* unix

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/unix/webapp/coppermine_piceditor
msf exploit(coppermine_piceditor) > show targets
   ... a list of targets ...
msf exploit(coppermine_piceditor) > set TARGET <target-id>
msf exploit(coppermine_piceditor) > show options
   ... show and set options ...
msf exploit(coppermine_piceditor) > run
```
    
    