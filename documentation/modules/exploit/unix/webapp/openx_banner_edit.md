## OpenX banner-edit.php File Upload PHP Code Execution

This module exploits a vulnerability in the OpenX 
advertising software. In versions prior to version 2.8.2, 
authenticated users can upload files with arbitrary 
extensions to be used as banner creative content. By 
uploading a file with a PHP extension, an attacker can 
execute arbitrary PHP code. NOTE: The file must also return 
either "png", "gif", or "jpeg" as its image type as returned 
from the PHP getimagesize() function.


## Module Name
exploit/unix/webapp/openx_banner_edit

## Authors
* jduck


## References
* http://cvedetails.com/cve/2009-4098/
* http://www.osvdb.org/60499
* http://www.securityfocus.com/bid/37110
* http://archives.neohapsis.com/archives/bugtraq/2009-11/0166.html
* http://www.openx.org/docs/2.8/release-notes/openx-2.8.2
* http://php.net/manual/en/function.getimagesize.php
* http://gynvael.coldwind.pl/?id=223
* http://gynvael.coldwind.pl/?id=224
* http://gynvael.coldwind.pl/?id=235
* http://programming.arantius.com/the+smallest+possible+gif
* http://stackoverflow.com/questions/2253404/what-is-the-smallest-valid-jpeg-file-size-in-bytes



## Targets
* Automatic


## Platforms
php

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/unix/webapp/openx_banner_edit
msf exploit(openx_banner_edit) > show targets
   ... a list of targets ...
msf exploit(openx_banner_edit) > set TARGET <target-id>
msf exploit(openx_banner_edit) > show options
   ... show and set options ...
msf exploit(openx_banner_edit) > run
```
    
    