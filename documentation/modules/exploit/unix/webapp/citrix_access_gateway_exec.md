## Citrix Access Gateway Command Execution

The Citrix Access Gateway provides support for multiple 
authentication types. When utilizing the external legacy 
NTLM authentication module known as ntlm_authenticator the 
Access Gateway spawns the Samba 'samedit' command line 
utility to verify a user's identity and password. By 
embedding shell metacharacters in the web authentication 
form it is possible to execute arbitrary commands on the 
Access Gateway.


## Module Name
exploit/unix/webapp/citrix_access_gateway_exec

## Authors
* George D. Gal
* Erwin Paternotte


## References
* http://cvedetails.com/cve/2010-4566/
* http://www.osvdb.org/70099
* http://www.securityfocus.com/bid/45402
* http://www.vsecurity.com/resources/advisory/20101221-1/



## Targets
* Automatic


## Platforms
* unix

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/unix/webapp/citrix_access_gateway_exec
msf exploit(citrix_access_gateway_exec) > show targets
   ... a list of targets ...
msf exploit(citrix_access_gateway_exec) > set TARGET <target-id>
msf exploit(citrix_access_gateway_exec) > show options
   ... show and set options ...
msf exploit(citrix_access_gateway_exec) > run
```
    
    