## FreePBX 2.10.0 / 2.9.0 callmenum Remote Code Execution

This module exploits FreePBX version 2.10.0,2.9.0 and 
possibly older. Due to the way callme_page.php handles the 
'callmenum' parameter, it is possible to inject code to the 
'$channel' variable in function callme_startcall in order to 
gain remote code execution. Please note in order to use this 
module properly, you must know the extension number, which 
can be enumerated or bruteforced, or you may try some of the 
default extensions such as 0 or 200. Also, the call has to 
be answered (or go to voice). Tested on both Elastix and 
FreePBX ISO image installs.


## Module Name
exploit/unix/http/freepbx_callmenum

## Authors
* muts
* Martin Tschirsich


## References
* http://cvedetails.com/cve/2012-4869/
* http://www.osvdb.org/80544
* https://www.exploit-db.com/exploits/18649



## Targets
* Automatic Target


## Platforms
* unix

## Reliability
[Manual](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/unix/http/freepbx_callmenum
msf exploit(freepbx_callmenum) > show targets
   ... a list of targets ...
msf exploit(freepbx_callmenum) > set TARGET <target-id>
msf exploit(freepbx_callmenum) > show options
   ... show and set options ...
msf exploit(freepbx_callmenum) > run
```
    
    