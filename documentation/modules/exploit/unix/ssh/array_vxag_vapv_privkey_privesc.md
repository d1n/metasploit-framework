## Array Networks vAPV and vxAG Private Key Privilege Escalation Code Execution

This module exploits a default hardcoded private SSH key or 
default hardcoded login and password in the vAPV 8.3.2.17 
and vxAG 9.2.0.34 appliances made by Array Networks. After 
logged in as the unprivileged user, it's possible to modify 
the world-writable file /ca/bin/monitor.sh with 
attacker-supplied arbitrary code. Execution is possible by 
using the backend tool, running setuid, to turn the debug 
monitoring on. This makes it possible to trigger a payload 
with root privileges.


## Module Name
exploit/unix/ssh/array_vxag_vapv_privkey_privesc

## Authors
* xistence <xistence[at]0x90.nl>


## References
* http://www.osvdb.org/104652
* http://www.osvdb.org/104653
* http://www.osvdb.org/104654
* https://packetstormsecurity.com/files/125761



## Targets
* vAPV 8.3.2.17 / vxAG 9.2.0.34


## Platforms
unix

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/unix/ssh/array_vxag_vapv_privkey_privesc
msf exploit(array_vxag_vapv_privkey_privesc) > show targets
   ... a list of targets ...
msf exploit(array_vxag_vapv_privkey_privesc) > set TARGET <target-id>
msf exploit(array_vxag_vapv_privkey_privesc) > show options
   ... show and set options ...
msf exploit(array_vxag_vapv_privkey_privesc) > run
```
    
    