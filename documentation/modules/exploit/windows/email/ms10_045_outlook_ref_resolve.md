## Outlook ATTACH_BY_REF_RESOLVE File Execution

It has been discovered that certain e-mail message cause 
Outlook to create Windows shortcut-like attachments or 
messages within Outlook. Through specially crafted TNEF 
streams with certain MAPI attachment properties, it is 
possible to set a path name to files to be executed. When a 
user double clicks on such an attachment or message, Outlook 
will proceed to execute the file that is set by the path 
name value. These files can be local files, but also file 
stored remotely for example on a file share. Exploitation is 
limited by the fact that its is not possible for attackers 
to supply command line options.


## Module Name
exploit/windows/email/ms10_045_outlook_ref_resolve

## Authors
Yorick Koster <yorick[at]akitasecurity.nl>


## References
* http://technet.microsoft.com/en-us/security/bulletin/MS10-045
* http://cvedetails.com/cve/2010-0266/
* http://www.osvdb.org/66296
* http://www.securityfocus.com/bid/41446
* http://www.akitasecurity.nl/advisory.php?id=AK20091001



## Targets
* Automatic


## Platforms
win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/email/ms10_045_outlook_ref_resolve
msf exploit(ms10_045_outlook_ref_resolve) > show targets
   ... a list of targets ...
msf exploit(ms10_045_outlook_ref_resolve) > set TARGET <target-id>
msf exploit(ms10_045_outlook_ref_resolve) > show options
   ... show and set options ...
msf exploit(ms10_045_outlook_ref_resolve) > run
```
    
    