## Windows Media Services ConnectFunnel Stack Buffer Overflow

This module exploits a stack buffer overflow in the Windows 
Media Unicast Service version 4.1.0.3930 (NUMS.exe). By 
sending a specially crafted FunnelConnect request, an 
attacker can execute arbitrary code under the 
"NetShowServices" user account. Windows Media Services 4.1 
ships with Windows 2000 Server, but is not installed by 
default. NOTE: This service does NOT restart automatically. 
Successful, as well as unsuccessful exploitation attempts 
will kill the service which prevents additional attempts.


## Module Name
exploit/windows/mmsp/ms10_025_wmss_connect_funnel

## Authors
jduck


## References
* http://cvedetails.com/cve/2010-0478/
* http://www.osvdb.org/63726
* http://technet.microsoft.com/en-us/security/bulletin/MS10-025
* https://www.lexsi.com/abonnes/labs/adviso-cve-2010-0478.txt



## Targets
* Windows 2000 Pro SP4 English


## Platforms
win

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/mmsp/ms10_025_wmss_connect_funnel
msf exploit(ms10_025_wmss_connect_funnel) > show targets
   ... a list of targets ...
msf exploit(ms10_025_wmss_connect_funnel) > set TARGET <target-id>
msf exploit(ms10_025_wmss_connect_funnel) > show options
   ... show and set options ...
msf exploit(ms10_025_wmss_connect_funnel) > run
```
    
    