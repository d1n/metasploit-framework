## Windows TrackPopupMenu Win32k NULL Pointer Dereference

This module exploits a NULL Pointer Dereference in 
win32k.sys, the vulnerability can be triggered through the 
use of TrackPopupMenu. Under special conditions, the NULL 
pointer dereference can be abused on xxxSendMessageTimeout 
to achieve arbitrary code execution. This module has been 
tested successfully on Windows XP SP3, Windows 2003 SP2, 
Windows 7 SP1 and Windows 2008 32bits. Also on Windows 7 SP1 
and Windows 2008 R2 SP1 64 bits.


## Module Name
exploit/windows/local/ms14_058_track_popup_menu

## Authors
* Unknown
* juan vazquez
* Spencer McIntyre
* OJ Reeves <oj[at]buffered.io>


## References
* http://cvedetails.com/cve/2014-4113/
* http://www.osvdb.org/113167
* http://www.securityfocus.com/bid/70364
* http://technet.microsoft.com/en-us/security/bulletin/MS14-058
* http://blog.trendmicro.com/trendlabs-security-intelligence/an-analysis-of-a-windows-kernel-mode-vulnerability-cve-2014-4113/



## Targets
* Windows x86
* Windows x64


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/local/ms14_058_track_popup_menu
msf exploit(ms14_058_track_popup_menu) > show targets
   ... a list of targets ...
msf exploit(ms14_058_track_popup_menu) > set TARGET <target-id>
msf exploit(ms14_058_track_popup_menu) > show options
   ... show and set options ...
msf exploit(ms14_058_track_popup_menu) > run
```
    
    