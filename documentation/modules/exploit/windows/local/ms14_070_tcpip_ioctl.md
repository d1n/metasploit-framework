## MS14-070 Windows tcpip!SetAddrOptions NULL Pointer Dereference

A vulnerability within the Microsoft TCP/IP protocol driver 
tcpip.sys can allow a local attacker to trigger a NULL 
pointer dereference by using a specially crafted IOCTL. This 
flaw can be abused to elevate privileges to SYSTEM.


## Module Name
exploit/windows/local/ms14_070_tcpip_ioctl

## Authors
* Matt Bergin <level[at]korelogic.com>
* Jay Smith <jsmith[at]korelogic.com>


## References
* http://cvedetails.com/cve/2014-4076/
* http://technet.microsoft.com/en-us/security/bulletin/MS14-070
* http://www.osvdb.org/114532
* https://blog.korelogic.com/blog/2015/01/28/2k3_tcpip_setaddroptions_exploit_dev
* https://www.korelogic.com/Resources/Advisories/KL-001-2015-001.txt



## Targets
* Windows Server 2003 SP2


## Platforms
win

## Reliability
[Average](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/local/ms14_070_tcpip_ioctl
msf exploit(ms14_070_tcpip_ioctl) > show targets
   ... a list of targets ...
msf exploit(ms14_070_tcpip_ioctl) > set TARGET <target-id>
msf exploit(ms14_070_tcpip_ioctl) > show options
   ... show and set options ...
msf exploit(ms14_070_tcpip_ioctl) > run
```
    
    