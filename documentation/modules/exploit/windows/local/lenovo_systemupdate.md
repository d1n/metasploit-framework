## Lenovo System Update Privilege Escalation

The named pipe, \SUPipeServer, can be accessed by normal 
users to interact with the System update service. The 
service provides the possibility to execute arbitrary 
commands as SYSTEM if a valid security token is provided. 
This token can be generated by calling the GetSystemInfoData 
function in the DLL tvsutil.dll. Please, note that the 
System Update is stopped by default but can be 
started/stopped calling the Executable ConfigService.exe.


## Module Name
exploit/windows/local/lenovo_systemupdate

## Authors
* Michael Milvich
* Sofiane Talmat
* h0ng10


## References
* http://www.osvdb.org/121522
* http://cvedetails.com/cve/2015-2219/
* http://www.ioactive.com/pdfs/Lenovo_System_Update_Multiple_Privilege_Escalations.pdf



## Targets
* Windows


## Platforms
win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/local/lenovo_systemupdate
msf exploit(lenovo_systemupdate) > show targets
   ... a list of targets ...
msf exploit(lenovo_systemupdate) > set TARGET <target-id>
msf exploit(lenovo_systemupdate) > show options
   ... show and set options ...
msf exploit(lenovo_systemupdate) > run
```
    
    