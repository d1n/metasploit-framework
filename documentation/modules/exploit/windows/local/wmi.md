## Windows Management Instrumentation (WMI) Remote Command Execution

This module executes powershell on the remote host using the 
current user credentials or those supplied. Instead of using 
PSEXEC over TCP port 445 we use the WMIC command to start a 
Remote Procedure Call on TCP port 135 and an ephemeral port. 
Set ReverseListenerComm to tunnel traffic through that 
session. The result is similar to psexec but with the added 
benefit of using the session's current authentication token 
instead of having to know a password or hash. The remote 
host must be configured to allow remote Windows Management 
Instrumentation.


## Module Name
exploit/windows/local/wmi

## Authors
* Ben Campbell


## References
* http://cvedetails.com/cve/1999-0504/
* http://www.osvdb.org/3106
* http://passing-the-hash.blogspot.co.uk/2013/07/WMIS-PowerSploit-Shells.html



## Targets
* Automatic


## Platforms
* win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/local/wmi
msf exploit(wmi) > show targets
   ... a list of targets ...
msf exploit(wmi) > set TARGET <target-id>
msf exploit(wmi) > show options
   ... show and set options ...
msf exploit(wmi) > run
```
    
    