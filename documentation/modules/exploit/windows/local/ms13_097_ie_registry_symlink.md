## MS13-097 Registry Symlink IE Sandbox Escape

This module exploits a vulnerability in Internet Explorer 
Sandbox which allows to escape the Enhanced Protected Mode 
and execute code with Medium Integrity. The vulnerability 
exists in the IESetProtectedModeRegKeyOnly function from the 
ieframe.dll component, which can be abused to force medium 
integrity IE to user influenced keys. By using registry 
symlinks it's possible force IE to add a policy entry in the 
registry and finally bypass Enhanced Protected Mode.


## Module Name
exploit/windows/local/ms13_097_ie_registry_symlink

## Authors
* James Forshaw
* juan vazquez


## References
* http://cvedetails.com/cve/2013-5045/
* http://technet.microsoft.com/en-us/security/bulletin/MS13-097
* http://www.securityfocus.com/bid/64115
* https://github.com/tyranid/IE11SandboxEscapes



## Targets
* IE 8 - 11


## Platforms
* win

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/local/ms13_097_ie_registry_symlink
msf exploit(ms13_097_ie_registry_symlink) > show targets
   ... a list of targets ...
msf exploit(ms13_097_ie_registry_symlink) > set TARGET <target-id>
msf exploit(ms13_097_ie_registry_symlink) > show options
   ... show and set options ...
msf exploit(ms13_097_ie_registry_symlink) > run
```
    
    