## MS15-004 Microsoft Remote Desktop Services Web Proxy IE Sandbox Escape

This module abuses a process creation policy in Internet 
Explorer's sandbox; specifically, Microsoft's RemoteApp and 
Desktop Connections runtime proxy, TSWbPrxy.exe. This 
vulnerability allows the attacker to escape the Protected 
Mode and execute code with Medium Integrity. At the moment, 
this module only bypass Protected Mode on Windows 7 SP1 and 
prior (32 bits). This module has been tested successfully on 
Windows 7 SP1 (32 bits) with IE 8 and IE 11.


## Module Name
exploit/windows/local/ms15_004_tswbproxy

## Authors
* Unknown
* Henry Li
* juan vazquez


## References
* http://cvedetails.com/cve/2015-0016/
* http://technet.microsoft.com/en-us/security/bulletin/MS15-004
* http://blog.trendmicro.com/trendlabs-security-intelligence/cve-2015-0016-escaping-the-internet-explorer-sandbox/



## Targets
* Protected Mode (Windows 7) / 32 bits


## Platforms
win

## Reliability
[Good](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/local/ms15_004_tswbproxy
msf exploit(ms15_004_tswbproxy) > show targets
   ... a list of targets ...
msf exploit(ms15_004_tswbproxy) > set TARGET <target-id>
msf exploit(ms15_004_tswbproxy) > show options
   ... show and set options ...
msf exploit(ms15_004_tswbproxy) > run
```
    
    