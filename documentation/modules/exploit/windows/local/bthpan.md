## MS14-062 Microsoft Bluetooth Personal Area Networking (BthPan.sys) Privilege Escalation

A vulnerability within Microsoft Bluetooth Personal Area 
Networking module, BthPan.sys, can allow an attacker to 
inject memory controlled by the attacker into an arbitrary 
location. This can be used by an attacker to overwrite 
HalDispatchTable+0x4 and execute arbitrary code by 
subsequently calling NtQueryIntervalProfile.


## Module Name
exploit/windows/local/bthpan

## Authors
* Matt Bergin <level[at]korelogic.com>
* Jay Smith <jsmith[at]korelogic.com>


## References
* http://technet.microsoft.com/en-us/security/bulletin/MS14-062
* http://cvedetails.com/cve/2014-4971/
* https://www.korelogic.com/Resources/Advisories/KL-001-2014-002.txt
* http://www.osvdb.org/109387



## Targets
* Windows XP SP3


## Platforms
win

## Reliability
[Average](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/local/bthpan
msf exploit(bthpan) > show targets
   ... a list of targets ...
msf exploit(bthpan) > set TARGET <target-id>
msf exploit(bthpan) > show options
   ... show and set options ...
msf exploit(bthpan) > run
```
    
    