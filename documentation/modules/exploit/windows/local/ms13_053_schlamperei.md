## Windows NTUserMessageCall Win32k Kernel Pool Overflow (Schlamperei)

This module leverages a kernel pool overflow in Win32k which 
allows local privilege escalation. The kernel shellcode 
nulls the ACL for the winlogon.exe process (a SYSTEM 
process). This allows any unprivileged process to freely 
migrate to winlogon.exe, achieving privilege escalation. 
This exploit was used in pwn2own 2013 by MWR to break out of 
chrome's sandbox. NOTE: when a meterpreter session started 
by this exploit exits, winlogin.exe is likely to crash.


## Module Name
exploit/windows/local/ms13_053_schlamperei

## Authors
* Nils
* Jon
* Donato Capitella <donato.capitella[at]mwrinfosecurity.com>
* Ben Campbell <ben.campbell[at]mwrinfosecurity.com>


## References
* http://cvedetails.com/cve/2013-1300/
* http://technet.microsoft.com/en-us/security/bulletin/MS13-053
* https://labs.mwrinfosecurity.com/blog/2013/09/06/mwr-labs-pwn2own-2013-write-up---kernel-exploit/



## Targets
* Windows 7 SP0/SP1


## Platforms
win

## Reliability
[Average](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/local/ms13_053_schlamperei
msf exploit(ms13_053_schlamperei) > show targets
   ... a list of targets ...
msf exploit(ms13_053_schlamperei) > set TARGET <target-id>
msf exploit(ms13_053_schlamperei) > show options
   ... show and set options ...
msf exploit(ms13_053_schlamperei) > run
```
    
    