## Windows AlwaysInstallElevated MSI

This module checks the AlwaysInstallElevated registry keys 
which dictates if .MSI files should be installed with 
elevated privileges (NT AUTHORITY\SYSTEM). The generated 
.MSI file has an embedded executable which is extracted and 
run by the installer. After execution the .MSI file 
intentionally fails installation (by calling some invalid 
VBS) to prevent it being registered on the system. By 
running this with the /quiet argument the error will not be 
seen by the user.


## Module Name
exploit/windows/local/always_install_elevated

## Authors
* Ben Campbell
* Parvez Anwar


## References
* http://www.greyhathacker.net/?p=185
* http://msdn.microsoft.com/en-us/library/aa367561(VS.85).aspx
* http://rewtdance.blogspot.co.uk/2013/03/metasploit-msi-payload-generation.html



## Targets
* Windows


## Platforms
* win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/local/always_install_elevated
msf exploit(always_install_elevated) > show targets
   ... a list of targets ...
msf exploit(always_install_elevated) > set TARGET <target-id>
msf exploit(always_install_elevated) > show options
   ... show and set options ...
msf exploit(always_install_elevated) > run
```
    
    