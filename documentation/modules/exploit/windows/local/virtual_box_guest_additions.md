## VirtualBox Guest Additions VBoxGuest.sys Privilege Escalation

A vulnerability within the VBoxGuest driver allows an 
attacker to inject memory they control into an arbitrary 
location they define. This can be used by an attacker to 
overwrite HalDispatchTable+0x4 and execute arbitrary code by 
subsequently calling NtQueryIntervalProfile on Windows XP 
SP3 systems. This has been tested with VBoxGuest Additions 
up to 4.3.10r93012.


## Module Name
exploit/windows/local/virtual_box_guest_additions

## Authors
* Matt Bergin <level[at]korelogic.com>
* Jay Smith <jsmith[at]korelogic.com>


## References
* http://cvedetails.com/cve/2014-2477/
* https://www.korelogic.com/Resources/Advisories/KL-001-2014-001.txt



## Targets
* Windows XP SP3


## Platforms
win

## Reliability
[Average](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/local/virtual_box_guest_additions
msf exploit(virtual_box_guest_additions) > show targets
   ... a list of targets ...
msf exploit(virtual_box_guest_additions) > set TARGET <target-id>
msf exploit(virtual_box_guest_additions) > show options
   ... show and set options ...
msf exploit(virtual_box_guest_additions) > run
```
    
    