## Iconics GENESIS32 Integer Overflow Version 9.21.201.01

The GenBroker service on port 38080 is affected by three 
integer overflow vulnerabilities while handling opcode 
0x4b0, which is caused by abusing the the memory allocations 
needed for the number of elements passed by the client. This 
results unexpected behaviors such as direct registry calls, 
memory location calls, or arbitrary remote code execution. 
Please note that in order to ensure reliability, this 
exploit will try to open calc (hidden), inject itself into 
the process, and then open up a shell session. Also, DEP 
bypass is supported.


## Module Name
exploit/windows/scada/iconics_genbroker

## Authors
* Luigi Auriemma
* Lincoln
* corelanc0d3r <peter.ve[at]corelan.be>


## References
* http://www.osvdb.org/72817
* http://aluigi.org/adv/genesis_4-adv.txt
* http://www.us-cert.gov/control_systems/pdf/ICS-ALERT-11-080-02.pdf



## Targets
* Windows XP


## Platforms
win

## Reliability
[Good](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/scada/iconics_genbroker
msf exploit(iconics_genbroker) > show targets
   ... a list of targets ...
msf exploit(iconics_genbroker) > set TARGET <target-id>
msf exploit(iconics_genbroker) > show options
   ... show and set options ...
msf exploit(iconics_genbroker) > run
```
    
    