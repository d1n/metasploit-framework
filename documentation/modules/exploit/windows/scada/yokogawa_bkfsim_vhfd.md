## Yokogawa CS3000 BKFSim_vhfd.exe Buffer Overflow

This module exploits an stack based buffer overflow on 
Yokogawa CS3000. The vulnerability exists in the service 
BKFSim_vhfd.exe when using malicious user-controlled data to 
create logs using functions like vsprintf and memcpy in a 
insecure way. This module has been tested successfully on 
Yokogawa Centum CS3000 R3.08.50 over Windows XP SP3.


## Module Name
exploit/windows/scada/yokogawa_bkfsim_vhfd

## Authors
* Redsadic <julian.vilas[at]gmail.com>
* juan vazquez


## References
* http://cvedetails.com/cve/2014-3888/
* http://jvn.jp/vu/JVNVU95045914/index.html
* http://www.yokogawa.com/dcs/security/ysar/YSAR-14-0002E.pdf
* https://community.rapid7.com/community/metasploit/blog/2014/07/07/r7-2014-06-disclosure-yokogawa-centum-cs-3000-bkfsimvhfdexe-buffer-overflow



## Targets
* Yokogawa Centum CS3000 R3.08.50 / Windows XP SP3


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/scada/yokogawa_bkfsim_vhfd
msf exploit(yokogawa_bkfsim_vhfd) > show targets
   ... a list of targets ...
msf exploit(yokogawa_bkfsim_vhfd) > set TARGET <target-id>
msf exploit(yokogawa_bkfsim_vhfd) > show options
   ... show and set options ...
msf exploit(yokogawa_bkfsim_vhfd) > run
```
    
    