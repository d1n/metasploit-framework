## MS04-011 Microsoft Private Communications Transport Overflow

This module exploits a buffer overflow in the Microsoft 
Windows SSL PCT protocol stack. This code is based on Johnny 
Cyberpunk's THC release and has been tested against Windows 
2000 and Windows XP. To use this module, specify the remote 
port of any SSL service, or the port and protocol of an 
application that uses SSL. The only application protocol 
supported at this time is SMTP. You only have one chance to 
select the correct target, if you are attacking IIS, you may 
want to try one of the other exploits first (WebDAV). If 
WebDAV does not work, this more than likely means that this 
is either Windows 2000 SP4+ or Windows XP (IIS 5.0 vs IIS 
5.1). Using the wrong target may not result in an immediate 
crash of the remote system.


## Module Name
exploit/windows/ssl/ms04_011_pct

## Authors
* hdm


## References
* http://cvedetails.com/cve/2003-0719/
* http://www.osvdb.org/5250
* http://www.securityfocus.com/bid/10116
* http://technet.microsoft.com/en-us/security/bulletin/MS04-011



## Targets
* Windows 2000 SP4
* Windows 2000 SP3
* Windows 2000 SP2
* Windows 2000 SP1
* Windows 2000 SP0
* Windows XP SP0
* Windows XP SP1


## Platforms
win

## Reliability
[Average](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/ssl/ms04_011_pct
msf exploit(ms04_011_pct) > show targets
   ... a list of targets ...
msf exploit(ms04_011_pct) > set TARGET <target-id>
msf exploit(ms04_011_pct) > show options
   ... show and set options ...
msf exploit(ms04_011_pct) > run
```
    
    