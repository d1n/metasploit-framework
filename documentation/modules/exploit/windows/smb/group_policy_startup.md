## Group Policy Script Execution From Shared Resource

This is a general-purpose module for exploiting systems with 
Windows Group Policy configured to load VBS startup/logon 
scripts from remote locations. This module runs a SMB shared 
resource that will provide a payload through a VBS file. 
Startup scripts will be executed with SYSTEM privileges, 
while logon scripts will be executed with the user 
privileges. Have into account which the attacker still needs 
to redirect the target traffic to the fake SMB share to 
exploit it successfully. Please note in some cases, it will 
take 5 to 10 minutes to receive a session.


## Module Name
exploit/windows/smb/group_policy_startup

## Authors
* Sam Bertram <sbertram[at]gdssecurity.com>
* juan vazquez


## References
* http://blog.gdssecurity.com/labs/2015/1/26/badsamba-exploiting-windows-startup-scripts-using-a-maliciou.html
* https://github.com/GDSSecurity/BadSamba



## Targets
* Windows x86
* Windows x64


## Platforms
win

## Reliability
[Manual](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/smb/group_policy_startup
msf exploit(group_policy_startup) > show targets
   ... a list of targets ...
msf exploit(group_policy_startup) > set TARGET <target-id>
msf exploit(group_policy_startup) > show options
   ... show and set options ...
msf exploit(group_policy_startup) > run
```
    
    