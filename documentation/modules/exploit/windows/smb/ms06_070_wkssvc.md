## MS06-070 Microsoft Workstation Service NetpManageIPCConnect Overflow

This module exploits a stack buffer overflow in the NetApi32 
NetpManageIPCConnect function using the Workstation service 
in Windows 2000 SP4 and Windows XP SP2. In order to exploit 
this vulnerability, you must specify a the name of a valid 
Windows DOMAIN. It may be possible to satisfy this condition 
by using a custom dns and ldap setup, however that method is 
not covered here. Although Windows XP SP2 is vulnerable, 
Microsoft reports that Administrator credentials are 
required to reach the vulnerable code. Windows XP SP1 only 
requires valid user credentials. Also, testing shows that a 
machine already joined to a domain is not exploitable.


## Module Name
exploit/windows/smb/ms06_070_wkssvc

## Authors
* jduck


## References
* http://cvedetails.com/cve/2006-4691/
* http://www.osvdb.org/30263
* http://www.securityfocus.com/bid/20985
* http://technet.microsoft.com/en-us/security/bulletin/MS06-070



## Targets
* Automatic Targetting
* Windows 2000 SP4
* Windows XP SP0/SP1


## Platforms
win

## Reliability
[Manual](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/smb/ms06_070_wkssvc
msf exploit(ms06_070_wkssvc) > show targets
   ... a list of targets ...
msf exploit(ms06_070_wkssvc) > set TARGET <target-id>
msf exploit(ms06_070_wkssvc) > show options
   ... show and set options ...
msf exploit(ms06_070_wkssvc) > run
```
    
    