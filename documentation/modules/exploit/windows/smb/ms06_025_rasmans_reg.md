## MS06-025 Microsoft RRAS Service RASMAN Registry Overflow

This module exploits a registry-based stack buffer overflow 
in the Windows Routing and Remote Access Service. Since the 
service is hosted inside svchost.exe, a failed exploit 
attempt can cause other system services to fail as well. A 
valid username and password is required to exploit this flaw 
on Windows 2000. When attacking XP SP1, the SMBPIPE option 
needs to be set to 'SRVSVC'. Exploiting this flaw involves 
two distinct steps - creating the registry key and then 
triggering an overwrite based on a read of this key. Once 
the key is created, it cannot be recreated. This means that 
for any given system, you only get one chance to exploit 
this flaw. Picking the wrong target will require a manual 
removal of the following registry key before you can try 
again: HKEY_USERS\.DEFAULT\Software\Microsoft\RAS Phonebook


## Module Name
exploit/windows/smb/ms06_025_rasmans_reg

## Authors
* pusscat
* hdm


## References
* http://cvedetails.com/cve/2006-2370/
* http://www.osvdb.org/26437
* http://www.securityfocus.com/bid/18325
* http://technet.microsoft.com/en-us/security/bulletin/MS06-025



## Targets
* Windows 2000 SP4


## Platforms
win

## Reliability
[Good](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/smb/ms06_025_rasmans_reg
msf exploit(ms06_025_rasmans_reg) > show targets
   ... a list of targets ...
msf exploit(ms06_025_rasmans_reg) > set TARGET <target-id>
msf exploit(ms06_025_rasmans_reg) > show options
   ... show and set options ...
msf exploit(ms06_025_rasmans_reg) > run
```
    
    