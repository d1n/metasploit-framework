## MS06-040 Microsoft Server Service NetpwPathCanonicalize Overflow

This module exploits a stack buffer overflow in the NetApi32 
CanonicalizePathName() function using the 
NetpwPathCanonicalize RPC call in the Server Service. It is 
likely that other RPC calls could be used to exploit this 
service. This exploit will result in a denial of service on 
Windows XP SP2 or Windows 2003 SP1. A failed exploit attempt 
will likely result in a complete reboot on Windows 2000 and 
the termination of all SMB-related services on Windows XP. 
The default target for this exploit should succeed on 
Windows NT 4.0, Windows 2000 SP0-SP4+, Windows XP SP0-SP1 
and Windows 2003 SP0.


## Module Name
exploit/windows/smb/ms06_040_netapi

## Authors
* hdm


## References
* http://cvedetails.com/cve/2006-3439/
* http://www.osvdb.org/27845
* http://www.securityfocus.com/bid/19409
* http://technet.microsoft.com/en-us/security/bulletin/MS06-040



## Targets
* (wcscpy) Automatic (NT 4.0, 2000 SP0-SP4, XP SP0-SP1)
* (wcscpy) Windows NT 4.0 / Windows 2000 SP0-SP4
* (wcscpy) Windows XP SP0/SP1
* (stack)  Windows XP SP1 English
* (stack)  Windows XP SP1 Italian
* (wcscpy) Windows 2003 SP0


## Platforms
win

## Reliability
[Good](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/smb/ms06_040_netapi
msf exploit(ms06_040_netapi) > show targets
   ... a list of targets ...
msf exploit(ms06_040_netapi) > set TARGET <target-id>
msf exploit(ms06_040_netapi) > show options
   ... show and set options ...
msf exploit(ms06_040_netapi) > run
```
    
    