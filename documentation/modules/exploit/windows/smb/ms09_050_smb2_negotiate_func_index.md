## MS09-050 Microsoft SRV2.SYS SMB Negotiate ProcessID Function Table Dereference

This module exploits an out of bounds function table 
dereference in the SMB request validation code of the 
SRV2.SYS driver included with Windows Vista, Windows 7 
release candidates (not RTM), and Windows 2008 Server prior 
to R2. Windows Vista without SP1 does not seem affected by 
this flaw.


## Module Name
exploit/windows/smb/ms09_050_smb2_negotiate_func_index

## Authors
* Laurent Gaffie <laurent.gaffie[at]gmail.com>
* hdm
* sf


## References
* http://technet.microsoft.com/en-us/security/bulletin/MS09-050
* http://cvedetails.com/cve/2009-3103/
* http://www.securityfocus.com/bid/36299
* http://www.osvdb.org/57799
* http://seclists.org/fulldisclosure/2009/Sep/0039.html
* http://www.microsoft.com/technet/security/Bulletin/MS09-050.mspx



## Targets
* Windows Vista SP1/SP2 and Server 2008 (x86)


## Platforms
win

## Reliability
[Good](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/smb/ms09_050_smb2_negotiate_func_index
msf exploit(ms09_050_smb2_negotiate_func_index) > show targets
   ... a list of targets ...
msf exploit(ms09_050_smb2_negotiate_func_index) > set TARGET <target-id>
msf exploit(ms09_050_smb2_negotiate_func_index) > show options
   ... show and set options ...
msf exploit(ms09_050_smb2_negotiate_func_index) > run
```
    
    