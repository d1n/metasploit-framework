## MS07-029 Microsoft DNS RPC Service extractQuotedChar() Overflow (SMB)

This module exploits a stack buffer overflow in the RPC 
interface of the Microsoft DNS service. The vulnerability is 
triggered when a long zone name parameter is supplied that 
contains escaped octal strings. This module is capable of 
bypassing NX/DEP protection on Windows 2003 SP1/SP2. This 
module exploits the RPC service using the \DNSSERVER pipe 
available via SMB. This pipe requires a valid user account 
to access, so the SMBUSER and SMBPASS options must be 
specified.


## Module Name
exploit/windows/smb/ms07_029_msdns_zonename

## Authors
* hdm
* Unknown


## References
* http://cvedetails.com/cve/2007-1748/
* http://www.osvdb.org/34100
* http://technet.microsoft.com/en-us/security/bulletin/MS07-029
* http://www.microsoft.com/technet/security/advisory/935964.mspx



## Targets
* Automatic (2000 SP0-SP4, 2003 SP0, 2003 SP1-SP2)
* Windows 2000 Server SP0-SP4+ English
* Windows 2000 Server SP0-SP4+ Italian
* Windows 2000 Server SP0-SP4+ French
* Windows 2003 Server SP0 English
* Windows 2003 Server SP0 French
* Windows 2003 Server SP1-SP2 English
* Windows 2003 Server SP1-SP2 French
* Windows 2003 Server SP1-SP2 Spanish
* Windows 2003 Server SP1-SP2 Italian
* Windows 2003 Server SP1-SP2 German


## Platforms
win

## Reliability
[Manual](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/smb/ms07_029_msdns_zonename
msf exploit(ms07_029_msdns_zonename) > show targets
   ... a list of targets ...
msf exploit(ms07_029_msdns_zonename) > set TARGET <target-id>
msf exploit(ms07_029_msdns_zonename) > show options
   ... show and set options ...
msf exploit(ms07_029_msdns_zonename) > run
```
    
    