## MS10-061 Microsoft Print Spooler Service Impersonation Vulnerability

This module exploits the RPC service impersonation 
vulnerability detailed in Microsoft Bulletin MS10-061. By 
making a specific DCE RPC request to the StartDocPrinter 
procedure, an attacker can impersonate the Printer Spooler 
service to create a file. The working directory at the time 
is %SystemRoot%\system32. An attacker can specify any file 
name, including directory traversal or full paths. By 
sending WritePrinter requests, an attacker can fully control 
the content of the created file. In order to gain code 
execution, this module writes to a directory used by Windows 
Management Instrumentation (WMI) to deploy applications. 
This directory (Wbem\Mof) is periodically scanned and any 
new .mof files are processed automatically. This is the same 
technique employed by the Stuxnet code found in the wild.


## Module Name
exploit/windows/smb/ms10_061_spoolss

## Authors
* jduck
* hdm


## References
* http://www.osvdb.org/67988
* http://cvedetails.com/cve/2010-2729/
* http://technet.microsoft.com/en-us/security/bulletin/MS10-061



## Targets
* Windows Universal


## Platforms
win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/smb/ms10_061_spoolss
msf exploit(ms10_061_spoolss) > show targets
   ... a list of targets ...
msf exploit(ms10_061_spoolss) > set TARGET <target-id>
msf exploit(ms10_061_spoolss) > show options
   ... show and set options ...
msf exploit(ms10_061_spoolss) > run
```
    
    