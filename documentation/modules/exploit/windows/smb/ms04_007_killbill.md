## MS04-007 Microsoft ASN.1 Library Bitstring Heap Overflow

This is an exploit for a previously undisclosed 
vulnerability in the bit string decoding code in the 
Microsoft ASN.1 library. This vulnerability is not related 
to the bit string vulnerability described in eEye advisory 
AD20040210-2. Both vulnerabilities were fixed in the 
MS04-007 patch. You are only allowed one attempt with this 
vulnerability. If the payload fails to execute, the LSASS 
system service will crash and the target system will 
automatically reboot itself in 60 seconds. If the payload 
succeeeds, the system will no longer be able to process 
authentication requests, denying all attempts to login 
through SMB or at the console. A reboot is required to 
restore proper functioning of an exploited system. This 
exploit has been successfully tested with the 
win32/*/reverse_tcp payloads, however a few problems were 
encounted when using the equivalent bind payloads. Your 
mileage may vary.


## Module Name
exploit/windows/smb/ms04_007_killbill

## Authors
* Solar Eclipse <solareclipse[at]phreedom.org>


## References
* http://cvedetails.com/cve/2003-0818/
* http://www.osvdb.org/3902
* http://www.securityfocus.com/bid/9633
* http://technet.microsoft.com/en-us/security/bulletin/MS04-007



## Targets
* Windows 2000 SP2-SP4 + Windows XP SP0-SP1


## Platforms
win

## Reliability
[Low](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/smb/ms04_007_killbill
msf exploit(ms04_007_killbill) > show targets
   ... a list of targets ...
msf exploit(ms04_007_killbill) > set TARGET <target-id>
msf exploit(ms04_007_killbill) > show options
   ... show and set options ...
msf exploit(ms04_007_killbill) > run
```
    
    