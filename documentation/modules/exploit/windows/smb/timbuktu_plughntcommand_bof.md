## Timbuktu PlughNTCommand Named Pipe Buffer Overflow

This module exploits a stack based buffer overflow in 
Timbuktu Pro version <= 8.6.6 in a pretty novel way. This 
exploit requires two connections. The first connection is 
used to leak stack data using the buffer overflow to 
overwrite the nNumberOfBytesToWrite argument. By supplying a 
large value for this argument it is possible to cause 
Timbuktu to reply to the initial request with leaked stack 
data. Using this data allows for reliable exploitation of 
the buffer overflow vulnerability. Props to Infamous41d for 
helping in finding this exploitation path. The second 
connection utilizes the data from the data leak to 
accurately exploit the stack based buffer overflow 
vulnerability. TODO: hdm suggested using meterpreter's 
migration capability and restarting the process for 
multishot exploitation.


## Module Name
exploit/windows/smb/timbuktu_plughntcommand_bof

## Authors
* bannedit


## References
* http://cvedetails.com/cve/2009-1394/
* http://www.osvdb.org/55436
* http://www.securityfocus.com/bid/35496
* http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=809



## Targets
* Automatic Targeting


## Platforms
win

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/smb/timbuktu_plughntcommand_bof
msf exploit(timbuktu_plughntcommand_bof) > show targets
   ... a list of targets ...
msf exploit(timbuktu_plughntcommand_bof) > set TARGET <target-id>
msf exploit(timbuktu_plughntcommand_bof) > show options
   ... show and set options ...
msf exploit(timbuktu_plughntcommand_bof) > run
```
    
    