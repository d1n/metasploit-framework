## PostgreSQL for Microsoft Windows Payload Execution

On default Microsoft Windows installations of PostgreSQL the 
postgres service account may write to the current directory 
(which is usually "C:\Program 
Files\PostgreSQL\<version>\data" where <version> is the 
major.minor version of PostgreSQL). UDF DLL's may be sourced 
from there as well. This module uploads a Windows DLL file 
via the pg_largeobject method of binary injection and 
creates a UDF (user defined function) from that DLL. Because 
the payload is run from DllMain, it does not need to conform 
to specific Postgres API versions.


## Module Name
exploit/windows/postgres/postgres_payload

## Authors
* Bernardo Damele A. G. <bernardo.damele[at]gmail.com>
* todb


## References
* http://lab.lonerunners.net/blog/sqli-writing-files-to-disk-under-postgresql



## Targets
* Windows x86
* Windows x86_64


## Platforms
win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/postgres/postgres_payload
msf exploit(postgres_payload) > show targets
   ... a list of targets ...
msf exploit(postgres_payload) > set TARGET <target-id>
msf exploit(postgres_payload) > show options
   ... show and set options ...
msf exploit(postgres_payload) > run
```
    
    