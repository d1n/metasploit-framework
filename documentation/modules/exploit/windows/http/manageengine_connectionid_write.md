## ManageEngine Desktop Central 9 FileUploadServlet ConnectionId Vulnerability

This module exploits a vulnerability found in ManageEngine 
Desktop Central 9. When uploading a 7z file, the 
FileUploadServlet class does not check the user-controlled 
ConnectionId parameter in the FileUploadServlet class. This 
allows a remote attacker to inject a null bye at the end of 
the value to create a malicious file with an arbitrary file 
type, and then place it under a directory that allows 
server-side scripts to run, which results in remote code 
execution under the context of SYSTEM. Please note that by 
default, some ManageEngine Desktop Central versions run on 
port 8020, but older ones run on port 8040. Also, using this 
exploit will leave debugging information produced by 
FileUploadServlet in file rdslog0.txt. This exploit was 
successfully tested on version 9, build 90109 and build 
91084.


## Module Name
exploit/windows/http/manageengine_connectionid_write

## Authors
* sinn3r


## References
* https://community.rapid7.com/community/infosec/blog/2015/12/14/r7-2015-22-manageengine-desktop-central-9-fileuploadservlet-connectionid-vulnerability-cve-2015-8249
* http://cvedetails.com/cve/2015-8249/



## Targets
* ManageEngine Desktop Central 9 on Windows


## Platforms
win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/http/manageengine_connectionid_write
msf exploit(manageengine_connectionid_write) > show targets
   ... a list of targets ...
msf exploit(manageengine_connectionid_write) > set TARGET <target-id>
msf exploit(manageengine_connectionid_write) > show options
   ... show and set options ...
msf exploit(manageengine_connectionid_write) > run
```
    
    