## SAP NetWeaver HostControl Command Injection

This module exploits a command injection vulnerability in 
the SAPHostControl Service, by sending a specially crafted 
SOAP request to the management console. In order to deal 
with the spaces and length limitations, a WebDAV service is 
created to run an arbitrary payload when accessed as a UNC 
path. Because of this, the target host must have the 
WebClient service (WebDAV Mini-Redirector) enabled. It is 
enabled and automatically started by default on Windows XP 
SP3, but disabled by default on Windows 2003 SP2.


## Module Name
exploit/windows/http/sap_host_control_cmd_exec

## Authors
* Michael Jordon
* juan vazquez


## References
* http://www.osvdb.org/84821
* http://www.contextis.com/research/blog/sap4/
* https://websmp130.sap-ag.de/sap/support/notes/1341333



## Targets
* SAP NetWeaver 7.02 SP6 / Windows with WebClient enabled


## Platforms
win

## Reliability
[Average](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/http/sap_host_control_cmd_exec
msf exploit(sap_host_control_cmd_exec) > show targets
   ... a list of targets ...
msf exploit(sap_host_control_cmd_exec) > set TARGET <target-id>
msf exploit(sap_host_control_cmd_exec) > show options
   ... show and set options ...
msf exploit(sap_host_control_cmd_exec) > run
```
    
    