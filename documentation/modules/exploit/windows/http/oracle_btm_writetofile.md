## Oracle Business Transaction Management FlashTunnelService Remote Code Execution

This module exploits abuses the FlashTunnelService SOAP web 
service on Oracle Business Transaction Management 12.1.0.7 
to upload arbitrary files, without authentication, using the 
WriteToFile method. The same method contains a directory 
traversal vulnerability, which allows to upload the files to 
arbitrary locations. In order to execute remote code two 
techniques are provided. If the Oracle app has been deployed 
in the same WebLogic Samples Domain a JSP can be uploaded to 
the web root. If a new Domain has been used to deploy the 
Oracle application, the Windows Management Instrumentation 
service can be used to execute arbitrary code. Both 
techniques has been successfully tested on default installs 
of Oracle BTM 12.1.0.7, Weblogic 12.1.1 and Windows 2003 
SP2. Default path traversal depths are provided, but the 
user can configure the traversal depth using the DEPTH 
option.


## Module Name
exploit/windows/http/oracle_btm_writetofile

## Authors
* rgod <rgod[at]autistici.org>
* sinn3r
* juan vazquez


## References
* http://www.osvdb.org/85087
* http://www.securityfocus.com/bid/54839
* https://www.exploit-db.com/exploits/20318



## Targets
* Oracle BTM 12.1.0.7 / Weblogic 12.1.1 with Samples Domain / Java
* Oracle BTM 12.1.0.7 / Windows 2003 SP2 through WMI


## Platforms
* java
* win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/http/oracle_btm_writetofile
msf exploit(oracle_btm_writetofile) > show targets
   ... a list of targets ...
msf exploit(oracle_btm_writetofile) > set TARGET <target-id>
msf exploit(oracle_btm_writetofile) > show options
   ... show and set options ...
msf exploit(oracle_btm_writetofile) > run
```
    
    