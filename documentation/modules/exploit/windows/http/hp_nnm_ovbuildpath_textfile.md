## HP OpenView Network Node Manager ov.dll _OVBuildPath Buffer Overflow

This module exploits a stack buffer overflow in HP OpenView 
Network Node Manager 7.53 prior to NNM_01213 without the 
SSRT100649 hotfix. By specifying a long 'textFile' argument 
when calling the 'webappmon.exe' CGI program, an attacker 
can cause a stack-based buffer overflow and execute 
arbitrary code. The vulnerable code is within the 
"_OVBuildPath" function within "ov.dll". There are no stack 
cookies, so exploitation is achieved by overwriting the 
saved return address. The vulnerability is due to the use of 
the function "_OVConcatPath" which finally uses "strcat" in 
a insecure way. User controlled data is concatenated to a 
string which contains the OpenView installation path. To 
achieve reliable exploitation a directory traversal in 
OpenView5.exe (OSVDB 44359) is being used to retrieve 
OpenView logs and disclose the installation path. If the 
installation path cannot be guessed the default installation 
path is used.


## Module Name
exploit/windows/http/hp_nnm_ovbuildpath_textfile

## Authors
* Anyway <Aniway.Anyway[at]gmail.com>
* juan vazquez
* sinn3r


## References
* http://cvedetails.com/cve/2011-3167/
* http://www.osvdb.org/76775
* http://www.securityfocus.com/bid/50471
* http://www.zerodayinitiative.com/advisories/ZDI-12-002
* https://h20566.www2.hp.com/portal/site/hpsc/public/kb/docDisplay/?docId=emr_na-c03054052



## Targets
* HP OpenView Network Node Manager 7.53 / Windows 2000 SP4 & Windows XP SP3


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/http/hp_nnm_ovbuildpath_textfile
msf exploit(hp_nnm_ovbuildpath_textfile) > show targets
   ... a list of targets ...
msf exploit(hp_nnm_ovbuildpath_textfile) > set TARGET <target-id>
msf exploit(hp_nnm_ovbuildpath_textfile) > show options
   ... show and set options ...
msf exploit(hp_nnm_ovbuildpath_textfile) > run
```
    
    