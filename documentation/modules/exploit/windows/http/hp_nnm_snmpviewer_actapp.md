## HP OpenView Network Node Manager snmpviewer.exe Buffer Overflow

This module exploits a stack buffer overflow in HP OpenView 
Network Node Manager 7.53 prior to NNM_01203. By making a 
specially crafted HTTP request to the "snmpviewer.exe" CGI 
program, an attacker can cause a stack-based buffer overflow 
and execute arbitrary code. The vulnerable code lies within 
the a function within "snmpviewer.exe" with a timestamp 
prior to April 7th, 2010. This vulnerability is triggerable 
via either a GET or POST request. The request must contain 
'act' and 'app' parameters which, when combined, total more 
than the 1024 byte stack buffer can hold. It is important to 
note that this vulnerability must be exploited by 
overwriting SEH. While the saved return address can be 
smashed, a function call that occurs before the function 
returns calls "exit".


## Module Name
exploit/windows/http/hp_nnm_snmpviewer_actapp

## Authors
* jduck


## References
* http://cvedetails.com/cve/2010-1552/
* http://www.osvdb.org/64975
* http://www.securityfocus.com/bid/40068
* http://www.zerodayinitiative.com/advisories/ZDI-10-083
* http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c02153379



## Targets
* HP OpenView Network Node Manager 7.53 w/NNM_01201
* HP OpenView Network Node Manager 7.53 (Windows 2003)
* Debug Target


## Platforms
win

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/http/hp_nnm_snmpviewer_actapp
msf exploit(hp_nnm_snmpviewer_actapp) > show targets
   ... a list of targets ...
msf exploit(hp_nnm_snmpviewer_actapp) > set TARGET <target-id>
msf exploit(hp_nnm_snmpviewer_actapp) > show options
   ... show and set options ...
msf exploit(hp_nnm_snmpviewer_actapp) > run
```
    
    