## PHP apache_request_headers Function Buffer Overflow

This module exploits a stack based buffer overflow in the 
CGI version of PHP 5.4.x before 5.4.3. The vulnerability is 
due to the insecure handling of the HTTP headers. This 
module has been tested against the thread safe version of 
PHP 5.4.2, from "windows.php.net", running with Apache 
2.2.22 from "apachelounge.com".


## Module Name
exploit/windows/http/php_apache_request_headers_bof

## Authors
* Vincent Danen
* juan vazquez


## References
* http://cvedetails.com/cve/2012-2329/
* http://www.osvdb.org/82215
* http://www.securityfocus.com/bid/53455
* http://www.php.net/archive/2012.php#id2012-05-08-1
* http://www.php.net/ChangeLog-5.php#5.4.3
* https://bugzilla.redhat.com/show_bug.cgi?id=820000



## Targets
* Windows XP SP3 / Windows 2003 Server SP2 (No DEP) / PHP 5.4.2 Thread safe


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/http/php_apache_request_headers_bof
msf exploit(php_apache_request_headers_bof) > show targets
   ... a list of targets ...
msf exploit(php_apache_request_headers_bof) > set TARGET <target-id>
msf exploit(php_apache_request_headers_bof) > show options
   ... show and set options ...
msf exploit(php_apache_request_headers_bof) > run
```
    
    