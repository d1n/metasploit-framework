## HP Managed Printing Administration jobAcct Remote Command Execution

This module exploits an arbitrary file upload vulnerability 
on HP Managed Printing Administration 2.6.3 and prior 
versions. The vulnerability exists in the UploadFiles() 
function from the MPAUploader.Uploader.1 control, loaded and 
used by the server. The function can be abused via directory 
traversal and null byte injection in order to achieve 
arbitrary file upload. In order to exploit successfully, a 
few conditions must be met. First, a writable location under 
the context of Internet Guest Account (IUSR_*) or Everyone 
is required. By default, this module will attempt to write 
to /hpmpa/userfiles/, but the WRITEWEBFOLDER option can be 
used to provide another writable path. Second, the writable 
path must also be readable by a browser, so this typically 
means a location under wwwroot. Finally, you cannot 
overwrite a file with the same name as the payload.


## Module Name
exploit/windows/http/hp_mpa_job_acct

## Authors
* Andrea Micalizzi
* juan vazquez


## References
* http://cvedetails.com/cve/2011-4166/
* http://www.osvdb.org/78015
* http://www.securityfocus.com/bid/51174
* http://www.zerodayinitiative.com/advisories/ZDI-11-352
* https://h20566.www2.hp.com/portal/site/hpsc/public/kb/docDisplay/?docId=emr_na-c03128469



## Targets
* HP Managed Printing Administration 2.6.3 / Microsoft Windows [XP SP3 | Server 2003 SP2]


## Platforms
win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/http/hp_mpa_job_acct
msf exploit(hp_mpa_job_acct) > show targets
   ... a list of targets ...
msf exploit(hp_mpa_job_acct) > set TARGET <target-id>
msf exploit(hp_mpa_job_acct) > show options
   ... show and set options ...
msf exploit(hp_mpa_job_acct) > run
```
    
    