## HP AutoPass License Server File Upload

This module exploits a code execution flaw in HP AutoPass 
License Server. It abuses two weaknesses in order to get its 
objective. First, the AutoPass application doesn't enforce 
authentication in the CommunicationServlet component. Seond, 
it's possible to abuse a directory traversal when uploading 
files thorough the same component, allowing to upload an 
arbitrary payload embedded in a JSP. The module has been 
tested successfully on HP AutoPass License Server 8.01 as 
installed with HP Service Virtualization 3.50.


## Module Name
exploit/windows/http/hp_autopass_license_traversal

## Authors
* rgod <rgod[at]autistici.org>
* juan vazquez


## References
* http://cvedetails.com/cve/2013-6221/
* http://www.zerodayinitiative.com/advisories/ZDI-14-195
* http://www.securityfocus.com/bid/67989
* https://h20566.www2.hp.com/portal/site/hpsc/public/kb/docDisplay/?docId=emr_na-c04333125



## Targets
* Windows 2003 SP2 / HP AutoPass License Server 8.01 / HP Service Virtualization 3.50
* Windows 2008 32 bits/ HP AutoPass License Server 8.01 / HP Service Virtualization 3.50
* Windows 2008 64 bits/ HP AutoPass License Server 8.01 / HP Service Virtualization 3.50
* Windows 2012 / HP AutoPass License Server 8.01 / HP Service Virtualization 3.50


## Platforms
* java

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/http/hp_autopass_license_traversal
msf exploit(hp_autopass_license_traversal) > show targets
   ... a list of targets ...
msf exploit(hp_autopass_license_traversal) > set TARGET <target-id>
msf exploit(hp_autopass_license_traversal) > show options
   ... show and set options ...
msf exploit(hp_autopass_license_traversal) > run
```
    
    