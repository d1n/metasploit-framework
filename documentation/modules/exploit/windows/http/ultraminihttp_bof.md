## Ultra Mini HTTPD Stack Buffer Overflow

This module exploits a stack based buffer overflow in Ultra 
Mini HTTPD 1.21, allowing remote attackers to execute 
arbitrary code via a long resource name in an HTTP request. 
This exploit has to deal with the fact that the 
application's request handler thread is terminated after 60 
seconds by a "monitor" thread. To do this, it allocates some 
RWX memory, copies the payload to it and creates another 
thread. When done, it terminates the current thread so that 
it doesn't crash and hence doesn't bring down the process 
with it.


## Module Name
exploit/windows/http/ultraminihttp_bof

## Authors
* superkojiman
* PsychoSpy <neinwechter[at]gmail.com>
* OJ Reeves <oj[at]buffered.io>


## References
* http://www.osvdb.org/95164
* https://www.exploit-db.com/exploits/26739
* http://cvedetails.com/cve/2013-5019/
* http://www.securityfocus.com/bid/61130



## Targets
* v1.21 - Windows Server 2000
* v1.21 - Windows XP SP0
* v1.21 - Windows XP SP2/SP3
* v1.21 - Windows Server 2003 (Enterprise)


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/http/ultraminihttp_bof
msf exploit(ultraminihttp_bof) > show targets
   ... a list of targets ...
msf exploit(ultraminihttp_bof) > set TARGET <target-id>
msf exploit(ultraminihttp_bof) > show options
   ... show and set options ...
msf exploit(ultraminihttp_bof) > run
```
    
    