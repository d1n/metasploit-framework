## HP OpenView Network Node Manager ovwebsnmpsrv.exe Unrecognized Option Buffer Overflow

This module exploits a stack buffer overflow in HP OpenView 
Network Node Manager 7.53 prior to NNM_01203. By specifying 
a long 'arg' parameter when executing the 'jovgraph.exe' CGI 
program, an attacker can cause a stack-based buffer overflow 
and execute arbitrary code. The vulnerable code is within 
the option parsing function within "ovwebsnmpsrv.exe" with a 
timestamp prior to April 7th, 2010. Reaching the vulnerable 
code requires a 'POST' request with an 'arg' parameter that, 
when combined with a some static text, exceeds 10240 bytes. 
The parameter must begin with a dash. It is important to 
note that this vulnerability must be exploited by 
overwriting SEH. This is since overflowing the buffer with 
controllable data always triggers an access violation when 
attempting to write static text beyond the end of the stack. 
Exploiting this issue is a bit tricky due to a restrictive 
character set. In order to accomplish arbitrary code 
execution, a double-backward jump is used in combination 
with the Alpha2 encoder.


## Module Name
exploit/windows/http/hp_nnm_ovwebsnmpsrv_uro

## Authors
* jduck


## References
* http://cvedetails.com/cve/2010-1960/
* http://www.osvdb.org/65427
* http://www.securityfocus.com/bid/40637
* http://www.zerodayinitiative.com/advisories/ZDI-10-105



## Targets
* HP OpenView Network Node Manager 7.53 w/NNM_01206
* Debug Target


## Platforms
win

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/http/hp_nnm_ovwebsnmpsrv_uro
msf exploit(hp_nnm_ovwebsnmpsrv_uro) > show targets
   ... a list of targets ...
msf exploit(hp_nnm_ovwebsnmpsrv_uro) > set TARGET <target-id>
msf exploit(hp_nnm_ovwebsnmpsrv_uro) > show options
   ... show and set options ...
msf exploit(hp_nnm_ovwebsnmpsrv_uro) > run
```
    
    