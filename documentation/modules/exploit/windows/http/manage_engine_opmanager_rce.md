## ManageEngine OpManager Remote Code Execution

This module exploits a default credential vulnerability in 
ManageEngine OpManager, where a default hidden account 
"IntegrationUser" with administrator privileges exists. The 
account has a default password of "plugin" which can not be 
reset through the user interface. By log-in and abusing the 
default administrator's SQL query functionality, it's 
possible to write a WAR payload to disk and trigger an 
automatic deployment of this payload. This module has been 
tested successfully on OpManager v11.5 and v11.6 for 
Windows.


## Module Name
exploit/windows/http/manage_engine_opmanager_rce

## Authors
* xistence <xistence[at]0x90.nl>


## References
* https://www.exploit-db.com/exploits/38174
* http://cvedetails.com/cve/2015-7765/
* http://cvedetails.com/cve/2015-7766/
* http://seclists.org/fulldisclosure/2015/Sep/66
* https://support.zoho.com/portal/manageengine/helpcenter/articles/pgsql-submitquery-do-vulnerability



## Targets
* ManageEngine OpManager v11.6


## Platforms
* java

## Reliability
[Manual](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/http/manage_engine_opmanager_rce
msf exploit(manage_engine_opmanager_rce) > show targets
   ... a list of targets ...
msf exploit(manage_engine_opmanager_rce) > set TARGET <target-id>
msf exploit(manage_engine_opmanager_rce) > show options
   ... show and set options ...
msf exploit(manage_engine_opmanager_rce) > run
```
    
    