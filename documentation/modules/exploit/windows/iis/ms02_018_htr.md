## MS02-018 Microsoft IIS 4.0 .HTR Path Overflow

This exploits a buffer overflow in the ISAPI ISM.DLL used to 
process HTR scripting in IIS 4.0. This module works against 
Windows NT 4 Service Packs 3, 4, and 5. The server will 
continue to process requests until the payload being 
executed has exited. If you've set EXITFUNC to 'seh', the 
server will continue processing requests, but you will have 
trouble terminating a bind shell. If you set EXITFUNC to 
thread, the server will crash upon exit of the bind shell. 
The payload is alpha-numerically encoded without a NOP sled 
because otherwise the data gets mangled by the filters.


## Module Name
exploit/windows/iis/ms02_018_htr

## Authors
* stinko


## References
* http://cvedetails.com/cve/1999-0874/
* http://www.osvdb.org/3325
* http://www.securityfocus.com/bid/307
* http://www.eeye.com/html/research/advisories/AD19990608.html
* http://technet.microsoft.com/en-us/security/bulletin/MS02-018



## Targets
* Windows NT 4.0 SP3
* Windows NT 4.0 SP4
* Windows NT 4.0 SP5


## Platforms
win

## Reliability
[Good](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/iis/ms02_018_htr
msf exploit(ms02_018_htr) > show targets
   ... a list of targets ...
msf exploit(ms02_018_htr) > set TARGET <target-id>
msf exploit(ms02_018_htr) > show options
   ... show and set options ...
msf exploit(ms02_018_htr) > run
```
    
    