## Microsoft IIS ISAPI w3who.dll Query String Overflow

This module exploits a stack buffer overflow in the 
w3who.dll ISAPI application. This vulnerability was 
discovered Nicolas Gregoire and this code has been 
successfully tested against Windows 2000 and Windows XP 
(SP2). When exploiting Windows XP, the payload must call 
RevertToSelf before it will be able to spawn a command 
shell.


## Module Name
exploit/windows/isapi/w3who_query

## Authors
* hdm


## References
* http://cvedetails.com/cve/2004-1134/
* http://www.osvdb.org/12258
* http://www.exaprobe.com/labs/advisories/esa-2004-1206.html
* http://www.securityfocus.com/bid/11820



## Targets
* Automatic Detection
* Windows 2000 RESKIT DLL [Windows 2000]
* Windows 2000 RESKIT DLL [Windows XP]


## Platforms
win

## Reliability
[Good](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/isapi/w3who_query
msf exploit(w3who_query) > show targets
   ... a list of targets ...
msf exploit(w3who_query) > set TARGET <target-id>
msf exploit(w3who_query) > show options
   ... show and set options ...
msf exploit(w3who_query) > run
```
    
    