## MS11-038 Microsoft Office Excel Malformed OBJ Record Handling Overflow

This module exploits a vulnerability found in Excel 2002 of 
Microsoft Office XP. By supplying a .xls file with a 
malformed OBJ (recType 0x5D) record an attacker can get the 
control of the excution flow. This results aribrary code 
execution under the context of the user.


## Module Name
exploit/windows/fileformat/ms10_038_excel_obj_bof

## Authors
* Nicolas Joly
* Shahin Ramezany <shahin[at]abysssec.com>
* juan vazquez


## References
* http://cvedetails.com/cve/2010-0822/
* http://www.osvdb.org/65236
* http://www.securityfocus.com/bid/40520
* http://technet.microsoft.com/en-us/security/bulletin/MS10-038
* http://www.exploit-db.com/moaub-24-microsoft-excel-obj-record-stack-overflow/



## Targets
* Microsoft Office Excel 2002 10.2614.2625 Service Pack 0(Office XP) on Windows XP SP3
* Microsoft Office Excel 2002 10.6501.6626 Service Pack 3 (Office XP SP3) on Windows XP SP3


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/fileformat/ms10_038_excel_obj_bof
msf exploit(ms10_038_excel_obj_bof) > show targets
   ... a list of targets ...
msf exploit(ms10_038_excel_obj_bof) > set TARGET <target-id>
msf exploit(ms10_038_excel_obj_bof) > show options
   ... show and set options ...
msf exploit(ms10_038_excel_obj_bof) > run
```
    
    