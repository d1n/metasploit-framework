## MS09-067 Microsoft Excel Malformed FEATHEADER Record Vulnerability

This module exploits a vulnerability in the handling of the 
FEATHEADER record by Microsoft Excel. Revisions of Office XP 
and later prior to the release of the MS09-067 bulletin are 
vulnerable. When processing a FEATHEADER (Shared Feature) 
record, Microsoft used a data structure from the file to 
calculate a pointer offset without doing proper validation. 
Attacker supplied data is then used to calculate the 
location of an object, and in turn a virtual function call. 
This results in arbitrary code exection. NOTE: On some 
versions of Office, the user will need to dismiss a warning 
dialog prior to the payload executing.


## Module Name
exploit/windows/fileformat/ms09_067_excel_featheader

## Authors
* Sean Larsson
* jduck


## References
* http://cvedetails.com/cve/2009-3129/
* http://www.osvdb.org/59860
* http://technet.microsoft.com/en-us/security/bulletin/MS09-067
* http://www.securityfocus.com/bid/36945
* http://www.zerodayinitiative.com/advisories/ZDI-09-083
* http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=832



## Targets
* Microsoft Office 2002 (XP) SP3 base English on Windows XP SP3 English
* Microsoft Office 2002 (XP) SP3 w/kb969680 English on Windows XP SP3 English
* Microsoft Office 2003 SP0 English on Windows XP SP3 English
* Microsoft Office 2007 SP2 English on Windows XP SP3 English
* Crash Target for Debugging


## Platforms
win

## Reliability
[Good](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/fileformat/ms09_067_excel_featheader
msf exploit(ms09_067_excel_featheader) > show targets
   ... a list of targets ...
msf exploit(ms09_067_excel_featheader) > set TARGET <target-id>
msf exploit(ms09_067_excel_featheader) > show options
   ... show and set options ...
msf exploit(ms09_067_excel_featheader) > run
```
    
    