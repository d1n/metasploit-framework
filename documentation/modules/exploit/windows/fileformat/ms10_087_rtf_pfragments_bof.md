## MS10-087 Microsoft Word RTF pFragments Stack Buffer Overflow (File Format)

This module exploits a stack-based buffer overflow in the 
handling of the 'pFragments' shape property within the 
Microsoft Word RTF parser. All versions of Microsoft Office 
2010, 2007, 2003, and XP prior to the release of the 
MS10-087 bulletin are vulnerable. This module does not 
attempt to exploit the vulnerability via Microsoft Outlook. 
The Microsoft Word RTF parser was only used by default in 
versions of Microsoft Word itself prior to Office 2007. With 
the release of Office 2007, Microsoft began using the Word 
RTF parser, by default, to handle rich-text messages within 
Outlook as well. It was possible to configure Outlook 2003 
and earlier to use the Microsoft Word engine too, but it was 
not a default setting. It appears as though Microsoft Office 
2000 is not vulnerable. It is unlikely that Microsoft will 
confirm or deny this since Office 2000 has reached its 
support cycle end-of-life.


## Module Name
exploit/windows/fileformat/ms10_087_rtf_pfragments_bof

## Authors
* wushi of team509
* unknown
* jduck
* DJ Manila Ice, Vesh, CA


## References
* http://cvedetails.com/cve/2010-3333/
* http://www.osvdb.org/69085
* http://technet.microsoft.com/en-us/security/bulletin/MS10-087
* http://www.securityfocus.com/bid/44652
* http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=880



## Targets
* Automatic
* Microsoft Office 2002 SP3 English on Windows XP SP3 English
* Microsoft Office 2003 SP3 English on Windows XP SP3 English
* Microsoft Office 2007 SP0 English on Windows XP SP3 English
* Microsoft Office 2007 SP0 English on Windows Vista SP0 English
* Microsoft Office 2007 SP0 English on Windows 7 SP0 English
* Crash Target for Debugging


## Platforms
win

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/fileformat/ms10_087_rtf_pfragments_bof
msf exploit(ms10_087_rtf_pfragments_bof) > show targets
   ... a list of targets ...
msf exploit(ms10_087_rtf_pfragments_bof) > set TARGET <target-id>
msf exploit(ms10_087_rtf_pfragments_bof) > show options
   ... show and set options ...
msf exploit(ms10_087_rtf_pfragments_bof) > run
```
    
    