## MS11-006 Microsoft Windows CreateSizedDIBSECTION Stack Buffer Overflow

This module exploits a stack-based buffer overflow in the 
handling of thumbnails within .MIC files and various Office 
documents. When processing a thumbnail bitmap containing a 
negative 'biClrUsed' value, a stack-based buffer overflow 
occurs. This leads to arbitrary code execution. In order to 
trigger the vulnerable code, the folder containing the 
document must be viewed using the "Thumbnails" view.


## Module Name
exploit/windows/fileformat/ms11_006_createsizeddibsection

## Authors
* Moti & Xu Hao
* Yaniv Miron aka Lament of ilhack
* jduck


## References
* http://cvedetails.com/cve/2010-3970/
* http://www.osvdb.org/70263
* http://technet.microsoft.com/en-us/security/bulletin/MS11-006
* http://www.securityfocus.com/bid/45662
* http://www.microsoft.com/technet/security/advisory/2490606.mspx



## Targets
* Automatic
* Windows 2000 SP0/SP4 English
* Windows XP SP3 English
* Crash Target for Debugging


## Platforms
win

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/fileformat/ms11_006_createsizeddibsection
msf exploit(ms11_006_createsizeddibsection) > show targets
   ... a list of targets ...
msf exploit(ms11_006_createsizeddibsection) > set TARGET <target-id>
msf exploit(ms11_006_createsizeddibsection) > show options
   ... show and set options ...
msf exploit(ms11_006_createsizeddibsection) > run
```
    
    