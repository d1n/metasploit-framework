## Winamp MAKI Buffer Overflow

This module exploits a stack based buffer overflow in Winamp 
5.55. The flaw exists in the gen_ff.dll and occurs while 
parsing a specially crafted MAKI file, where memmove is used 
with in a insecure way with user controlled data. To exploit 
the vulnerability the attacker must convince the attacker to 
install the generated mcvcore.maki file in the "scripts" 
directory of the default "Bento" skin, or generate a new 
skin using the crafted mcvcore.maki file. The module has 
been tested successfully on Windows XP SP3 and Windows 7 
SP1.


## Module Name
exploit/windows/fileformat/winamp_maki_bof

## Authors
* Monica Sojeong Hong
* juan vazquez


## References
* http://cvedetails.com/cve/2009-1831/
* http://www.osvdb.org/54902
* http://www.securityfocus.com/bid/35052
* https://www.exploit-db.com/exploits/8783
* https://www.exploit-db.com/exploits/8772
* https://www.exploit-db.com/exploits/8770
* https://www.exploit-db.com/exploits/8767
* http://vrt-sourcefire.blogspot.com/2009/05/winamp-maki-parsing-vulnerability.html



## Targets
* Winamp 5.55 / Windows XP SP3 / Windows 7 SP1


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/fileformat/winamp_maki_bof
msf exploit(winamp_maki_bof) > show targets
   ... a list of targets ...
msf exploit(winamp_maki_bof) > set TARGET <target-id>
msf exploit(winamp_maki_bof) > show options
   ... show and set options ...
msf exploit(winamp_maki_bof) > run
```
    
    