## MS14-064 Microsoft Windows OLE Package Manager Code Execution

This module exploits a vulnerability found in Windows Object 
Linking and Embedding (OLE) allowing arbitrary code 
execution, publicly exploited in the wild as MS14-060 patch 
bypass. The Microsoft update tried to fix the vulnerability 
publicly known as "Sandworm". Platforms such as Windows 
Vista SP2 all the way to Windows 8, Windows Server 2008 and 
2012 are known to be vulnerable. However, based on our 
testing, the most reliable setup is on Windows platforms 
running Office 2013 and Office 2010 SP2. Please keep in mind 
that some other setups such as using Office 2010 SP1 might 
be less stable, and may end up with a crash due to a failure 
in the CPackage::CreateTempFileName function.


## Module Name
exploit/windows/fileformat/ms14_064_packager_run_as_admin

## Authors
* Haifei Li
* sinn3r
* juan vazquez


## References
* http://cvedetails.com/cve/2014-6352/
* http://technet.microsoft.com/en-us/security/bulletin/MS14-064
* http://www.securityfocus.com/bid/70690
* http://blogs.mcafee.com/mcafee-labs/bypassing-microsofts-patch-sandworm-zero-day-even-editing-dangerous



## Targets
* Windows 7 SP1 / Office 2010 SP2 / Office 2013


## Platforms
win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/fileformat/ms14_064_packager_run_as_admin
msf exploit(ms14_064_packager_run_as_admin) > show targets
   ... a list of targets ...
msf exploit(ms14_064_packager_run_as_admin) > set TARGET <target-id>
msf exploit(ms14_064_packager_run_as_admin) > show options
   ... show and set options ...
msf exploit(ms14_064_packager_run_as_admin) > run
```
    
    