## Adobe Reader ToolButton Use After Free

This module exploits an use after free condition on Adobe 
Reader versions 11.0.2, 10.1.6 and 9.5.4 and prior. The 
vulnerability exists while handling the ToolButton object, 
where the cEnable callback can be used to early free the 
object memory. Later use of the object allows triggering the 
use after free condition. This module has been tested 
successfully on Adobe Reader 11.0.2, 10.0.4 and 9.5.0 on 
Windows XP SP3, as exploited in the wild in November, 2013.


## Module Name
exploit/windows/fileformat/adobe_toolbutton

## Authors
* Soroush Dalili
* Unknown
* sinn3r
* juan vazquez


## References
* http://cvedetails.com/cve/2013-3346/
* http://www.osvdb.org/96745
* http://www.zerodayinitiative.com/advisories/ZDI-13-212
* http://www.adobe.com/support/security/bulletins/apsb13-15.html
* http://www.fireeye.com/blog/technical/cyber-exploits/2013/11/ms-windows-local-privilege-escalation-zero-day-in-the-wild.html



## Targets
* Windows XP / Adobe Reader 9/10/11


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/fileformat/adobe_toolbutton
msf exploit(adobe_toolbutton) > show targets
   ... a list of targets ...
msf exploit(adobe_toolbutton) > set TARGET <target-id>
msf exploit(adobe_toolbutton) > show options
   ... show and set options ...
msf exploit(adobe_toolbutton) > run
```
    
    