## MS13-071 Microsoft Windows Theme File Handling Arbitrary Code Execution

This module exploits a vulnerability mainly affecting 
Microsoft Windows XP and Windows 2003. The vulnerability 
exists in the handling of the Screen Saver path, in the 
[boot] section. An arbitrary path can be used as screen 
saver, including a remote SMB resource, which allows for 
remote code execution when a malicious .theme file is 
opened, and the "Screen Saver" tab is viewed. The code 
execution is also triggered if the victim installs the 
malicious theme and stays away from the computer, when 
Windows tries to display the screensaver.


## Module Name
exploit/windows/fileformat/ms13_071_theme

## Authors
* Eduardo Prado
* juan vazquez
* Matthew Hall <hallm@sec-1.com>


## References
* http://cvedetails.com/cve/2013-0810/
* http://www.osvdb.org/97136
* http://technet.microsoft.com/en-us/security/bulletin/MS13-071
* http://www.securityfocus.com/bid/62176
* http://www.verisigninc.com/en_US/products-and-services/network-intelligence-availability/idefense/public-vulnerability-reports/articles/index.xhtml?id=1040
* https://community.rapid7.com/community/metasploit/blog/2013/09/25/change-the-theme-get-a-shell



## Targets
* Windows XP SP3 / Windows 2003 SP2


## Platforms
win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/fileformat/ms13_071_theme
msf exploit(ms13_071_theme) > show targets
   ... a list of targets ...
msf exploit(ms13_071_theme) > set TARGET <target-id>
msf exploit(ms13_071_theme) > show options
   ... show and set options ...
msf exploit(ms13_071_theme) > run
```
    
    