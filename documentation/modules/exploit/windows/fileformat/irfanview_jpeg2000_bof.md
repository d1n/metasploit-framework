## Irfanview JPEG2000 jp2 Stack Buffer Overflow

This module exploits a stack-based buffer overflow 
vulnerability in version <= 4.3.2.0 of Irfanview's 
JPEG2000.dll plugin. This exploit has been tested on a 
specific version of irfanview (v4.3.2), although other 
versions may work also. The vulnerability is triggered via 
parsing an invalid qcd chunk structure and specifying a 
malformed qcd size and data. Payload delivery and 
vulnerability trigger can be executed in multiple ways. The 
user can double click the file, use the file dialog, open 
via the icon and drag/drop the file into Irfanview's window. 
An egg hunter is used for stability.


## Module Name
exploit/windows/fileformat/irfanview_jpeg2000_bof

## Authors
* Parvez Anwar <parvez[at]greyhathacker.net>
* mr_me <steventhomasseeley[at]gmail.com>
* juan vazquez


## References
* http://cvedetails.com/cve/2012-0897/
* http://www.osvdb.org/78333
* http://www.securityfocus.com/bid/51426
* http://www.greyhathacker.net/?p=525



## Targets
* Irfanview 4.32 / Plugins 4.32 / Windows Universal


## Platforms
* win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/fileformat/irfanview_jpeg2000_bof
msf exploit(irfanview_jpeg2000_bof) > show targets
   ... a list of targets ...
msf exploit(irfanview_jpeg2000_bof) > set TARGET <target-id>
msf exploit(irfanview_jpeg2000_bof) > show options
   ... show and set options ...
msf exploit(irfanview_jpeg2000_bof) > run
```
    
    