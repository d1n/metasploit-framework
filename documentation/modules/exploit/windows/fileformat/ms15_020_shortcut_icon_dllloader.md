## Microsoft Windows Shell LNK Code Execution

This module exploits a vulnerability in the MS10-046 patch 
to abuse (again) the handling of Windows Shortcut files 
(.LNK) that contain an icon resource pointing to a malicious 
DLL. This module creates the required files to exploit the 
vulnerability. They must be uploaded to an UNC path 
accessible by the target. This module has been tested 
successfully on Windows 2003 SP2 with MS10-046 installed and 
Windows 2008 SP2 (32 bits) with MS14-027 installed.


## Module Name
exploit/windows/fileformat/ms15_020_shortcut_icon_dllloader

## Authors
* Michael Heerklotz
* juan vazquez


## References
* http://cvedetails.com/cve/2015-0096/
* http://technet.microsoft.com/en-us/security/bulletin/MS15-020
* http://h30499.www3.hp.com/t5/HP-Security-Research-Blog/Full-details-on-CVE-2015-0096-and-the-failed-MS10-046-Stuxnet/ba-p/6718459#.VQBOymTF9so
* https://github.com/rapid7/metasploit-framework/pull/4911



## Targets
* Automatic


## Platforms
win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/fileformat/ms15_020_shortcut_icon_dllloader
msf exploit(ms15_020_shortcut_icon_dllloader) > show targets
   ... a list of targets ...
msf exploit(ms15_020_shortcut_icon_dllloader) > set TARGET <target-id>
msf exploit(ms15_020_shortcut_icon_dllloader) > show options
   ... show and set options ...
msf exploit(ms15_020_shortcut_icon_dllloader) > run
```
    
    