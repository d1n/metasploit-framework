## MS12-027 MSCOMCTL ActiveX Buffer Overflow

This module exploits a stack buffer overflow in 
MSCOMCTL.OCX. It uses a malicious RTF to embed the specially 
crafted MSComctlLib.ListViewCtrl.2 Control as exploited in 
the wild on April 2012. This module targets Office 2007 and 
Office 2010 targets. The DEP/ASLR bypass on Office 2010 is 
done with the Ikazuchi ROP chain proposed by Abysssec. This 
chain uses "msgr3en.dll", which will load after office got 
load, so the malicious file must be loaded through "File / 
Open" to achieve exploitation.


## Module Name
exploit/windows/fileformat/ms12_027_mscomctl_bof

## Authors
* Unknown
* juan vazquez
* sinn3r


## References
* http://cvedetails.com/cve/2012-0158/
* http://www.osvdb.org/81125
* http://www.securityfocus.com/bid/52911
* http://technet.microsoft.com/en-us/security/bulletin/MS12-027
* http://contagiodump.blogspot.com.es/2012/04/cve2012-0158-south-china-sea-insider.html



## Targets
* Microsoft Office 2007 [no-SP/SP1/SP2/SP3] English on Windows [XP SP3 / 7 SP1] English
* Microsoft Office 2010 SP1 English on Windows [XP SP3 / 7 SP1] English


## Platforms
win

## Reliability
[Average](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/fileformat/ms12_027_mscomctl_bof
msf exploit(ms12_027_mscomctl_bof) > show targets
   ... a list of targets ...
msf exploit(ms12_027_mscomctl_bof) > set TARGET <target-id>
msf exploit(ms12_027_mscomctl_bof) > show options
   ... show and set options ...
msf exploit(ms12_027_mscomctl_bof) > run
```
    
    