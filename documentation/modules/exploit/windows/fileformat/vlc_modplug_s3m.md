## VideoLAN VLC ModPlug ReadS3M Stack Buffer Overflow

This module exploits an input validation error in 
libmod_plugin as included with VideoLAN VLC 1.1.8. All 
versions prior to version 1.1.9 are affected. By creating a 
malicious S3M file, a remote attacker could execute 
arbitrary code. Although other products that bundle 
libmodplug may be vulnerable, this module was only tested 
against VLC. NOTE: As of July 1st, 2010, VLC now calls 
SetProcessDEPPoly to permanently enable NX support on 
machines that support it. As such, this module is capable of 
bypassing DEP, but not ASLR.


## Module Name
exploit/windows/fileformat/vlc_modplug_s3m

## Authors
* jduck


## References
* http://cvedetails.com/cve/2011-1574/
* http://www.osvdb.org/72143
* http://modplug-xmms.git.sourceforge.net/git/gitweb.cgi?p=modplug-xmms/modplug-xmms;a=commitdiff;h=aecef259828a89bb00c2e6f78e89de7363b2237b
* http://seclists.org/fulldisclosure/2011/Apr/113



## Targets
* VLC 1.1.8 on Windows XP SP3


## Platforms
win

## Reliability
[Average](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/fileformat/vlc_modplug_s3m
msf exploit(vlc_modplug_s3m) > show targets
   ... a list of targets ...
msf exploit(vlc_modplug_s3m) > set TARGET <target-id>
msf exploit(vlc_modplug_s3m) > show options
   ... show and set options ...
msf exploit(vlc_modplug_s3m) > run
```
    
    