## TFTP Server for Windows 1.4 ST WRQ Buffer Overflow

This module exploits a vulnerability found in TFTP Server 
1.4 ST. The flaw is due to the way TFTP handles the filename 
parameter extracted from a WRQ request. The server will 
append the user-supplied filename to TFTP server binary's 
path without any bounds checking, and then attempt to check 
this path with a fopen(). Since this isn't a valid file 
path, fopen() returns null, which allows the corrupted data 
to be used in a strcmp() function, causing an access 
violation. Since the offset is sensitive to how the TFTP 
server is launched, you must know in advance if your victim 
machine launched the TFTP as a 'Service' or 'Standalone' , 
and then manually select your target accordingly. A 
successful attempt will lead to remote code execution under 
the context of SYSTEM if run as a service, or the user if 
run as a standalone. A failed attempt will result a 
denial-of-service.


## Module Name
exploit/windows/tftp/tftpserver_wrq_bof

## Authors
* Mati Aharoni
* Datacut


## References
* http://cvedetails.com/cve/2008-1611/
* http://www.osvdb.org/43785
* http://www.securityfocus.com/bid/18345
* https://www.exploit-db.com/exploits/5314



## Targets
* Windows XP SP2/SP3 EN Service Mode
* Windows XP SP2/SP3 EN Standalone Mode
* Windows 7 SP0/SP1 EN x64 Service Mode
* Windows 7 SP0/SP1 EN x64 Standalone Mode
* Windows 7 SP0/SP1 EN x86 Service Mode
* Windows 7 SP0/SP1 EN x86 Standalone Mode


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/tftp/tftpserver_wrq_bof
msf exploit(tftpserver_wrq_bof) > show targets
   ... a list of targets ...
msf exploit(tftpserver_wrq_bof) > set TARGET <target-id>
msf exploit(tftpserver_wrq_bof) > show options
   ... show and set options ...
msf exploit(tftpserver_wrq_bof) > run
```
    
    