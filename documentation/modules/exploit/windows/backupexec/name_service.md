## Veritas Backup Exec Name Service Overflow

This module exploits a vulnerability in the Veritas Backup 
Exec Agent Browser service. This vulnerability occurs when a 
recv() call has a length value too long for the destination 
stack buffer. By sending an agent name value of 63 bytes or 
more, we can overwrite the return address of the recv 
function. Since we only have ~60 bytes of contiguous space 
for shellcode, a tiny findsock payload is sent which uses a 
hardcoded IAT address for the recv() function. This payload 
will then roll the stack back to the beginning of the page, 
recv() the real shellcode into it, and jump to it. This 
module has been tested against Veritas 9.1 SP0, 9.1 SP1, and 
8.6.


## Module Name
exploit/windows/backupexec/name_service

## Authors
* hdm


## References
* http://cvedetails.com/cve/2004-1172/
* http://www.osvdb.org/12418
* http://www.securityfocus.com/bid/11974
* http://www.idefense.com/application/poi/display?id=169&type=vulnerabilities



## Targets
* Veritas BE 9.1 SP0/SP1
* Veritas BE 8.5


## Platforms
* win

## Reliability
[Average](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/backupexec/name_service
msf exploit(name_service) > show targets
   ... a list of targets ...
msf exploit(name_service) > set TARGET <target-id>
msf exploit(name_service) > show options
   ... show and set options ...
msf exploit(name_service) > run
```
    
    