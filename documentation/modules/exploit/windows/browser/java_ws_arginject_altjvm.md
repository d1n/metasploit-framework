## Sun Java Web Start Plugin Command Line Argument Injection

This module exploits a flaw in the Web Start plugin 
component of Sun Java Web Start. The arguments passed to 
Java Web Start are not properly validated. By passing the 
lesser known -J option, an attacker can pass arbitrary 
options directly to the Java runtime. By utilizing the 
-XXaltjvm option, as discussed by Ruben Santamarta, an 
attacker can execute arbitrary code in the context of an 
unsuspecting browser user. This vulnerability was originally 
discovered independently by both Ruben Santamarta and Tavis 
Ormandy. Tavis reported that all versions since version 6 
Update 10 "are believed to be affected by this 
vulnerability." In order for this module to work, it must be 
ran as root on a server that does not serve SMB. 
Additionally, the target host must have the WebClient 
service (WebDAV Mini-Redirector) enabled.


## Module Name
exploit/windows/browser/java_ws_arginject_altjvm

## Authors
jduck


## References
* http://cvedetails.com/cve/2010-0886/
* http://cvedetails.com/cve/2010-1423/
* http://www.osvdb.org/63648
* http://www.securityfocus.com/bid/39346
* http://archives.neohapsis.com/archives/fulldisclosure/2010-04/0122.html
* http://www.reversemode.com/index.php?option=com_content&task=view&id=67&Itemid=1



## Targets
* Automatic
* Java Runtime on Windows x86


## Platforms
win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/java_ws_arginject_altjvm
msf exploit(java_ws_arginject_altjvm) > show targets
   ... a list of targets ...
msf exploit(java_ws_arginject_altjvm) > set TARGET <target-id>
msf exploit(java_ws_arginject_altjvm) > show options
   ... show and set options ...
msf exploit(java_ws_arginject_altjvm) > run
```
    
    