## Sun Java Web Start Double Quote Injection

This module exploits a flaw in the Web Start component of 
the Sun Java Runtime Environment. Parameters 
intial-heap-size and max-heap-size in a JNLP file can 
contain a double quote which is not properly sanitized when 
creating the command line for javaw.exe. This allows the 
injection of the -XXaltjvm option to load a jvm.dll from a 
remote UNC path into the java process. Thus an attacker can 
execute arbitrary code in the context of a browser user. 
This flaw was fixed in Oct. 2012 and affects JRE <= 1.6.35 
and <= 1.7.07. In order for this module to work, it must be 
run as root on a server that does not serve SMB (In most 
cases, this means non-Windows hosts). Additionally, the 
target host must have the WebClient service (WebDAV 
Mini-Redirector) enabled. Alternatively, a UNC path 
containing a jvm.dll can be specified, bypassing the Windows 
limitation for the Metasploit host.


## Module Name
exploit/windows/browser/java_ws_double_quote

## Authors
* Rh0 <rh0[at]z1p.biz>


## References
* http://cvedetails.com/cve/2012-1533/
* http://www.osvdb.org/86348
* http://www.securityfocus.com/bid/56046
* http://www.oracle.com/technetwork/topics/security/javacpuoct2012-1515924.html
* http://pastebin.com/eUucVage 



## Targets
* Automatic
* Java Runtime 1.6.31 to 1.6.35 and 1.7.03 to 1.7.07 on Windows x86


## Platforms
win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/java_ws_double_quote
msf exploit(java_ws_double_quote) > show targets
   ... a list of targets ...
msf exploit(java_ws_double_quote) > set TARGET <target-id>
msf exploit(java_ws_double_quote) > show options
   ... show and set options ...
msf exploit(java_ws_double_quote) > run
```
    
    