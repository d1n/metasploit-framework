## MS10-002 Microsoft Internet Explorer Object Memory Use-After-Free

This module exploits a vulnerability found in Internet 
Explorer's mshtml component. Due to the way IE handles 
objects in memory, it is possible to cause a pointer in 
CTableRowCellsCollectionCacheItem::GetNext to be used even 
after it gets freed, therefore allowing remote code 
execution under the context of the user. This particular 
vulnerability was also one of 2012's Pwn2Own challenges, and 
was later explained by Peter Vreugdenhil with exploitation 
details. Instead of Peter's method, this module uses heap 
spraying like the 99% to store a specially crafted memory 
layout before re-using the freed memory.


## Module Name
exploit/windows/browser/ms10_002_ie_object

## Authors
* Peter Vreugdenhil
* juan vazquez
* sinn3r


## References
* http://technet.microsoft.com/en-us/security/bulletin/MS10-002
* http://cvedetails.com/cve/2010-0248/
* http://www.osvdb.org/61914
* http://dvlabs.tippingpoint.com/blog/2012/03/15/pwn2own-2012-challenge-writeup
* http://www.zerodayinitiative.com/advisories/ZDI-10-014



## Targets
* Automatic
* IE 8 on Windows XP SP3
* IE 8 on Windows 7 SP0


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/ms10_002_ie_object
msf exploit(ms10_002_ie_object) > show targets
   ... a list of targets ...
msf exploit(ms10_002_ie_object) > set TARGET <target-id>
msf exploit(ms10_002_ie_object) > show options
   ... show and set options ...
msf exploit(ms10_002_ie_object) > run
```
    
    