## Apple QuickTime 7.6.7 _Marshaled_pUnk Code Execution

This module exploits a memory trust issue in Apple QuickTime 
7.6.7. When processing a specially-crafted HTML page, the 
QuickTime ActiveX control will treat a supplied parameter as 
a trusted pointer. It will then use it as a COM-type 
pUnknown and lead to arbitrary code execution. This exploit 
utilizes a combination of heap spraying and the 
QuickTimeAuthoring.qtx module to bypass DEP and ASLR. This 
module does not opt-in to ASLR. As such, this module should 
be reliable on all Windows versions. NOTE: The addresses may 
need to be adjusted for older versions of QuickTime.


## Module Name
exploit/windows/browser/apple_quicktime_marshaled_punk

## Authors
* Ruben Santemarta
* jduck


## References
* http://cvedetails.com/cve/2010-1818/
* http://www.osvdb.org/67705
* http://reversemode.com/index.php?option=com_content&task=view&id=69&Itemid=1



## Targets
* Apple QuickTime Player 7.6.6 and 7.6.7 on Windows XP SP3


## Platforms
win

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/apple_quicktime_marshaled_punk
msf exploit(apple_quicktime_marshaled_punk) > show targets
   ... a list of targets ...
msf exploit(apple_quicktime_marshaled_punk) > set TARGET <target-id>
msf exploit(apple_quicktime_marshaled_punk) > show options
   ... show and set options ...
msf exploit(apple_quicktime_marshaled_punk) > run
```
    
    