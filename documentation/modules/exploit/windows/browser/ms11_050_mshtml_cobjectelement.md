## MS11-050 IE mshtml!CObjectElement Use After Free

This module exploits a use-after-free vulnerability in 
Internet Explorer. The vulnerability occurs when an invalid 
<object> tag exists and other elements overlap/cover where 
the object tag should be when rendered (due to their 
styles/positioning). The mshtml!CObjectElement is then freed 
from memory because it is invalid. However, the 
mshtml!CDisplay object for the page continues to keep a 
reference to the freed <object> and attempts to call a 
function on it, leading to the use-after-free. Please note 
that for IE 8 targets, JRE (Java Runtime Environment) is 
required to bypass DEP (Data Execution Prevention).


## Module Name
exploit/windows/browser/ms11_050_mshtml_cobjectelement

## Authors
* d0c_s4vage
* sinn3r
* bannedit


## References
* http://cvedetails.com/cve/2011-1260/
* http://www.osvdb.org/72950
* http://technet.microsoft.com/en-us/security/bulletin/MS11-050
* http://d0cs4vage.blogspot.com/2011/06/insecticides-dont-kill-bugs-patch.html



## Targets
* Automatic
* Internet Explorer 7 on XP SP3
* Internet Explorer 7 on Windows Vista
* Internet Explorer 8 on XP SP3
* Internet Explorer 8 on Windows 7
* Debug Target (Crash)


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/ms11_050_mshtml_cobjectelement
msf exploit(ms11_050_mshtml_cobjectelement) > show targets
   ... a list of targets ...
msf exploit(ms11_050_mshtml_cobjectelement) > set TARGET <target-id>
msf exploit(ms11_050_mshtml_cobjectelement) > show options
   ... show and set options ...
msf exploit(ms11_050_mshtml_cobjectelement) > run
```
    
    