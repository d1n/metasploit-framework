## Adobe Flash Player 11.3 Kern Table Parsing Integer Overflow

This module exploits a vulnerability found in the ActiveX 
component of Adobe Flash Player before 11.3.300.271. By 
supplying a specially crafted .otf font file with a large 
nTables value in the 'kern' header, it is possible to 
trigger an integer overflow, which results in remote code 
execution under the context of the user. This vulnerability 
has also been exploited in the wild in limited targeted 
attacks. Please note in order to ensure reliability, the 
exploit is forced to modify your URIPATH parameter to less 
than 3 characters, which may cause possible URIPATH 
collisions.


## Module Name
exploit/windows/browser/adobe_flash_otf_font

## Authors
* Alexander Gavrun
* sinn3r
* juan vazquez


## References
* http://cvedetails.com/cve/2012-1535/
* http://www.osvdb.org/84607
* http://www.securityfocus.com/bid/55009
* http://labs.alienvault.com/labs/index.php/2012/cve-2012-1535-adobe-flash-being-exploited-in-the-wild/
* https://developer.apple.com/fonts/TTRefMan/RM06/Chap6.html
* http://contagiodump.blogspot.com.es/2012/08/cve-2012-1535-samples-and-info.html
* https://community.rapid7.com/community/metasploit/blog/2012/08/17/adobe-flash-player-exploit-cve-2012-1535-now-available-for-metasploit
* http://www.adobe.com/support/security/bulletins/apsb12-18.html



## Targets
* Automatic
* IE 6 on Windows XP SP3
* IE 7 on Windows XP SP3
* IE 8 on Windows XP SP3
* IE 7 on Windows Vista SP2
* IE 8 on Windows 7 SP1
* IE 9 on Windows 7 SP1


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/adobe_flash_otf_font
msf exploit(adobe_flash_otf_font) > show targets
   ... a list of targets ...
msf exploit(adobe_flash_otf_font) > set TARGET <target-id>
msf exploit(adobe_flash_otf_font) > show options
   ... show and set options ...
msf exploit(adobe_flash_otf_font) > run
```
    
    