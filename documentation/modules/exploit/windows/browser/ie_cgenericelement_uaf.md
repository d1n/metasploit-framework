## MS13-038 Microsoft Internet Explorer CGenericElement Object Use-After-Free Vulnerability

This module exploits a vulnerability found in Microsoft 
Internet Explorer. A use-after-free condition occurs when a 
CGenericElement object is freed, but a reference is kept on 
the Document and used again during rendering, an invalid 
memory that's controllable is used, and allows arbitrary 
code execution under the context of the user. Please note: 
This vulnerability has been exploited in the wild on 2013 
May, in the compromise of the Department of Labor (DoL) 
Website.


## Module Name
exploit/windows/browser/ie_cgenericelement_uaf

## Authors
* Unknown
* EMH
* juan vazquez
* sinn3r


## References
* http://cvedetails.com/cve/2013-1347/
* http://www.osvdb.org/92993
* http://technet.microsoft.com/en-us/security/bulletin/MS13-038
* http://www.kb.cert.org/vuls/id/237655
* http://blogs.technet.com/b/msrc/archive/2013/05/03/microsoft-releases-security-advisory-2847140.aspx
* http://r-7.co/IE8-DOL



## Targets
* Automatic
* IE 8 on Windows XP SP3
* IE 8 on Windows Vista
* IE 8 on Windows Server 2003
* IE 8 on Windows 7


## Platforms
win

## Reliability
[Good](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/ie_cgenericelement_uaf
msf exploit(ie_cgenericelement_uaf) > show targets
   ... a list of targets ...
msf exploit(ie_cgenericelement_uaf) > set TARGET <target-id>
msf exploit(ie_cgenericelement_uaf) > show options
   ... show and set options ...
msf exploit(ie_cgenericelement_uaf) > run
```
    
    