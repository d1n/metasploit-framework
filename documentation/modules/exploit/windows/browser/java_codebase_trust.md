## Sun Java Applet2ClassLoader Remote Code Execution

This module exploits a vulnerability in the Java Runtime 
Environment that allows an attacker to run an applet outside 
of the Java Sandbox. When an applet is invoked with: 1. A 
"codebase" parameter that points at a trusted directory 2. A 
"code" parameter that is a URL that does not contain any 
dots the applet will run outside of the sandbox. This 
vulnerability affects JRE prior to version 6 update 24.


## Module Name
exploit/windows/browser/java_codebase_trust

## Authors
* Frederic Hoguin
* jduck


## References
* http://cvedetails.com/cve/2010-4452/
* http://www.osvdb.org/71193
* http://www.zerodayinitiative.com/advisories/ZDI-11-084
* http://fhoguin.com/2011/03/oracle-java-unsigned-applet-applet2classloader-remote-code-execution-vulnerability-zdi-11-084-explained/
* http://www.oracle.com/technetwork/topics/security/javacpufeb2011-304611.html



## Targets
* Generic (Java Payload)


## Platforms
* java

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/java_codebase_trust
msf exploit(java_codebase_trust) > show targets
   ... a list of targets ...
msf exploit(java_codebase_trust) > set TARGET <target-id>
msf exploit(java_codebase_trust) > show options
   ... show and set options ...
msf exploit(java_codebase_trust) > run
```
    
    