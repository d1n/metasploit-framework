## Firefox onreadystatechange Event DocumentViewerImpl Use After Free

This module exploits a vulnerability found on Firefox 
17.0.6, specifically an use after free of a 
DocumentViewerImpl object, triggered via an specially 
crafted web page using onreadystatechange events and the 
window.stop() API, as exploited in the wild on 2013 August 
to target Tor Browser users.


## Module Name
exploit/windows/browser/mozilla_firefox_onreadystatechange

## Authors
* Nils
* Unknown
* w3bd3vil
* sinn3r
* juan vazquez


## References
* http://cvedetails.com/cve/2013-1690/
* http://www.osvdb.org/94584
* http://www.securityfocus.com/bid/60778
* https://www.mozilla.org/security/announce/2013/mfsa2013-53.html
* https://lists.torproject.org/pipermail/tor-announce/2013-August/000089.html
* https://bugzilla.mozilla.org/show_bug.cgi?id=901365
* http://krash.in/ffn0day.txt
* http://hg.mozilla.org/releases/mozilla-esr17/rev/2d5a85d7d3ae



## Targets
* Firefox 17 & Firefox 21 / Windows XP SP3


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/mozilla_firefox_onreadystatechange
msf exploit(mozilla_firefox_onreadystatechange) > show targets
   ... a list of targets ...
msf exploit(mozilla_firefox_onreadystatechange) > set TARGET <target-id>
msf exploit(mozilla_firefox_onreadystatechange) > show options
   ... show and set options ...
msf exploit(mozilla_firefox_onreadystatechange) > run
```
    
    