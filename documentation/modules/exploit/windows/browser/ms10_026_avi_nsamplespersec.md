## MS10-026 Microsoft MPEG Layer-3 Audio Stack Based Overflow

This module exploits a buffer overlow in l3codecx.ax while 
processing a AVI files with MPEG Layer-3 audio contents. The 
overflow only allows to overwrite with 0's so the three 
least significant bytes of EIP saved on stack are 
overwritten and shellcode is mapped using the .NET DLL 
memory technique pioneered by Alexander Sotirov and Mark 
Dowd. Please note on IE 8 targets, your malicious URL must 
be a trusted site in order to load the .Net control.


## Module Name
exploit/windows/browser/ms10_026_avi_nsamplespersec

## Authors
* Yamata Li
* Shahin Ramezany <shahin[at]abysssec.com>
* juan vazquez
* Jordi Sanchez <jsanchez[at]0x01000000.org>


## References
* http://cvedetails.com/cve/2010-0480/
* http://www.osvdb.org/63749
* http://www.securityfocus.com/bid/39303
* http://technet.microsoft.com/en-us/security/bulletin/MS10-026
* http://www.exploit-db.com/moaub-5-microsoft-mpeg-layer-3-audio-stack-based-overflow/
* http://www.phreedom.org/research/bypassing-browser-memory-protections/



## Targets
* Windows XP SP3 Automatic


## Platforms
* win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/ms10_026_avi_nsamplespersec
msf exploit(ms10_026_avi_nsamplespersec) > show targets
   ... a list of targets ...
msf exploit(ms10_026_avi_nsamplespersec) > set TARGET <target-id>
msf exploit(ms10_026_avi_nsamplespersec) > show options
   ... show and set options ...
msf exploit(ms10_026_avi_nsamplespersec) > run
```
    
    