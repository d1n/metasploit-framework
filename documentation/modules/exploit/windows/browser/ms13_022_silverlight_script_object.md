## MS13-022 Microsoft Silverlight ScriptObject Unsafe Memory Access

This module exploits a vulnerability in Microsoft 
Silverlight. The vulnerability exists on the Initialize() 
method from System.Windows.Browser.ScriptObject, which 
access memory in an unsafe manner. Since it is accessible 
for untrusted code (user controlled) it's possible to 
dereference arbitrary memory which easily leverages to 
arbitrary code execution. In order to bypass DEP/ASLR a 
second vulnerability is used, in the public WriteableBitmap 
class from System.Windows.dll. This module has been tested 
successfully on IE6 - IE10, Windows XP SP3 / Windows 7 SP1.


## Module Name
exploit/windows/browser/ms13_022_silverlight_script_object

## Authors
* James Forshaw
* Vitaliy Toropov
* juan vazquez


## References
* http://cvedetails.com/cve/2013-0074/
* http://cvedetails.com/cve/2013-3896/
* http://www.osvdb.org/91147
* http://www.osvdb.org/98223
* http://www.securityfocus.com/bid/58327
* http://www.securityfocus.com/bid/62793
* http://technet.microsoft.com/en-us/security/bulletin/MS13-022
* http://technet.microsoft.com/en-us/security/bulletin/MS13-087
* https://packetstormsecurity.com/files/123731



## Targets
* Windows x86/x64


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/ms13_022_silverlight_script_object
msf exploit(ms13_022_silverlight_script_object) > show targets
   ... a list of targets ...
msf exploit(ms13_022_silverlight_script_object) > set TARGET <target-id>
msf exploit(ms13_022_silverlight_script_object) > show options
   ... show and set options ...
msf exploit(ms13_022_silverlight_script_object) > run
```
    
    