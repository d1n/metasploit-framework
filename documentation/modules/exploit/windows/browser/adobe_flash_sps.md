## Adobe Flash Player MP4 SequenceParameterSetNALUnit Buffer Overflow

This module exploits a vulnerability found in Adobe Flash 
Player's Flash10u.ocx component. When processing a MP4 file 
(specifically the Sequence Parameter Set), Flash will see if 
pic_order_cnt_type is equal to 1, which sets the 
num_ref_frames_in_pic_order_cnt_cycle field, and then 
blindly copies data in offset_for_ref_frame on the stack, 
which allows arbitrary remote code execution under the 
context of the user. Numerous reports also indicate that 
this vulnerability has been exploited in the wild.


## Module Name
exploit/windows/browser/adobe_flash_sps

## Authors
* Alexander Gavrun
* Unknown
* sinn3r


## References
* http://cvedetails.com/cve/2011-2140/
* http://www.osvdb.org/74439
* http://www.securityfocus.com/bid/49083
* http://www.zerodayinitiative.com/advisories/ZDI-11-276
* http://www.kahusecurity.com/2011/cve-2011-2140-caught-in-the-wild/
* http://www.adobe.com/support/security/bulletins/apsb11-21.html
* http://0x1byte.blogspot.com/2011/11/analysis-of-cve-2011-2140-adobe-flash.html



## Targets
* Automatic
* IE 6 on Windows XP SP3
* IE 7 on Windows XP SP3 / Vista


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/adobe_flash_sps
msf exploit(adobe_flash_sps) > show targets
   ... a list of targets ...
msf exploit(adobe_flash_sps) > set TARGET <target-id>
msf exploit(adobe_flash_sps) > show options
   ... show and set options ...
msf exploit(adobe_flash_sps) > run
```
    
    