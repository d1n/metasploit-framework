## Quest InTrust Annotation Objects Uninitialized Pointer

This module exploits an uninitialized variable vulnerability 
in the Annotation Objects ActiveX component. The activeX 
component loads into memory without opting into ALSR so this 
module exploits the vulnerability against windows Vista and 
Windows 7 targets. A large heap spray is required to fulfill 
the requirement that EAX points to part of the ROP chain in 
a heap chunk and the calculated call will hit the pivot in a 
separate heap chunk. This will take some time in the users 
browser.


## Module Name
exploit/windows/browser/intrust_annotatex_add

## Authors
* rgod <rgod[at]autistici.org>
* mr_me <steventhomasseeley[at]gmail.com>


## References
* http://cvedetails.com/cve/2012-5896/
* http://www.osvdb.org/80662
* http://www.securityfocus.com/bid/52765
* https://www.exploit-db.com/exploits/18674



## Targets
* Automatic
* Windows XP/Vista SP0-SP3 (IE6/IE7)
* Windows XP SP0-SP3 DEP bypass (IE8)
* Windows 7/Vista ALSR/DEP bypass (IE8)


## Platforms
win

## Reliability
[Average](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/intrust_annotatex_add
msf exploit(intrust_annotatex_add) > show targets
   ... a list of targets ...
msf exploit(intrust_annotatex_add) > set TARGET <target-id>
msf exploit(intrust_annotatex_add) > show options
   ... show and set options ...
msf exploit(intrust_annotatex_add) > run
```
    
    