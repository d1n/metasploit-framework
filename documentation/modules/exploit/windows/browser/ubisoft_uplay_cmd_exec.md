## Ubisoft uplay 2.0.3 ActiveX Control Arbitrary Code Execution

The uplay ActiveX component allows an attacker to execute 
any command line action. User must sign in, unless auto-sign 
in is enabled and uplay must not already be running. Due to 
the way the malicious executable is served (WebDAV), the 
module must be run on port 80, so please make sure you have 
enough privilege to do that. Ubisoft released patch 2.04 as 
of Mon 20th July.


## Module Name
exploit/windows/browser/ubisoft_uplay_cmd_exec

## Authors
* Tavis Ormandy <taviso[at]cmpxchg8b.com>
* Ben Campbell
* phillips321 <phillips321[at]phillips321.co.uk>
* Richard Hicks <scriptmonkeyblog[at]gmail.com>


## References
* http://cvedetails.com/cve/2012-4177/
* http://www.osvdb.org/84402
* http://seclists.org/fulldisclosure/2012/Jul/375
* http://forums.ubi.com/showthread.php/699940-Uplay-PC-Patch-2-0-4-Security-fix



## Targets
* Automatic


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/ubisoft_uplay_cmd_exec
msf exploit(ubisoft_uplay_cmd_exec) > show targets
   ... a list of targets ...
msf exploit(ubisoft_uplay_cmd_exec) > set TARGET <target-id>
msf exploit(ubisoft_uplay_cmd_exec) > show options
   ... show and set options ...
msf exploit(ubisoft_uplay_cmd_exec) > run
```
    
    