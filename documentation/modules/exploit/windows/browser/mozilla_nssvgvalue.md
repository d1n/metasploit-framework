## Firefox nsSVGValue Out-of-Bounds Access Vulnerability

This module exploits an out-of-bounds access flaw in Firefox 
7 and 8 (<= 8.0.1). The notification of nsSVGValue observers 
via nsSVGValue::NotifyObservers(x,y) uses a loop which can 
result in an out-of-bounds access to attacker-controlled 
memory. The mObserver ElementAt() function (which picks up 
pointers), does not validate if a given index is out of 
bound. If a custom observer of nsSVGValue is created, which 
removes elements from the original observer, and memory 
layout is manipulated properly, the ElementAt() function 
might pick up an attacker provided pointer, which can be 
leveraged to gain remote arbitrary code execution.


## Module Name
exploit/windows/browser/mozilla_nssvgvalue

## Authors
* regenrecht
* Lincoln<lincoln[at]corelan.be>
* corelanc0d3r<peter.ve[at]corelan.be>


## References
* http://cvedetails.com/cve/2011-3658/
* http://www.osvdb.org/77953
* http://www.zerodayinitiative.com/advisories/ZDI-12-056
* https://bugzilla.mozilla.org/show_bug.cgi?id=708186



## Targets
* Automatic
* Windows XP - Firefox 7
* Windows XP - Firefox 8 (<= 8.0.1)


## Platforms
win

## Reliability
[Average](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/mozilla_nssvgvalue
msf exploit(mozilla_nssvgvalue) > show targets
   ... a list of targets ...
msf exploit(mozilla_nssvgvalue) > set TARGET <target-id>
msf exploit(mozilla_nssvgvalue) > show options
   ... show and set options ...
msf exploit(mozilla_nssvgvalue) > run
```
    
    