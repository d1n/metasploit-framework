## Oracle AutoVue ActiveX Control SetMarkupMode Buffer Overflow

This module exploits a vulnerability found in the 
AutoVue.ocx ActiveX control. The vulnerability, due to the 
insecure usage of an strcpy like function in the 
SetMarkupMode method, when handling a specially crafted 
sMarkup argument, allows to trigger a stack based buffer 
overflow which leads to code execution under the context of 
the user visiting a malicious web page. The module has been 
successfully tested against Oracle AutoVue Desktop Version 
20.0.0 (AutoVue.ocx 20.0.0.7330) on IE 6, 7, 8 and 9 (Java 6 
needed to DEP and ASLR bypass).


## Module Name
exploit/windows/browser/oracle_autovue_setmarkupmode

## Authors
* Brian Gorenc
* juan vazquez


## References
* http://cvedetails.com/cve/2012-0549/
* http://www.securityfocus.com/bid/53077
* http://www.osvdb.org/81439
* http://dvlabs.tippingpoint.com/advisory/TPTI-12-05
* http://www.oracle.com/technetwork/topics/security/cpuapr2012-366314.html
* https://community.rapid7.com/community/metasploit/blog/2012/08/15/the-stack-cookies-bypass-on-cve-2012-0549



## Targets
* Automatic
* IE 6 on Windows XP SP3
* IE 7 on Windows XP SP3 / Windows Vista SP2
* IE 8 with Java 6 on Windows XP SP3/7 SP1/Vista SP2
* IE 9 with Java 6 on Windows 7 SP1


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/oracle_autovue_setmarkupmode
msf exploit(oracle_autovue_setmarkupmode) > show targets
   ... a list of targets ...
msf exploit(oracle_autovue_setmarkupmode) > set TARGET <target-id>
msf exploit(oracle_autovue_setmarkupmode) > show options
   ... show and set options ...
msf exploit(oracle_autovue_setmarkupmode) > run
```
    
    