## MS10-022 Microsoft Internet Explorer Winhlp32.exe MsgBox Code Execution

This module exploits a code execution vulnerability that 
occurs when a user presses F1 on MessageBox originated from 
VBscript within a web page. When the user hits F1, the 
MessageBox help functionaility will attempt to load and use 
a HLP file from an SMB or WebDAV (if the WebDAV redirector 
is enabled) server. This particular version of the exploit 
implements a WebDAV server that will serve HLP file as well 
as a payload EXE. During testing warnings about the payload 
EXE being unsigned were witnessed. A future version of this 
module might use other methods that do not create such a 
warning.


## Module Name
exploit/windows/browser/ms10_022_ie_vbscript_winhlp32

## Authors
* Maurycy Prodeus
* jduck


## References
* http://cvedetails.com/cve/2010-0483/
* http://www.osvdb.org/62632
* http://technet.microsoft.com/en-us/security/bulletin/MS10-023
* http://www.microsoft.com/technet/security/advisory/981169.mspx
* http://blogs.technet.com/msrc/archive/2010/02/28/investigating-a-new-win32hlp-and-internet-explorer-issue.aspx
* http://isec.pl/vulnerabilities/isec-0027-msgbox-helpfile-ie.txt



## Targets
* Automatic
* Internet Explorer on Windows


## Platforms
win

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/ms10_022_ie_vbscript_winhlp32
msf exploit(ms10_022_ie_vbscript_winhlp32) > show targets
   ... a list of targets ...
msf exploit(ms10_022_ie_vbscript_winhlp32) > set TARGET <target-id>
msf exploit(ms10_022_ie_vbscript_winhlp32) > show options
   ... show and set options ...
msf exploit(ms10_022_ie_vbscript_winhlp32) > run
```
    
    