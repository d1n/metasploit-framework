## Sun Java Runtime New Plugin docbase Buffer Overflow

This module exploits a flaw in the new plugin component of 
the Sun Java Runtime Environment before v6 Update 22. By 
specifying specific parameters to the new plugin, an 
attacker can cause a stack-based buffer overflow and execute 
arbitrary code. When the new plugin is invoked with a 
"launchjnlp" parameter, it will copy the contents of the 
"docbase" parameter to a stack-buffer using the "sprintf" 
function. A string of 396 bytes is enough to overflow the 
256 byte stack buffer and overwrite some local variables as 
well as the saved return address. NOTE: The string being 
copied is first passed through the "WideCharToMultiByte". 
Due to this, only characters which have a valid localized 
multibyte representation are allowed. Invalid characters 
will be replaced with question marks ('?'). This 
vulnerability was originally discovered independently by 
both Stephen Fewer and Berend Jan Wever (SkyLined). Although 
exhaustive testing hasn't been done, all versions since 
version 6 Update 10 are believed to be affected by this 
vulnerability. This vulnerability was patched as part of the 
October 2010 Oracle Patch release.


## Module Name
exploit/windows/browser/java_docbase_bof

## Authors
jduck


## References
* http://cvedetails.com/cve/2010-3552/
* http://www.osvdb.org/68873
* http://www.securityfocus.com/bid/44023
* http://blog.harmonysecurity.com/2010/10/oracle-java-ie-browser-plugin-stack.html
* http://www.zerodayinitiative.com/advisories/ZDI-10-206
* http://code.google.com/p/skylined/issues/detail?id=23
* http://skypher.com/index.php/2010/10/13/issue-2-oracle-java-object-launchjnlp-docbase/
* http://www.oracle.com/technetwork/topics/security/javacpuoct2010-176258.html



## Targets
* Windows Universal (msvcr71.dll ROP)


## Platforms
win

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/java_docbase_bof
msf exploit(java_docbase_bof) > show targets
   ... a list of targets ...
msf exploit(java_docbase_bof) > set TARGET <target-id>
msf exploit(java_docbase_bof) > show options
   ... show and set options ...
msf exploit(java_docbase_bof) > run
```
    
    