## MS13-037 Microsoft Internet Explorer COALineDashStyleArray Integer Overflow

This module exploits an integer overflow vulnerability on 
Internet Explorer. The vulnerability exists in the handling 
of the dashstyle.array length for vml shapes on the vgx.dll 
module. The exploit has been built and tested specifically 
against Windows 7 SP1 with Internet Explorer 8. It uses 
either JRE6 or an information leak (to ntdll) to bypass 
ASLR, and by default the info leak is used. To make sure the 
leak is successful, the ntdll version should be either 
v6.1.7601.17514 (the default dll version on a newly 
installed/unpatched Windows 7 SP1), or ntdll.dll 
v6.1.7601.17725 (installed after apply MS12-001). If the 
target doesn't have the version the exploit wants, it will 
refuse to attack by sending a fake 404 message (webpage not 
found). If you wish to try the JRE6 component instead to 
bypass ASLR, you can set the advanced datastore option to 
'JRE6'. If JRE6 is chosen but the target doesn't have this 
particular component, the exploit will also refuse to attack 
by sending a 404 message.


## Module Name
exploit/windows/browser/ms13_037_svg_dashstyle

## Authors
* Nicolas Joly
* 4B5F5F4B
* juan vazquez
* sinn3r


## References
* http://cvedetails.com/cve/2013-2551/
* http://www.osvdb.org/91197
* http://www.securityfocus.com/bid/58570
* http://technet.microsoft.com/en-us/security/bulletin/MS13-037
* http://binvul.com/viewthread.php?tid=311



## Targets
* IE 8 on Windows 7 SP1


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/ms13_037_svg_dashstyle
msf exploit(ms13_037_svg_dashstyle) > show targets
   ... a list of targets ...
msf exploit(ms13_037_svg_dashstyle) > set TARGET <target-id>
msf exploit(ms13_037_svg_dashstyle) > show options
   ... show and set options ...
msf exploit(ms13_037_svg_dashstyle) > run
```
    
    