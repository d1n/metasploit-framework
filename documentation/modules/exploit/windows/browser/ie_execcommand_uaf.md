## MS12-063 Microsoft Internet Explorer execCommand Use-After-Free Vulnerability 

This module exploits a vulnerability found in Microsoft 
Internet Explorer (MSIE). When rendering an HTML page, the 
CMshtmlEd object gets deleted in an unexpected manner, but 
the same memory is reused again later in the 
CMshtmlEd::Exec() function, leading to a use-after-free 
condition. Please note that this vulnerability has been 
exploited in the wild since Sep 14 2012. Also note that 
presently, this module has some target dependencies for the 
ROP chain to be valid. For WinXP SP3 with IE8, msvcrt must 
be present (as it is by default). For Vista or Win7 with 
IE8, or Win7 with IE9, JRE 1.6.x or below must be installed 
(which is often the case).


## Module Name
exploit/windows/browser/ie_execcommand_uaf

## Authors
* unknown
* eromang
* binjo
* sinn3r
* juan vazquez


## References
* http://cvedetails.com/cve/2012-4969/
* http://www.osvdb.org/85532
* http://technet.microsoft.com/en-us/security/bulletin/MS12-063
* http://technet.microsoft.com/en-us/security/advisory/2757760
* http://eromang.zataz.com/2012/09/16/zero-day-season-is-really-not-over-yet/



## Targets
* Automatic
* IE 7 on Windows XP SP3
* IE 8 on Windows XP SP3
* IE 7 on Windows Vista
* IE 8 on Windows Vista
* IE 8 on Windows 7
* IE 9 on Windows 7


## Platforms
win

## Reliability
[Good](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/ie_execcommand_uaf
msf exploit(ie_execcommand_uaf) > show targets
   ... a list of targets ...
msf exploit(ie_execcommand_uaf) > set TARGET <target-id>
msf exploit(ie_execcommand_uaf) > show options
   ... show and set options ...
msf exploit(ie_execcommand_uaf) > run
```
    
    