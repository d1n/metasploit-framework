## HP Easy Printer Care XMLCacheMgr Class ActiveX Control Remote Code Execution

This module allows remote attackers to place arbitrary files 
on a users file system by abusing the 
"CacheDocumentXMLWithId" method from the "XMLCacheMgr" class 
in the HP Easy Printer HPTicketMgr.dll ActiveX Control 
(HPTicketMgr.dll 2.7.2.0). Code execution can be achieved by 
first uploading the payload to the remote machine 
embeddeding a vbs file, and then upload another mof file, 
which enables Windows Management Instrumentation service to 
execute the vbs. Please note that this module currently only 
works for Windows before Vista.


## Module Name
exploit/windows/browser/hp_easy_printer_care_xmlcachemgr

## Authors
* Andrea Micalizzi
* juan vazquez


## References
* http://cvedetails.com/cve/2011-4786/
* http://www.osvdb.org/78306
* http://www.securityfocus.com/bid/51396
* http://www.zerodayinitiative.com/advisories/ZDI-12-013



## Targets
* Automatic


## Platforms
win

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/hp_easy_printer_care_xmlcachemgr
msf exploit(hp_easy_printer_care_xmlcachemgr) > show targets
   ... a list of targets ...
msf exploit(hp_easy_printer_care_xmlcachemgr) > set TARGET <target-id>
msf exploit(hp_easy_printer_care_xmlcachemgr) > show options
   ... show and set options ...
msf exploit(hp_easy_printer_care_xmlcachemgr) > run
```
    
    