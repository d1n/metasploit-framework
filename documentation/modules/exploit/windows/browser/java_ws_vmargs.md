## Sun Java Web Start Plugin Command Line Argument Injection

This module exploits a flaw in the Web Start component of 
the Sun Java Runtime Environment. The arguments passed to 
Java Web Start are not properly validated, allowing 
injection of arbitrary arguments to the JVM. By utilizing 
the lesser known -J option, an attacker can take advantage 
of the -XXaltjvm option, as discussed previously by Ruben 
Santamarta. This method allows an attacker to execute 
arbitrary code in the context of an unsuspecting browser 
user. In order for this module to work, it must be ran as 
root on a server that does not serve SMB. Additionally, the 
target host must have the WebClient service (WebDAV 
Mini-Redirector) enabled.


## Module Name
exploit/windows/browser/java_ws_vmargs

## Authors
jduck


## References
* http://cvedetails.com/cve/2012-0500/
* http://www.osvdb.org/79227
* http://www.securityfocus.com/bid/52015
* http://seclists.org/fulldisclosure/2012/Feb/251
* http://www.oracle.com/technetwork/topics/security/javacpufeb2012-366318.html



## Targets
* Automatic
* Java Runtime on Windows x86


## Platforms
win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/java_ws_vmargs
msf exploit(java_ws_vmargs) > show targets
   ... a list of targets ...
msf exploit(java_ws_vmargs) > set TARGET <target-id>
msf exploit(java_ws_vmargs) > show options
   ... show and set options ...
msf exploit(java_ws_vmargs) > run
```
    
    