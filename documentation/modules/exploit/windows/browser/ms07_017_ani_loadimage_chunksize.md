## Windows ANI LoadAniIcon() Chunk Size Stack Buffer Overflow (HTTP)

This module exploits a buffer overflow vulnerability in the 
LoadAniIcon() function in USER32.dll. The flaw can be 
triggered through Internet Explorer 6 and 7 by using the 
CURSOR style sheet directive to load a malicious .ANI file. 
The module can also exploit Mozilla Firefox by using a UNC 
path in a moz-icon URL and serving the .ANI file over 
WebDAV. The vulnerable code in USER32.dll will catch any 
exceptions that occur while the invalid cursor is loaded, 
causing the exploit to silently fail when the wrong target 
has been chosen. This vulnerability was discovered by 
Alexander Sotirov of Determina and was rediscovered, in the 
wild, by McAfee.


## Module Name
exploit/windows/browser/ms07_017_ani_loadimage_chunksize

## Authors
* hdm
* skape
* Solar Eclipse <solareclipse[at]phreedom.org>


## References
* http://cvedetails.com/cve/2007-0038/
* http://www.osvdb.org/33629
* http://www.securityfocus.com/bid/23194
* http://technet.microsoft.com/en-us/security/bulletin/MS07-017
* http://www.microsoft.com/technet/security/advisory/935423.mspx



## Targets
* (Automatic) IE6, IE7 and Firefox on Windows NT, 2000, XP, 2003 and Vista
* IE6 on Windows NT, 2000, XP, 2003 (all languages)
* IE7 on Windows XP SP2, 2003 SP1, SP2 (all languages)
* IE7 and Firefox on Windows Vista (all languages)
* Firefox on Windows XP (English)
* Firefox on Windows 2003 (English)


## Platforms
win

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/ms07_017_ani_loadimage_chunksize
msf exploit(ms07_017_ani_loadimage_chunksize) > show targets
   ... a list of targets ...
msf exploit(ms07_017_ani_loadimage_chunksize) > set TARGET <target-id>
msf exploit(ms07_017_ani_loadimage_chunksize) > show options
   ... show and set options ...
msf exploit(ms07_017_ani_loadimage_chunksize) > run
```
    
    