## MS11-003 Microsoft Internet Explorer CSS Recursive Import Use After Free

This module exploits a memory corruption vulnerability 
within Microsoft\'s HTML engine (mshtml). When parsing an 
HTML page containing a recursive CSS import, a C++ object is 
deleted and later reused. This leads to arbitrary code 
execution. This exploit utilizes a combination of heap 
spraying and the .NET 2.0 'mscorie.dll' module to bypass DEP 
and ASLR. This module does not opt-in to ASLR. As such, this 
module should be reliable on all Windows versions with .NET 
2.0.50727 installed.


## Module Name
exploit/windows/browser/ms11_003_ie_css_import

## Authors
* passerby
* d0c_s4vage
* jduck


## References
* http://cvedetails.com/cve/2010-3971/
* http://www.osvdb.org/69796
* http://www.securityfocus.com/bid/45246
* http://www.microsoft.com/technet/security/advisory/2488013.mspx
* http://www.wooyun.org/bugs/wooyun-2010-0885
* http://seclists.org/fulldisclosure/2010/Dec/110
* http://technet.microsoft.com/en-us/security/bulletin/MS11-003



## Targets
* Automatic
* Internet Explorer 8
* Internet Explorer 7
* Internet Explorer 6
* Debug Target (Crash)


## Platforms
win

## Reliability
[Good](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/ms11_003_ie_css_import
msf exploit(ms11_003_ie_css_import) > show targets
   ... a list of targets ...
msf exploit(ms11_003_ie_css_import) > set TARGET <target-id>
msf exploit(ms11_003_ie_css_import) > show options
   ... show and set options ...
msf exploit(ms11_003_ie_css_import) > run
```
    
    