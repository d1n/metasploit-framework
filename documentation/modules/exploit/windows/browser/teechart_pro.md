## TeeChart Professional ActiveX Control Trusted Integer Dereference

This module exploits a integer overflow in TeeChart Pro 
ActiveX control. When sending an overly large/negative 
integer value to the AddSeries() property of 
TeeChart2010.ocx, the code will perform an arithemetic 
operation that wraps the value and is later directly trusted 
and called upon. This module has been designed to bypass DEP 
only under IE8 with Java support. Multiple versions 
(including the latest version) are affected by this 
vulnerability that date back to as far as 2001. The 
following controls are vulnerable: TeeChart5.ocx Version 
5.0.1.0 (clsid: B6C10489-FB89-11D4-93C9-006008A7EED4); 
TeeChart6.ocx Version 6.0.0.5 (clsid: 
536600D3-70FE-4C50-92FB-640F6BFC49AD); TeeChart7.ocx Version 
7.0.1.4 (clsid: FAB9B41C-87D6-474D-AB7E-F07D78F2422E); 
TeeChart8.ocx Version 8.0.0.8 (clsid: 
BDEB0088-66F9-4A55-ABD2-0BF8DEEC1196); TeeChart2010.ocx 
Version 2010.0.0.3 (clsid: 
FCB4B50A-E3F1-4174-BD18-54C3B3287258). The controls are 
deployed under several SCADA based systems including: 
Unitronics OPC server v1.3; BACnet Operator Workstation 
Version 1.0.76


## Module Name
exploit/windows/browser/teechart_pro

## Authors
* mr_me <steventhomasseeley[at]gmail.com>
* sinn3r


## References
* http://www.osvdb.org/74446
* http://www.stratsec.net/Research/Advisories/TeeChart-Professional-Integer-Overflow



## Targets
* Automatic
* Windows XP SP0-SP3 (IE6/IE7)
* Windows XP SP0-SP3 + JAVA + DEP bypass (IE8)
* Windows 7 + JAVA + DEP bypass (IE8)


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/teechart_pro
msf exploit(teechart_pro) > show targets
   ... a list of targets ...
msf exploit(teechart_pro) > set TARGET <target-id>
msf exploit(teechart_pro) > show options
   ... show and set options ...
msf exploit(teechart_pro) > run
```
    
    