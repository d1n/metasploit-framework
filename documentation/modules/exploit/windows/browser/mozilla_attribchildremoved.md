## Firefox 8/9 AttributeChildRemoved() Use-After-Free

This module exploits a use-after-free vulnerability in 
Firefox 8/8.0.1 and 9/9.0.1. Removal of child nodes from the 
nsDOMAttribute can allow for a child to still be accessible 
after removal due to a premature notification of 
AttributeChildRemoved. Since mFirstChild is not set to NULL 
until after this call is made, this means the removed child 
will be accessible after it has been removed. By carefully 
manipulating the memory layout, this can lead to arbitrary 
code execution.


## Module Name
exploit/windows/browser/mozilla_attribchildremoved

## Authors
* regenrecht
* Lincoln <lincoln[at]corelan.be>
* corelanc0d3r <peter.ve[at]corelan.be>


## References
* http://cvedetails.com/cve/2011-3659/
* http://www.osvdb.org/78736
* http://www.zerodayinitiative.com/advisories/ZDI-12-110
* https://bugzilla.mozilla.org/show_bug.cgi?id=708198



## Targets
* Automatic
* Windows XP - Firefox 8 / 8.0.1
* Windows XP - Firefox 9
* Windows XP - Firefox 9.0.1


## Platforms
win

## Reliability
[Average](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/mozilla_attribchildremoved
msf exploit(mozilla_attribchildremoved) > show targets
   ... a list of targets ...
msf exploit(mozilla_attribchildremoved) > set TARGET <target-id>
msf exploit(mozilla_attribchildremoved) > show options
   ... show and set options ...
msf exploit(mozilla_attribchildremoved) > run
```
    
    