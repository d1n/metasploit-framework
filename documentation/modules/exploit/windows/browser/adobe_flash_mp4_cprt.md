## Adobe Flash Player MP4 'cprt' Overflow

This module exploits a vulnerability found in Adobe Flash 
Player. By supplying a corrupt .mp4 file loaded by Flash, it 
is possible to gain arbitrary remote code execution under 
the context of the user. This vulnerability has been 
exploited in the wild as part of the "Iran's Oil and Nuclear 
Situation.doc" e-mail attack. According to the advisory, 
10.3.183.15 and 11.x before 11.1.102.62 are affected.


## Module Name
exploit/windows/browser/adobe_flash_mp4_cprt

## Authors
* Alexander Gavrun
* sinn3r
* juan vazquez


## References
* http://cvedetails.com/cve/2012-0754/
* http://www.osvdb.org/79300
* http://www.securityfocus.com/bid/52034
* http://contagiodump.blogspot.com/2012/03/mar-2-cve-2012-0754-irans-oil-and.html
* http://www.adobe.com/support/security/bulletins/apsb12-03.html



## Targets
* Automatic
* IE 6 on Windows XP SP3
* IE 7 on Windows XP SP3
* IE 8 on Windows XP SP3 with msvcrt ROP
* IE 8 on Windows XP SP3 with JRE ROP
* IE 7 on Windows Vista
* IE 8 on Windows 7 SP1


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/adobe_flash_mp4_cprt
msf exploit(adobe_flash_mp4_cprt) > show targets
   ... a list of targets ...
msf exploit(adobe_flash_mp4_cprt) > set TARGET <target-id>
msf exploit(adobe_flash_mp4_cprt) > show options
   ... show and set options ...
msf exploit(adobe_flash_mp4_cprt) > run
```
    
    