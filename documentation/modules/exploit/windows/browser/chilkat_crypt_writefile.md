## Chilkat Crypt ActiveX WriteFile Unsafe Method

This module allows attackers to execute code via the 
'WriteFile' unsafe method of Chilkat Software Inc's Crypt 
ActiveX control. This exploit is based on shinnai's exploit 
that uses an hcp:// protocol URI to execute our payload 
immediately. However, this method requires that the victim 
user be browsing with Administrator. Additionally, this 
method will not work on newer versions of Windows. NOTE: 
This vulnerability is still unpatched. The latest version of 
Chilkat Crypt at the time of this writing includes 
ChilkatCrypt2.DLL version 4.4.4.0.


## Module Name
exploit/windows/browser/chilkat_crypt_writefile

## Authors
* shinnai
* jduck


## References
* http://cvedetails.com/cve/2008-5002/
* http://www.osvdb.org/49510
* http://www.securityfocus.com/bid/32073
* https://www.exploit-db.com/exploits/6963



## Targets
* Automatic


## Platforms
win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/chilkat_crypt_writefile
msf exploit(chilkat_crypt_writefile) > show targets
   ... a list of targets ...
msf exploit(chilkat_crypt_writefile) > set TARGET <target-id>
msf exploit(chilkat_crypt_writefile) > show options
   ... show and set options ...
msf exploit(chilkat_crypt_writefile) > run
```
    
    