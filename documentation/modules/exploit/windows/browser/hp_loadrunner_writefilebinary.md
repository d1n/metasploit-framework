## HP LoadRunner lrFileIOService ActiveX Remote Code Execution

This module exploits a vulnerability on the lrFileIOService 
ActiveX, as installed with HP LoadRunner 11.50. The 
vulnerability exists in the WriteFileBinary method where 
user provided data is used as a memory pointer. This module 
has been tested successfully on IE6-IE9 on Windows XP, Vista 
and 7, using the LrWebIERREWrapper.dll 11.50.2216.0. In 
order to bypass ASLR the no aslr compatible module 
msvcr71.dll is used. This one is installed with HP 
LoadRunner.


## Module Name
exploit/windows/browser/hp_loadrunner_writefilebinary

## Authors
* rgod <rgod[at]autistici.org>
* juan vazquez


## References
* http://cvedetails.com/cve/2013-2370/
* http://www.osvdb.org/95640
* http://www.securityfocus.com/bid/61441
* http://www.zerodayinitiative.com/advisories/ZDI-13-182
* https://h20566.www2.hp.com/portal/site/hpsc/public/kb/docDisplay/?docId=emr_na-c03862772



## Targets
* Automatic
* IE 7 on Windows XP SP3
* IE 8 on Windows XP SP3
* IE 7 on Windows Vista
* IE 8 on Windows Vista
* IE 8 on Windows 7
* IE 9 on Windows 7


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/hp_loadrunner_writefilebinary
msf exploit(hp_loadrunner_writefilebinary) > show targets
   ... a list of targets ...
msf exploit(hp_loadrunner_writefilebinary) > set TARGET <target-id>
msf exploit(hp_loadrunner_writefilebinary) > show options
   ... show and set options ...
msf exploit(hp_loadrunner_writefilebinary) > run
```
    
    