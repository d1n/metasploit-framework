## Microsoft Help Center XSS and Command Execution

Help and Support Center is the default application provided 
to access online documentation for Microsoft Windows. 
Microsoft supports accessing help documents directly via 
URLs by installing a protocol handler for the scheme "hcp". 
Due to an error in validation of input to hcp:// combined 
with a local cross site scripting vulnerability and a 
specialized mechanism to launch the XSS trigger, arbitrary 
command execution can be achieved. On IE7 on XP SP2 or SP3, 
code execution is automatic. If WMP9 is installed, it can be 
used to launch the exploit automatically. If IE8 and WMP11, 
either can be used to launch the attack, but both pop dialog 
boxes asking the user if execution should continue. This 
exploit detects if non-intrusive mechanisms are available 
and will use one if possible. In the case of both IE8 and 
WMP11, the exploit defaults to using an iframe on IE8, but 
is configurable by setting the DIALOGMECH option to "none" 
or "player". This module creates a WebDAV service from which 
the payload is copied to the victim machine.


## Module Name
exploit/windows/browser/ms10_042_helpctr_xss_cmd_exec

## Authors
* Tavis Ormandy
* natron


## References
* http://cvedetails.com/cve/2010-1885/
* http://www.osvdb.org/65264
* http://www.microsoft.com/technet/security/advisory/2219475.mspx
* http://technet.microsoft.com/en-us/security/bulletin/MS10-042



## Targets
* Automatic


## Platforms
win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/ms10_042_helpctr_xss_cmd_exec
msf exploit(ms10_042_helpctr_xss_cmd_exec) > show targets
   ... a list of targets ...
msf exploit(ms10_042_helpctr_xss_cmd_exec) > set TARGET <target-id>
msf exploit(ms10_042_helpctr_xss_cmd_exec) > show options
   ... show and set options ...
msf exploit(ms10_042_helpctr_xss_cmd_exec) > run
```
    
    