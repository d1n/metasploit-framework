## HP LoadRunner lrFileIOService ActiveX WriteFileString Remote Code Execution

This module exploits a vulnerability on the lrFileIOService 
ActiveX, as installed with HP LoadRunner 11.50. The 
vulnerability exists in the WriteFileString method, which 
allow the user to write arbitrary files. It's abused to drop 
a payload embedded in a dll, which is later loaded through 
the Init() method from the lrMdrvService control, by abusing 
an insecure LoadLibrary call. This module has been tested 
successfully on IE8 on Windows XP. Virtualization based on 
the Low Integrity Process, on Windows Vista and 7, will stop 
this module because the DLL will be dropped to a virtualized 
folder, which isn't used by LoadLibrary.


## Module Name
exploit/windows/browser/hp_loadrunner_writefilestring

## Authors
* Brian Gorenc
* juan vazquez


## References
* http://cvedetails.com/cve/2013-4798/
* http://www.osvdb.org/95642
* http://www.securityfocus.com/bid/61443
* http://www.zerodayinitiative.com/advisories/ZDI-13-207
* https://h20566.www2.hp.com/portal/site/hpsc/public/kb/docDisplay/?docId=emr_na-c03862772



## Targets
* Automatic IE on Windows XP


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/hp_loadrunner_writefilestring
msf exploit(hp_loadrunner_writefilestring) > show targets
   ... a list of targets ...
msf exploit(hp_loadrunner_writefilestring) > set TARGET <target-id>
msf exploit(hp_loadrunner_writefilestring) > show options
   ... show and set options ...
msf exploit(hp_loadrunner_writefilestring) > run
```
    
    