## Mozilla Firefox 3.6.16 mChannel Use-After-Free Vulnerability

This module exploits an use after free vulnerability in 
Mozilla Firefox 3.6.16. An OBJECT Element mChannel can be 
freed via the OnChannelRedirect method of the 
nsIChannelEventSink Interface. mChannel becomes a dangling 
pointer and can be reused when setting the OBJECTs data 
attribute. (Discovered by regenrecht). This module uses 
heapspray with a minimal ROP chain to bypass DEP on Windows 
XP SP3. Additionlay, a windows 7 target was provided using 
JAVA 6 and below to avoid aslr.


## Module Name
exploit/windows/browser/mozilla_mchannel

## Authors
* regenrecht
* Rh0
* mr_me <steventhomasseeley[at]gmail.com>


## References
* http://cvedetails.com/cve/2011-0065/
* http://www.osvdb.org/72085
* https://bugzilla.mozilla.org/show_bug.cgi?id=634986
* http://www.mozilla.org/security/announce/2011/mfsa2011-13.html



## Targets
* Automatic
* Firefox 3.6.16 on Windows XP SP3
* Firefox 3.6.16 on Windows 7 + Java


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/browser/mozilla_mchannel
msf exploit(mozilla_mchannel) > show targets
   ... a list of targets ...
msf exploit(mozilla_mchannel) > set TARGET <target-id>
msf exploit(mozilla_mchannel) > show options
   ... show and set options ...
msf exploit(mozilla_mchannel) > run
```
    
    