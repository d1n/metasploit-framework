## MS10-104 Microsoft Office SharePoint Server 2007 Remote Code Execution

This module exploits a vulnerability found in SharePoint 
Server 2007 SP2. The software contains a directory 
traversal, that allows a remote attacker to write arbitrary 
files to the filesystem, sending a specially crafted SOAP 
ConvertFile request to the Office Document Conversions 
Launcher Service, which results in code execution under the 
context of 'SYSTEM'. The module uses the Windows Management 
Instrumentation service to execute an arbitrary payload on 
vulnerable installations of SharePoint on Windows 2003 
Servers. It has been successfully tested on Office 
SharePoint Server 2007 SP2 over Windows 2003 SP2.


## Module Name
exploit/windows/misc/ms10_104_sharepoint

## Authors
* Oleksandr Mirosh
* James Burton
* juan vazquez


## References
* http://cvedetails.com/cve/2010-3964/
* http://www.osvdb.org/69817
* http://www.securityfocus.com/bid/45264
* http://technet.microsoft.com/en-us/security/bulletin/MS10-104
* http://www.zerodayinitiative.com/advisories/ZDI-10-287



## Targets
* Microsoft Office SharePoint Server 2007 SP2 / Microsoft Windows Server 2003 SP2


## Platforms
win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/misc/ms10_104_sharepoint
msf exploit(ms10_104_sharepoint) > show targets
   ... a list of targets ...
msf exploit(ms10_104_sharepoint) > set TARGET <target-id>
msf exploit(ms10_104_sharepoint) > show options
   ... show and set options ...
msf exploit(ms10_104_sharepoint) > run
```
    
    