## SAP NetWeaver Dispatcher DiagTraceR3Info Buffer Overflow

This module exploits a stack buffer overflow in the SAP 
NetWeaver Dispatcher service. The overflow occurs in the 
DiagTraceR3Info() function and allows a remote attacker to 
execute arbitrary code by supplying a special crafted Diag 
packet. The Dispatcher service is only vulnerable if the 
Developer Traces have been configured at levels 2 or 3. The 
module has been successfully tested on SAP Netweaver 7.0 
EHP2 SP6 over Windows XP SP3 and Windows 2003 SP2 (DEP 
bypass).


## Module Name
exploit/windows/misc/sap_netweaver_dispatcher

## Authors
* Martin Gallo
* juan vazquez


## References
* http://www.osvdb.org/81759
* http://cvedetails.com/cve/2012-2611/
* http://www.securityfocus.com/bid/53424
* https://www.exploit-db.com/exploits/20705
* http://www.coresecurity.com/content/sap-netweaver-dispatcher-multiple-vulnerabilities
* http://corelabs.coresecurity.com/index.php?module=Wiki&action=view&type=publication&name=Uncovering_SAP_vulnerabilities_reversing_and_breaking_the_Diag_protocol



## Targets
* SAP Netweaver 7.0 EHP2 SP6 / Windows XP SP3
* SAP Netweaver 7.0 EHP2 SP6 / Windows 2003 SP2


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/misc/sap_netweaver_dispatcher
msf exploit(sap_netweaver_dispatcher) > show targets
   ... a list of targets ...
msf exploit(sap_netweaver_dispatcher) > set TARGET <target-id>
msf exploit(sap_netweaver_dispatcher) > show options
   ... show and set options ...
msf exploit(sap_netweaver_dispatcher) > run
```
    
    