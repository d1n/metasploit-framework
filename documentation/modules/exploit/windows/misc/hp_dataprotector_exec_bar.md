## HP Data Protector Backup Client Service Remote Code Execution

This module abuses the Backup Client Service (OmniInet.exe) 
to achieve remote code execution. The vulnerability exists 
in the EXEC_BAR operation, which allows to execute arbitrary 
processes. This module has been tested successfully on HP 
Data Protector 6.20 on Windows 2003 SP2 and Windows 2008 R2.


## Module Name
exploit/windows/misc/hp_dataprotector_exec_bar

## Authors
* Aniway.Anyway <Aniway.Anyway[at]gmail.com>
* juan vazquez


## References
* http://cvedetails.com/cve/2013-2347/
* http://www.securityfocus.com/bid/64647
* http://www.zerodayinitiative.com/advisories/ZDI-14-008
* https://h20566.www2.hp.com/portal/site/hpsc/public/kb/docDisplay/?docId=emr_na-c03822422
* http://ddilabs.blogspot.com/2014/02/fun-with-hp-data-protector-execbar.html



## Targets
* HP Data Protector 6.20 build 370 / VBScript CMDStager
* HP Data Protector 6.20 build 370 / Powershell


## Platforms
win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/misc/hp_dataprotector_exec_bar
msf exploit(hp_dataprotector_exec_bar) > show targets
   ... a list of targets ...
msf exploit(hp_dataprotector_exec_bar) > set TARGET <target-id>
msf exploit(hp_dataprotector_exec_bar) > show options
   ... show and set options ...
msf exploit(hp_dataprotector_exec_bar) > run
```
    
    