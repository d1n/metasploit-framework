## HP Data Protector DtbClsLogin Buffer Overflow

This module exploits a stack buffer overflow in HP Data 
Protector 4.0 SP1. The overflow occurs during the login 
process, in the DtbClsLogin function provided by the 
dpwindtb.dll component, where the Utf8Cpy (strcpy like 
function) is used in an insecure way with the username. A 
successful exploitation will lead to code execution with the 
privileges of the "dpwinsdr.exe" (HP Data Protector Express 
Domain Server Service) process, which runs as SYSTEM by 
default.


## Module Name
exploit/windows/misc/hp_dataprotector_dtbclslogin

## Authors
* AbdulAziz Hariri
* juan vazquez


## References
* http://cvedetails.com/cve/2010-3007/
* http://www.osvdb.org/67973
* http://www.securityfocus.com/bid/43105
* http://www.zerodayinitiative.com/advisories/ZDI-10-174
* http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c02498535



## Targets
* HP Data Protector Express 4.0 SP1 (build 43064) / Windows XP SP3


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/misc/hp_dataprotector_dtbclslogin
msf exploit(hp_dataprotector_dtbclslogin) > show targets
   ... a list of targets ...
msf exploit(hp_dataprotector_dtbclslogin) > set TARGET <target-id>
msf exploit(hp_dataprotector_dtbclslogin) > show options
   ... show and set options ...
msf exploit(hp_dataprotector_dtbclslogin) > run
```
    
    