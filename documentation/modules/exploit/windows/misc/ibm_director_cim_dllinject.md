## IBM System Director Agent DLL Injection

This module abuses the "wmicimsv" service on IBM System 
Director Agent 5.20.3 to accomplish arbitrary DLL injection 
and execute arbitrary code with SYSTEM privileges. In order 
to accomplish remote DLL injection it uses a WebDAV service 
as disclosed by kingcope on December 2012. Because of this, 
the target host must have the WebClient service (WebDAV 
Mini-Redirector) enabled. It is enabled and automatically 
started by default on Windows XP SP3, but disabled by 
default on Windows 2003 SP2.


## Module Name
exploit/windows/misc/ibm_director_cim_dllinject

## Authors
* Bernhard Mueller
* kingcope
* juan vazquez


## References
* http://cvedetails.com/cve/2009-0880/
* http://www.osvdb.org/52616
* http://www.osvdb.org/88102
* http://www.securityfocus.com/bid/34065
* https://www.sec-consult.com/fxdata/seccons/prod/temedia/advisories_txt/20090305-2_IBM_director_privilege_escalation.txt
* http://seclists.org/bugtraq/2012/Dec/5



## Targets
* IBM System Director Agent 5.20.3 / Windows with WebClient enabled


## Platforms
win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/misc/ibm_director_cim_dllinject
msf exploit(ibm_director_cim_dllinject) > show targets
   ... a list of targets ...
msf exploit(ibm_director_cim_dllinject) > set TARGET <target-id>
msf exploit(ibm_director_cim_dllinject) > show options
   ... show and set options ...
msf exploit(ibm_director_cim_dllinject) > run
```
    
    