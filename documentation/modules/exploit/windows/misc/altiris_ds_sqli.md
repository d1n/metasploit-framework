## Symantec Altiris DS SQL Injection

This module exploits a SQL injection flaw in Symantec 
Altiris Deployment Solution 6.8 to 6.9.164. The 
vulnerability exists on axengine.exe which fails to 
adequately sanitize numeric input fields in "UpdateComputer" 
notification Requests. In order to spawn a shell, several 
SQL injections are required in close succession, first to 
enable xp_cmdshell, then retrieve the payload via TFTP and 
finally execute it. The module also has the capability to 
disable or enable local application authentication. In order 
to work the target system must have a tftp client available.


## Module Name
exploit/windows/misc/altiris_ds_sqli

## Authors
* Brett Moore
* 3v0lver


## References
* http://cvedetails.com/cve/2008-2286/
* http://www.osvdb.org/45313
* http://www.securityfocus.com/bid/29198
* http://www.zerodayinitiative.com/advisories/ZDI-08-024



## Targets
* Windows 2003 (with tftp client available)


## Platforms
win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/misc/altiris_ds_sqli
msf exploit(altiris_ds_sqli) > show targets
   ... a list of targets ...
msf exploit(altiris_ds_sqli) > set TARGET <target-id>
msf exploit(altiris_ds_sqli) > show options
   ... show and set options ...
msf exploit(altiris_ds_sqli) > run
```
    
    