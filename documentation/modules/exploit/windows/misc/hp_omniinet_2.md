## HP OmniInet.exe MSG_PROTOCOL Buffer Overflow

This module exploits a stack-based buffer overflow in the 
Hewlett-Packard OmniInet NT Service. By sending a specially 
crafted MSG_PROTOCOL (0x010b) packet, a remote attacker may 
be able to execute arbitrary code with elevated privileges. 
This service is installed with HP OpenView Data Protector, 
HP Application Recovery Manager and potentially other 
products. This exploit has been tested against versions 6.1, 
6.0, and 5.50 of Data Protector. and versions 6.0 and 6.1 of 
Application Recovery Manager. NOTE: There are actually two 
consecutive wcscpy() calls in the program (which may be why 
ZDI considered them two separate issues). However, this 
module only exploits the second one.


## Module Name
exploit/windows/misc/hp_omniinet_2

## Authors
* EgiX <n0b0d13s[at]gmail.com>
* Fairuzan Roslan <riaf[at]mysec.org>
* jduck


## References
* http://cvedetails.com/cve/2009-3844/
* http://www.securityfocus.com/bid/37250
* http://www.osvdb.org/60852
* http://www.zerodayinitiative.com/advisories/ZDI-09-091



## Targets
* Automatic Targeting
* HP OpenView Storage Data Protector A.05.50: INET, internal build 330
* HP OpenView Storage Data Protector A.06.00: INET, internal build 331
* HP StorageWorks Application Recovery Manager A.06.00: INET, internal build 81
* HP Application Recovery Manager software A.06.10: INET, internal build 282


## Platforms
win

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/misc/hp_omniinet_2
msf exploit(hp_omniinet_2) > show targets
   ... a list of targets ...
msf exploit(hp_omniinet_2) > set TARGET <target-id>
msf exploit(hp_omniinet_2) > show options
   ... show and set options ...
msf exploit(hp_omniinet_2) > run
```
    
    