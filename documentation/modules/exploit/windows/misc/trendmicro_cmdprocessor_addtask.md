## TrendMicro Control Manger CmdProcessor.exe Stack Buffer Overflow

This module exploits a vulnerability in the CmdProcessor.exe 
component of Trend Micro Control Manger up to version 5.5. 
The specific flaw exists within CmdProcessor.exe service 
running on TCP port 20101. The vulnerable function is the 
CGenericScheduler::AddTask function of 
cmdHandlerRedAlertController.dll. When processing a 
specially crafted IPC packet, controlled data is copied into 
a 256-byte stack buffer. This can be exploited to execute 
remote code under the context of the user.


## Module Name
exploit/windows/misc/trendmicro_cmdprocessor_addtask

## Authors
* Luigi Auriemma
* Blue


## References
* http://cvedetails.com/cve/2011-5001/
* http://www.osvdb.org/77585
* http://www.zerodayinitiative.com/advisories/ZDI-11-345



## Targets
* Windows 2003 Server SP2 (DEP Bypass)


## Platforms
win

## Reliability
[Good](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/misc/trendmicro_cmdprocessor_addtask
msf exploit(trendmicro_cmdprocessor_addtask) > show targets
   ... a list of targets ...
msf exploit(trendmicro_cmdprocessor_addtask) > set TARGET <target-id>
msf exploit(trendmicro_cmdprocessor_addtask) > show options
   ... show and set options ...
msf exploit(trendmicro_cmdprocessor_addtask) > run
```
    
    