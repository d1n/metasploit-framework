## ManageEngine EventLog Analyzer Remote Code Execution

This module exploits a SQL query functionality in 
ManageEngine EventLog Analyzer v10.6 build 10060 and 
previous versions. Every authenticated user, including the 
default "guest" account can execute SQL queries directly on 
the underlying Postgres database server. The queries are 
executed as the "postgres" user which has full privileges 
and thus is able to write files to disk. This way a JSP 
payload can be uploaded and executed with SYSTEM privileges 
on the web server. This module has been tested successfully 
on ManageEngine EventLog Analyzer 10.0 (build 10003) over 
Windows 7 SP1.


## Module Name
exploit/windows/misc/manageengine_eventlog_analyzer_rce

## Authors
* xistence <xistence[at]0x90.nl>


## References
* https://www.exploit-db.com/exploits/38173
* http://cvedetails.com/cve/2015-7387/
* http://seclists.org/fulldisclosure/2015/Sep/59



## Targets
* ManageEngine EventLog Analyzer 10.0 (build 10003) / Windows 7 SP1


## Platforms
* win

## Reliability
[Manual](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/misc/manageengine_eventlog_analyzer_rce
msf exploit(manageengine_eventlog_analyzer_rce) > show targets
   ... a list of targets ...
msf exploit(manageengine_eventlog_analyzer_rce) > set TARGET <target-id>
msf exploit(manageengine_eventlog_analyzer_rce) > show options
   ... show and set options ...
msf exploit(manageengine_eventlog_analyzer_rce) > run
```
    
    