## HP OmniInet.exe Opcode 20 Buffer Overflow

This module exploits a vulnerability found in HP Data 
Protector's OmniInet process. By supplying a long string of 
data as the file path with opcode '20', a buffer overflow 
can occur when this data is being written on the stack where 
no proper bounds checking is done beforehand, which results 
arbitrary code execution under the context of SYSTEM. This 
module is also made against systems such as Windows Server 
2003 or Windows Server 2008 that have DEP and/or ASLR 
enabled by default.


## Module Name
exploit/windows/misc/hp_omniinet_4

## Authors
* Oren Isacson
* muts
* dookie
* sinn3r
* corelanc0d3r <peter.ve[at]corelan.be>


## References
* http://cvedetails.com/cve/2011-1865/
* http://www.osvdb.org/73571
* https://www.exploit-db.com/exploits/17468
* http://www.coresecurity.com/content/HP-Data-Protector-multiple-vulnerabilities
* http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c02872182



## Targets
* HP Data Protector A.06.10 b611 / A.06.11 b243 XP SP3/Win2003/Win2008


## Platforms
win

## Reliability
[Good](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/misc/hp_omniinet_4
msf exploit(hp_omniinet_4) > show targets
   ... a list of targets ...
msf exploit(hp_omniinet_4) > set TARGET <target-id>
msf exploit(hp_omniinet_4) > show options
   ... show and set options ...
msf exploit(hp_omniinet_4) > run
```
    
    