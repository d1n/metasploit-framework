## Apple iTunes 10 Extended M3U Stack Buffer Overflow

This module exploits a stack buffer overflow in iTunes 
10.4.0.80 to 10.6.1.7. When opening an extended .m3u file 
containing an "#EXTINF:" tag description, iTunes will copy 
the content after "#EXTINF:" without appropriate checking 
from a heap buffer to a stack buffer, writing beyond the 
stack buffer's boundary, which allows code execution under 
the context of the user. Please note before using this 
exploit, you must have precise knowledge of the victim 
machine's QuickTime version (if installed), and then select 
your target accordingly. In addition, even though this 
exploit can be used as remote, you should be aware the 
victim's browser behavior when opening an itms link. For 
example, IE/Firefox/Opera by default will ask the user for 
permission before launching the itms link by iTunes. Chrome 
will ask for permission, but also spits a warning. Safari 
would be an ideal target, because it will open the link 
without any user interaction.


## Module Name
exploit/windows/misc/itunes_extm3u_bof

## Authors
* Rh0 <rh0[at]z1p.biz>
* sinn3r


## References
* http://www.osvdb.org/83220
* https://www.exploit-db.com/exploits/19322
* http://pastehtml.com/view/c25uhk4ab.html



## Targets
* iTunes 10.4.0.80 to 10.6.1.7 with QuickTime 7.69 on XP SP3
* iTunes 10.4.0.80 to 10.6.1.7 with QuickTime 7.70 on XP SP3
* iTunes 10.4.0.80 to 10.6.1.7 with QuickTime 7.71 on XP SP3
* iTunes 10.4.0.80 to 10.6.1.7 with QuickTime 7.72 on XP SP3


## Platforms
* win

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/misc/itunes_extm3u_bof
msf exploit(itunes_extm3u_bof) > show targets
   ... a list of targets ...
msf exploit(itunes_extm3u_bof) > set TARGET <target-id>
msf exploit(itunes_extm3u_bof) > show options
   ... show and set options ...
msf exploit(itunes_extm3u_bof) > run
```
    
    