## EasyFTP Server CWD Command Stack Buffer Overflow

This module exploits a stack-based buffer overflow in 
EasyFTP Server 1.7.0.11 and earlier. EasyFTP fails to check 
input size when parsing 'CWD' commands, which leads to a 
stack based buffer overflow. EasyFTP allows anonymous access 
by default; valid credentials are typically unnecessary to 
exploit this vulnerability. After version 1.7.0.12, this 
package was renamed "UplusFtp". This exploit utilizes a 
small piece of code that I\'ve referred to as 'fixRet'. This 
code allows us to inject of payload of ~500 bytes into a 264 
byte buffer by 'fixing' the return address 
post-exploitation. See references for more information.


## Module Name
exploit/windows/ftp/easyftp_cwd_fixret

## Authors
* Paul Makowski <my.hndl[at]gmail.com>
* jduck


## References
* http://www.osvdb.org/62134
* http://www.securityfocus.com/bid/38262
* http://paulmakowski.wordpress.com/2010/02/28/increasing-payload-size-w-return-address-overwrite/
* http://paulmakowski.wordpress.com/2010/04/19/metasploit-plugin-for-easyftp-server-exploit
* http://seclists.org/bugtraq/2010/Feb/202



## Targets
* Windows Universal - v1.7.0.2
* Windows Universal - v1.7.0.3
* Windows Universal - v1.7.0.4
* Windows Universal - v1.7.0.5
* Windows Universal - v1.7.0.6
* Windows Universal - v1.7.0.7
* Windows Universal - v1.7.0.8
* Windows Universal - v1.7.0.9
* Windows Universal - v1.7.0.10
* Windows Universal - v1.7.0.11


## Platforms
win

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/ftp/easyftp_cwd_fixret
msf exploit(easyftp_cwd_fixret) > show targets
   ... a list of targets ...
msf exploit(easyftp_cwd_fixret) > set TARGET <target-id>
msf exploit(easyftp_cwd_fixret) > show options
   ... show and set options ...
msf exploit(easyftp_cwd_fixret) > run
```
    
    