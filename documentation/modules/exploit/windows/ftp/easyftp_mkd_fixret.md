## EasyFTP Server MKD Command Stack Buffer Overflow

This module exploits a stack-based buffer overflow in 
EasyFTP Server 1.7.0.11 and earlier. EasyFTP fails to check 
input size when parsing 'MKD' commands, which leads to a 
stack based buffer overflow. NOTE: EasyFTP allows anonymous 
access by default. However, in order to access the 'MKD' 
command, you must have access to an account that can create 
directories. After version 1.7.0.12, this package was 
renamed "UplusFtp". This exploit utilizes a small piece of 
code that I\'ve referred to as 'fixRet'. This code allows us 
to inject of payload of ~500 bytes into a 264 byte buffer by 
'fixing' the return address post-exploitation. See 
references for more information.


## Module Name
exploit/windows/ftp/easyftp_mkd_fixret

## Authors
* x90c <geinblues[at]gmail.com>
* jduck


## References
* http://www.osvdb.org/62134
* https://www.exploit-db.com/exploits/12044
* https://www.exploit-db.com/exploits/14399



## Targets
* Windows Universal - v1.7.0.2
* Windows Universal - v1.7.0.3
* Windows Universal - v1.7.0.4
* Windows Universal - v1.7.0.5
* Windows Universal - v1.7.0.6
* Windows Universal - v1.7.0.7
* Windows Universal - v1.7.0.8
* Windows Universal - v1.7.0.9
* Windows Universal - v1.7.0.10
* Windows Universal - v1.7.0.11


## Platforms
win

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/ftp/easyftp_mkd_fixret
msf exploit(easyftp_mkd_fixret) > show targets
   ... a list of targets ...
msf exploit(easyftp_mkd_fixret) > set TARGET <target-id>
msf exploit(easyftp_mkd_fixret) > show options
   ... show and set options ...
msf exploit(easyftp_mkd_fixret) > run
```
    
    