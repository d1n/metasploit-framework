## ComSndFTP v1.3.7 Beta USER Format String (Write4) Vulnerability

This module exploits the ComSndFTP FTP Server version 1.3.7 
beta by sending a specially crafted format string specifier 
as a username. The crafted username is sent to to the server 
to overwrite the hardcoded function pointer from 
Ws2_32.dll!WSACleanup. Once this function pointer is 
triggered, the code bypasses dep and then repairs the 
pointer to execute arbitrary code. The SEH exit function is 
preferred so that the administrators are not left with an 
unhandled exception message. When using the meterpreter 
payload, the process will never die, allowing for continuous 
exploitation.


## Module Name
exploit/windows/ftp/comsnd_ftpd_fmtstr

## Authors
* ChaoYi Huang <ChaoYi.Huang[at]connect.polyu.hk>
* rick2600 <rick2600[at]corelan.be>
* mr_me <mr_me[at]corelan.be>
* corelanc0d3r <peter.ve[at]corelan.be>


## References
* http://www.osvdb.org/82798
* https://www.exploit-db.com/exploits/19024



## Targets
* Windows XP SP3 - English
* Windows Server 2003 - English


## Platforms
* win

## Reliability
[Good](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/ftp/comsnd_ftpd_fmtstr
msf exploit(comsnd_ftpd_fmtstr) > show targets
   ... a list of targets ...
msf exploit(comsnd_ftpd_fmtstr) > set TARGET <target-id>
msf exploit(comsnd_ftpd_fmtstr) > show options
   ... show and set options ...
msf exploit(comsnd_ftpd_fmtstr) > run
```
    
    