## ISS PAM.dll ICQ Parser Buffer Overflow

This module exploits a stack buffer overflow in the ISS 
products that use the iss-pam1.dll ICQ parser 
(Blackice/RealSecure). Successful exploitation will result 
in arbitrary code execution as LocalSystem. This exploit 
only requires 1 UDP packet, which can be both spoofed and 
sent to a broadcast address. The ISS exception handler will 
recover the process after each overflow, giving us the 
ability to bruteforce the service and exploit it multiple 
times.


## Module Name
exploit/windows/firewall/blackice_pam_icq

## Authors
spoonm


## References
* http://cvedetails.com/cve/2004-0362/
* http://www.osvdb.org/4355
* http://www.eeye.com/html/Research/Advisories/AD20040318.html



## Targets
* Bruteforce
* Bruteforce iis-pam1.dll
* Bruteforce NT 4.0
* iis-pam1.dll 3.6.06
* iis-pam1.dll 3.6.11
* WinNT SP3/SP4/SP5
* WinNT SP4/SP5
* WinNT SP5/SP6 - advapi32
* WinNT SP3/SP5/SP6 - shell32
* WinNT SP5/SP6 - mswsock
* WinXP SP0/SP1 - shell32
* WinXP SP0/SP1 - atl
* WinXP SP0/SP1 - atl
* WinXP SP0/SP1 - ws2_32
* WinXP SP0/SP1 - mswsock
* Windows 2000 Pro SP4 English
* Win2000 SP0 - SP4
* Win2000 SP2/SP3 - samlib
* Win2000 SP0/SP1 - activeds
* Windows XP Pro SP0 English
* Windows XP Pro SP1 English
* WinXP SP0 - SP1
* Win2003 SP0


## Platforms
win

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/firewall/blackice_pam_icq
msf exploit(blackice_pam_icq) > show targets
   ... a list of targets ...
msf exploit(blackice_pam_icq) > set TARGET <target-id>
msf exploit(blackice_pam_icq) > show options
   ... show and set options ...
msf exploit(blackice_pam_icq) > run
```
    
    