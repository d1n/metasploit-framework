## Symantec Endpoint Protection Manager /servlet/ConsoleServlet Remote Command Execution

This module exploits XXE and SQL injection flaws in Symantec 
Endpoint Protection Manager versions 11.0, 12.0 and 12.1. 
When supplying a specially crafted XML external entity (XXE) 
request an attacker can reach SQL injection affected 
components. As xp_cmdshell is enabled in the included 
database instance, it's possible to execute arbitrary system 
commands on the target with SYSTEM privileges.


## Module Name
exploit/windows/antivirus/symantec_endpoint_manager_rce

## Authors
* Stefan Viehbock
* Chris Graham
* xistence <xistence[at]0x90.nl>


## References
* http://cvedetails.com/cve/2013-5014/
* http://cvedetails.com/cve/2013-5015/
* http://www.osvdb.org/103305
* http://www.osvdb.org/103306
* https://www.exploit-db.com/exploits/31853
* https://www.sec-consult.com/fxdata/seccons/prod/temedia/advisories_txt/20140218-0_Symantec_Endpoint_Protection_Multiple_critical_vulnerabilities_wo_poc_v10.txt



## Targets
* Windows VBS Stager


## Platforms
win

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/windows/antivirus/symantec_endpoint_manager_rce
msf exploit(symantec_endpoint_manager_rce) > show targets
   ... a list of targets ...
msf exploit(symantec_endpoint_manager_rce) > set TARGET <target-id>
msf exploit(symantec_endpoint_manager_rce) > show options
   ... show and set options ...
msf exploit(symantec_endpoint_manager_rce) > run
```
    
    