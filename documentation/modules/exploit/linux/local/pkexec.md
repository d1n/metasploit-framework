## Linux PolicyKit Race Condition Privilege Escalation

A race condition flaw was found in the PolicyKit pkexec 
utility and polkitd daemon. A local user could use this flaw 
to appear as a privileged user to pkexec, allowing them to 
execute arbitrary commands as root by running those commands 
with pkexec. Those vulnerable include RHEL6 prior to 
polkit-0.96-2.el6_0.1 and Ubuntu libpolkit-backend-1 prior 
to 0.96-2ubuntu1.1 (10.10) 0.96-2ubuntu0.1 (10.04 LTS) and 
0.94-1ubuntu1.1 (9.10)


## Module Name
exploit/linux/local/pkexec

## Authors
* xi4oyu
* 0a29406d9794e4f9b30b3c5d6702c708


## References
* http://cvedetails.com/cve/2011-1485/
* https://www.exploit-db.com/exploits/17942
* http://www.osvdb.org/72261



## Targets
* Linux x86
* Linux x64


## Platforms
* linux

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/linux/local/pkexec
msf exploit(pkexec) > show targets
   ... a list of targets ...
msf exploit(pkexec) > set TARGET <target-id>
msf exploit(pkexec) > show options
   ... show and set options ...
msf exploit(pkexec) > run
```
    
    