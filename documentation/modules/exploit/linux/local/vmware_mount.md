## VMWare Setuid vmware-mount Unsafe popen(3)

VMWare Workstation (up to and including 9.0.2 build-1031769) 
and Player have a setuid executable called vmware-mount that 
invokes lsb_release in the PATH with popen(3). Since PATH is 
user-controlled, and the default system shell on 
Debian-derived distributions does not drop privs, we can put 
an arbitrary payload in an executable called lsb_release and 
have vmware-mount happily execute it as root for us.


## Module Name
exploit/linux/local/vmware_mount

## Authors
* Tavis Ormandy
* egypt


## References
* http://cvedetails.com/cve/2013-1662/
* http://www.osvdb.org/96588
* http://www.securityfocus.com/bid/61966
* http://blog.cmpxchg8b.com/2013/08/security-debianisms.html
* http://www.vmware.com/support/support-resources/advisories/VMSA-2013-0010.html
* https://community.rapid7.com/community/metasploit/blog/2013/09/05/cve-2013-1662-vmware-mount-exploit



## Targets
* Automatic


## Platforms
* linux

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/linux/local/vmware_mount
msf exploit(vmware_mount) > show targets
   ... a list of targets ...
msf exploit(vmware_mount) > set TARGET <target-id>
msf exploit(vmware_mount) > show options
   ... show and set options ...
msf exploit(vmware_mount) > run
```
    
    