## Sophos Web Protection Appliance clear_keys.pl Local Privilege Escalation

This module abuses a command injection on the clear_keys.pl 
perl script, installed with the Sophos Web Protection 
Appliance, to escalate privileges from the "spiderman" user 
to "root". This module is useful for post exploitation of 
vulnerabilities on the Sophos Web Protection Appliance web 
ui, executed by the "spiderman" user. This module has been 
tested successfully on Sophos Virtual Web Appliance 3.7.0.


## Module Name
exploit/linux/local/sophos_wpa_clear_keys

## Authors
* Francisco Falcon
* juan vazquez


## References
* http://cvedetails.com/cve/2013-4984/
* http://www.osvdb.org/97028
* http://www.securityfocus.com/bid/62265
* http://www.coresecurity.com/advisories/sophos-web-protection-appliance-multiple-vulnerabilities



## Targets
* Linux x86


## Platforms
* linux

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/linux/local/sophos_wpa_clear_keys
msf exploit(sophos_wpa_clear_keys) > show targets
   ... a list of targets ...
msf exploit(sophos_wpa_clear_keys) > set TARGET <target-id>
msf exploit(sophos_wpa_clear_keys) > show options
   ... show and set options ...
msf exploit(sophos_wpa_clear_keys) > run
```
    
    