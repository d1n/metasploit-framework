## Linux Kernel Sendpage Local Privilege Escalation

The Linux kernel failed to properly initialize some entries 
the proto_ops struct for several protocols, leading to NULL 
being derefenced and used as a function pointer. By using 
mmap(2) to map page 0, an attacker can execute arbitrary 
code in the context of the kernel. Several public exploits 
exist for this vulnerability, including spender's 
wunderbar_emporium and rcvalle's ppc port, sock_sendpage.c. 
All Linux 2.4/2.6 versions since May 2001 are believed to be 
affected: 2.4.4 up to and including 2.4.37.4; 2.6.0 up to 
and including 2.6.30.4


## Module Name
exploit/linux/local/sock_sendpage

## Authors
* Tavis Ormandy
* Julien Tinnes <julien at cr0.org>
* spender
* rcvalle
* egypt


## References
* http://cvedetails.com/cve/2009-2692/
* http://www.osvdb.org/56992
* http://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html



## Targets
* Linux x86


## Platforms
* linux

## Reliability
[Great](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/linux/local/sock_sendpage
msf exploit(sock_sendpage) > show targets
   ... a list of targets ...
msf exploit(sock_sendpage) > set TARGET <target-id>
msf exploit(sock_sendpage) > show options
   ... show and set options ...
msf exploit(sock_sendpage) > run
```
    
    