## Red Hat CloudForms Management Engine 5.1 agent/linuxpkgs Path Traversal

This module exploits a path traversal vulnerability in the 
"linuxpkgs" action of "agent" controller of the Red Hat 
CloudForms Management Engine 5.1 (ManageIQ Enterprise 
Virtualization Manager 5.0 and earlier). It uploads a fake 
controller to the controllers directory of the Rails 
application with the encoded payload as an action and sends 
a request to this action to execute the payload. Optionally, 
it can also upload a routing file containing a route to the 
action. (Which is not necessary, since the application 
already contains a general default route.)


## Module Name
exploit/linux/http/cfme_manageiq_evm_upload_exec

## Authors
Ramon de C Valle


## References
* http://cvedetails.com/cve/2013-2068/
* https://cwe.mitre.org/data/definitions/22.html
* https://bugzilla.redhat.com/show_bug.cgi?id=960422



## Targets
* Automatic


## Platforms
ruby

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/linux/http/cfme_manageiq_evm_upload_exec
msf exploit(cfme_manageiq_evm_upload_exec) > show targets
   ... a list of targets ...
msf exploit(cfme_manageiq_evm_upload_exec) > set TARGET <target-id>
msf exploit(cfme_manageiq_evm_upload_exec) > show options
   ... show and set options ...
msf exploit(cfme_manageiq_evm_upload_exec) > run
```
    
    