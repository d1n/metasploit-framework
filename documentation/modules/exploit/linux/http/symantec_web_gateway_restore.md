## Symantec Web Gateway 5 restore.php Post Authentication Command Injection

This module exploits a command injection vulnerability found 
in Symantec Web Gateway's setting restoration feature. The 
filename portion can be used to inject system commands into 
a syscall function, and gain control under the context of 
HTTP service. For Symantec Web Gateway 5.1.1, you can 
exploit this vulnerability by any kind of user. However, for 
version 5.2.1, you must be an administrator.


## Module Name
exploit/linux/http/symantec_web_gateway_restore

## Authors
* Egidio Romano
* sinn3r


## References
* http://cvedetails.com/cve/2014-7285/
* http://www.osvdb.org/116009
* http://www.securityfocus.com/bid/71620
* http://karmainsecurity.com/KIS-2014-19
* http://www.symantec.com/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&year=&suid=20141216_00



## Targets
* Symantec Web Gateway 5


## Platforms
* unix

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/linux/http/symantec_web_gateway_restore
msf exploit(symantec_web_gateway_restore) > show targets
   ... a list of targets ...
msf exploit(symantec_web_gateway_restore) > set TARGET <target-id>
msf exploit(symantec_web_gateway_restore) > show options
   ... show and set options ...
msf exploit(symantec_web_gateway_restore) > run
```
    
    