## Sophos Web Protection Appliance Interface Authenticated Arbitrary Command Execution

This module takes advantage of two vulnerabilities in order 
to gain remote code execution as root as an otherwise 
non-privileged authorized user. By taking advantage of a 
mass assignment vulnerability that allows an unprivileged 
authenticated user to change the admininistrator's password 
hash, the module updates the password to login as the admin 
to reach the second vulnerability. No server-side 
sanitization is done on values passed when configuring a 
static network interface. This allows an administrator user 
to run arbitrary commands in the context of the web 
application, which is root when configuring the network 
interface. This module will inadvertently delete any other 
users that may have been present as a side effect of 
changing the admin's password.


## Module Name
exploit/linux/http/sophos_wpa_iface_exec

## Authors
* Brandon Perry <bperry.volatile[at]gmail.com>


## References
* http://www.zerodayinitiative.com/advisories/ZDI-14-069/



## Targets
* Sophos Web Protection Appliance 3.8.1.1


## Platforms
* unix

## Reliability
[Excellent](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/linux/http/sophos_wpa_iface_exec
msf exploit(sophos_wpa_iface_exec) > show targets
   ... a list of targets ...
msf exploit(sophos_wpa_iface_exec) > set TARGET <target-id>
msf exploit(sophos_wpa_iface_exec) > show options
   ... show and set options ...
msf exploit(sophos_wpa_iface_exec) > run
```
    
    