## Seagate Business NAS Unauthenticated Remote Command Execution

Some Seagate Business NAS devices are vulnerable to command 
execution via a local file include vulnerability hidden in 
the language parameter of the CodeIgniter session cookie. 
The vulnerability manifests in the way the language files 
are included in the code on the login page, and hence is 
open to attack from users without the need for 
authentication. The cookie can be easily decrypted using a 
known static encryption key and re-encrypted once the PHP 
object string has been modified. This module has been tested 
on the STBN300 device.


## Module Name
exploit/linux/http/seagate_nas_php_exec_noauth

## Authors
* OJ Reeves <oj[at]beyondbinary.io>


## References
* http://cvedetails.com/cve/2014-8684/
* http://cvedetails.com/cve/2014-8686/
* http://cvedetails.com/cve/2014-8687/
* https://www.exploit-db.com/exploits/36202
* http://www.seagate.com/au/en/support/external-hard-drives/network-storage/business-storage-2-bay-nas/
* https://beyondbinary.io/advisory/seagate-nas-rce/



## Targets
* Automatic


## Platforms
php

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/linux/http/seagate_nas_php_exec_noauth
msf exploit(seagate_nas_php_exec_noauth) > show targets
   ... a list of targets ...
msf exploit(seagate_nas_php_exec_noauth) > set TARGET <target-id>
msf exploit(seagate_nas_php_exec_noauth) > show options
   ... show and set options ...
msf exploit(seagate_nas_php_exec_noauth) > run
```
    
    