## D-Link Devices HNAP SOAPAction-Header Command Execution

Different D-Link Routers are vulnerable to OS command 
injection in the HNAP SOAP interface. Since it is a blind OS 
command injection vulnerability, there is no output for the 
executed command. This module has been tested on a DIR-645 
device. The following devices are also reported as affected: 
DAP-1522 revB, DAP-1650 revB, DIR-880L, DIR-865L, DIR-860L 
revA, DIR-860L revB DIR-815 revB, DIR-300 revB, DIR-600 
revB, DIR-645, TEW-751DR, TEW-733GR


## Module Name
exploit/linux/http/dlink_hnap_header_exec_noauth

## Authors
* Samuel Huntley
* Craig Heffner
* Michael Messner <devnull[at]s3cur1ty.de>


## References
* http://securityadvisories.dlink.com/security/publication.aspx?name=SAP10051
* http://www.devttys0.com/2015/04/hacking-the-d-link-dir-890l/



## Targets
* MIPS Little Endian
* MIPS Big Endian


## Platforms
linux

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/linux/http/dlink_hnap_header_exec_noauth
msf exploit(dlink_hnap_header_exec_noauth) > show targets
   ... a list of targets ...
msf exploit(dlink_hnap_header_exec_noauth) > set TARGET <target-id>
msf exploit(dlink_hnap_header_exec_noauth) > show options
   ... show and set options ...
msf exploit(dlink_hnap_header_exec_noauth) > run
```
    
    