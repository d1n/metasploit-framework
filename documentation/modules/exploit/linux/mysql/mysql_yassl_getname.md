## MySQL yaSSL CertDecoder::GetName Buffer Overflow

This module exploits a stack buffer overflow in the yaSSL 
(1.9.8 and earlier) implementation bundled with MySQL. By 
sending a specially crafted client certificate, an attacker 
can execute arbitrary code. This vulnerability is present 
within the CertDecoder::GetName function inside 
"taocrypt/src/asn.cpp". However, the stack buffer that is 
written to exists within a parent function's stack frame. 
NOTE: This vulnerability requires a non-default 
configuration. First, the attacker must be able to pass the 
host-based authentication. Next, the server must be 
configured to listen on an accessible network interface. 
Lastly, the server must have been manually configured to use 
SSL. The binary from version 5.5.0-m2 was built with /GS and 
/SafeSEH. During testing on Windows XP SP3, these 
protections successfully prevented exploitation. Testing was 
also done with mysql on Ubuntu 9.04. Although the vulnerable 
code is present, both version 5.5.0-m2 built from source and 
version 5.0.75 from a binary package were not exploitable 
due to the use of the compiler's FORTIFY feature. Although 
suse11 was mentioned in the original blog post, the binary 
package they provide does not contain yaSSL or support SSL.


## Module Name
exploit/linux/mysql/mysql_yassl_getname

## Authors
* jduck


## References
* http://cvedetails.com/cve/2009-4484/
* http://www.securityfocus.com/bid/37640
* http://www.securityfocus.com/bid/37943
* http://www.securityfocus.com/bid/37974
* http://www.osvdb.org/61956
* http://secunia.com/advisories/38344/



## Targets
* Automatic
* Debian 5.0 - MySQL (5.0.51a-24+lenny2)


## Platforms
linux

## Reliability
[Good](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/linux/mysql/mysql_yassl_getname
msf exploit(mysql_yassl_getname) > show targets
   ... a list of targets ...
msf exploit(mysql_yassl_getname) > set TARGET <target-id>
msf exploit(mysql_yassl_getname) > show options
   ... show and set options ...
msf exploit(mysql_yassl_getname) > run
```
    
    