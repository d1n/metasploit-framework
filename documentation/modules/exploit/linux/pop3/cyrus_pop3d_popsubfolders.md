## Cyrus IMAPD pop3d popsubfolders USER Buffer Overflow

This exploit takes advantage of a stack based overflow. Once 
the stack corruption has occured it is possible to overwrite 
a pointer which is later used for a memcpy. This gives us a 
write anything anywhere condition similar to a format string 
vulnerability. NOTE: The popsubfolders option is a 
non-default setting. I chose to overwrite the GOT with my 
shellcode and return to it. This defeats the VA random patch 
and possibly other stack protection features. Tested on 
gentoo-sources Linux 2.6.16. Although Fedora CORE 5 ships 
with a version containing the vulnerable code, it is not 
exploitable due to the use of the FORTIFY_SOURCE compiler 
enhancement


## Module Name
exploit/linux/pop3/cyrus_pop3d_popsubfolders

## Authors
* bannedit
* jduck


## References
* http://cvedetails.com/cve/2006-2502/
* http://www.osvdb.org/25853
* http://www.securityfocus.com/bid/18056
* https://www.exploit-db.com/exploits/2053
* https://www.exploit-db.com/exploits/2185
* http://archives.neohapsis.com/archives/fulldisclosure/2006-05/0527.html



## Targets
* Gentoo 2006.0 Linux 2.6


## Platforms
linux

## Reliability
[Normal](https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking)

## Demo

```
msf > use exploit/linux/pop3/cyrus_pop3d_popsubfolders
msf exploit(cyrus_pop3d_popsubfolders) > show targets
   ... a list of targets ...
msf exploit(cyrus_pop3d_popsubfolders) > set TARGET <target-id>
msf exploit(cyrus_pop3d_popsubfolders) > show options
   ... show and set options ...
msf exploit(cyrus_pop3d_popsubfolders) > run
```
    
    